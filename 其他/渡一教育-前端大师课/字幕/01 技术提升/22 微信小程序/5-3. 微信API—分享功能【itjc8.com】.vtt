WEBVTT

00:00.000 --> 00:04.320
好 这节课的话 咱们来讲一下小程序里面的这个分享

00:05.520 --> 00:10.480
分享的话 这个是非常常见的一个需求 对吧 你需要把你做好的这个小程序

00:11.280 --> 00:19.440
分享到 比如说分享到 分享给这个朋友啊 或者 或者这个分享到这个朋友圈 对不对 分享到这个群聊

00:20.000 --> 00:23.920
所以分享的话是非常常见的一个这个需求 我们来看一下这个分享功能

00:24.480 --> 00:28.800
这边的话 现在的话 要实现这个分享功能的话 实际上非常简单啊 非常简单

00:29.360 --> 00:35.680
啊 这个的话 是我们之前做的一个这个代办事项的一个这个小程序 对不对 这是我们之前做的

00:36.080 --> 00:43.040
好 那现在的话 我想要把这个分享给别人啊 这个怎么做呢 你看这边 这边 你看 我现在的话 我点击这

00:44.040 --> 00:50.160
点击这 这个的话 你用手机打开的话 这一块也是有的啊 当你点击这之后 人家这边 他是会有一个

00:50.560 --> 00:53.120
当前页面 未设之分享

00:54.080 --> 01:02.640
可不可以啊 未设之分享啊 包括这个 这个是朋友圈的分享 这个的话是针对这个朋友的这个聊天啊 以及这个群聊的这个分享

01:03.680 --> 01:09.120
好了 现在的话 我如果我想要打开这个分享 那你这边的话 你可以在这个onload的时候

01:11.300 --> 01:13.460
这边onload

01:14.660 --> 01:21.940
这个onload 是不是一个生命周期 够是很瘦 对不对啊 这边上你可以用一个叫做微信点这个秀

01:22.500 --> 01:22.900
share

01:23.700 --> 01:25.460
share这个menu

01:26.580 --> 01:31.780
这个啊 人家这边老规矩啊 我们这边去看一下sharemenu

01:32.820 --> 01:39.730
到这边来 我们来看一下这个api 在这里

01:41.810 --> 01:50.690
啊 这边是什么 是不是显示当前页面的转发按钮 接收一个什么呢 接收一个对象 我们来看一下对象有哪些配置像

01:51.410 --> 01:58.530
这对象的话 你倒是可以都不填 他都是有这个默认值的啊 这边是一个withshare ticket

01:59.090 --> 02:04.850
是否使用在这个share ticket的这个转发啊 这边有个详情 他这个应该是什么转发的这个

02:05.490 --> 02:09.810
票吗 就直翼的话是转发的什么票 对吧share ticket

02:10.690 --> 02:15.730
这个你可以看一下 ok 好 然后接下来的话这里 这里的话这个menus

02:16.450 --> 02:19.570
menus 他这边的话是一个数组啊 数组

02:19.970 --> 02:23.570
他这边呢 默认有一个这个share app message和share timeline

02:24.130 --> 02:31.650
这个话就是普通的分享 这个呢 就是分享的这个朋友圈啊 他默认的话就是只是普通的这个分享

02:32.210 --> 02:36.530
好的 剩下的话就是这个成功失败完成的这个回调好来呗

02:37.490 --> 02:43.730
好 回到我们这边 这边的话 我们就给他传入一个这个对象啊 对象的话 我们这边

02:44.690 --> 02:52.290
withshare ticket 我们这边就把它设置成是否带share ticket 我们这边设置成去吗

02:53.170 --> 02:59.810
回头我看一下这个是什么啊 好 然后接下来的话 这边这个menu menu 默认不传吗 我们保存一下

03:00.690 --> 03:08.610
保存一下 你看这边 这个是不是啊 已经可以点了 对不对 你点一下 点一下之后人家这边你就可以发送给这个

03:09.330 --> 03:16.770
发送给这个群聊啊 或者朋友啊 很简单啊 很简单 好 那现在的话 你看这边 这边这个朋友圈这个

03:17.570 --> 03:21.970
朋友圈这个现在是不是还不行 对不对 那你这边怎么办 你这边呢就可以

03:22.770 --> 03:26.290
他的第二个参数menus啊menus 他默认只有一个字

03:26.930 --> 03:32.370
就是普通的分享 你如果想要就是能够分享到朋友圈你就把这两个都带上

03:33.490 --> 03:34.930
把这两个都带上就可以了

03:36.050 --> 03:37.650
share app message

03:37.970 --> 03:40.850
啊 然后还有一个是这个share time line

03:43.500 --> 03:51.420
share time line啊 保存 保存之后 你看这个这个识别就亮了 对不对 你可以分享到朋友圈啊 大家这边你可以发送了

03:52.060 --> 03:54.700
啊 这是关于这个分享啊 好

03:56.700 --> 04:00.540
啊 有些时候的话 我们可能不是这个用户 他不是说点这

04:01.100 --> 04:08.700
啊 你点这的话确实是可以分享 对不对 你这边那只要打开了就可以分享好 然后有些时候用户是什么呢 比如你页面上有一个按钮

04:09.420 --> 04:17.980
页面上有个按钮 我点这个按钮啊 点你页面上的按钮 大家这边让他进行一个分享 那这个又怎么做呢 这个其实也很简单

04:18.780 --> 04:25.820
好 我们这边呢 我们先来新增这么一个按钮啊 我这边呢 新增一个按钮 我这边我就直接把这儿拿过来了

04:26.700 --> 04:30.140
直接把这个拿过来 然后放到

04:31.260 --> 04:37.740
我看放到这个位置 这个呢 之前这边是这个按钮啊 就创建一个任务 我把这稍微改一下

04:38.460 --> 04:39.660
我整个这一块拿过来吧

04:41.740 --> 04:47.260
整个这个这一块 把他过来 把把替换掉 替换掉之后这边就是外层加了个容器

04:47.660 --> 04:55.660
btncontainer 跑到家里面里面他是创建一个任务啊 和这个是一样的 下面多了一个多了一个分享按钮 我们这边保存一下

04:56.780 --> 04:59.900
保存 哎 这边他怎么是两排 我看一下啊

05:00.860 --> 05:08.220
这边的话btncontainer 应该是样式内 样式内没拿过来 这边把这个样式内

05:08.860 --> 05:11.740
把拿过来btncontainer 我们让他试一个那个

05:13.020 --> 05:16.300
让他试一个这个弹性盒子啊 这样子 okay

05:17.180 --> 05:24.300
好 那我现在的话 左边这个是创建一个任务啊 右边这个是分享啊 然后回头用户点击这个分享这个按钮

05:24.780 --> 05:24.940
哎

05:26.220 --> 05:34.300
这边 哦 这边好像是因为我这边 这边我这个open type 等于这个share啊 说我现在点击的话 这边就直接就可以分享了

05:35.100 --> 05:40.380
可不 已经可以分享了啊 已经可以了 那你这边有一个open type share 对不对

05:40.860 --> 05:47.260
啊 但是现在的话还有一点 还有一点 我还想优化 怎么优化呢 你看我默认我现在分享的时候 他这边是什么

05:47.580 --> 05:49.900
这相当于是首页的这个截图

05:51.100 --> 05:56.060
对不对 他相当于是首页的这个截图啊 那我现在的话 比如说我像定制这一块

05:56.780 --> 06:05.260
我比如说想换其他的图片啊 这类的行不行 可以 可以啊 这边的话会有一个什么呢 我们这边重新回到这里

06:06.300 --> 06:09.580
回到这边 把这折起来 这些折起来

06:10.300 --> 06:15.740
ok 这边onload 折起来 好 然后加这边 这边的话会有一个这个叫onshare

06:17.260 --> 06:19.500
onshare app message

06:21.940 --> 06:26.020
看到没有啊 有一个这个onshare app message 我们这边我们来看一下

06:26.420 --> 06:31.460
这个的话 就是你当你新建一个页面的时候 他是不是就会有这个生命周期勾字函数

06:32.020 --> 06:36.340
对不对 他会在什么时候出发呢 他就是会在你这个分享的时候

06:38.900 --> 06:40.980
该生命

06:42.740 --> 06:45.780
生命周期勾字函数

06:46.500 --> 06:50.580
会在 就是分享内容的时候

06:52.100 --> 06:57.300
触发 触发 哎 我这个触发怎么

06:58.900 --> 07:01.700
呃 换一个字 触发

07:02.740 --> 07:04.980
ok 好 然后我们这边我们来看一下

07:06.980 --> 07:08.020
到这边来看一下

07:09.940 --> 07:15.780
好 在这里对对配级的参数啊 这边呢有一个onshare app message 我们点一下

07:17.940 --> 07:21.940
share app message 在这里 点过来 你看这边

07:22.740 --> 07:30.180
只有定义了此事件处理函数 右上角这个菜单才会显示转发按钮 那他会在什么时候出发呢

07:30.420 --> 07:35.860
就是你在这个分享的时候 他这边呢会有一些参数 有这个from

07:36.180 --> 07:39.860
然后我看一下 这边是接受一个参数

07:40.820 --> 07:45.060
接受一个参数 接受一个参数 这个参数是个对象 这个对象里面就有from

07:46.020 --> 07:47.460
啊 你来源于哪个

07:47.780 --> 07:50.980
一面 对吧 事件的来源啊 target 这些

07:51.540 --> 07:57.940
然后接下来这边的话 注意这句话是重点 这个事件处理函数需要返回一个object

07:59.300 --> 08:01.300
这个我们在这个代码里面我们记一下

08:02.980 --> 08:07.380
啊 他需要返回一个object 所以说我们这边的话return

08:08.100 --> 08:09.700
返回一个对象

08:10.420 --> 08:14.500
返回个对象这个对象里面有什么呢 这对象里面你就可以写比如这个title

08:14.580 --> 08:16.500
转发的标题 pass

08:17.540 --> 08:22.580
啊 就是默认他的这个 就是哪个页面啊 这个的话你在这个对象里面就可以改了

08:23.060 --> 08:28.980
对不对啊 大家这边还有就是图片 你如果不不给这个图片拿到默认就是这个截图

08:29.300 --> 08:32.420
就和现在是一样的 现在你看分享的话默认什么就是截图啊

08:32.980 --> 08:36.580
对不对啊 让我这边我们来写一下 这边的话title

08:37.540 --> 08:39.460
啊 比如说这是一个

08:40.900 --> 08:43.940
呃 带班带班事项

08:45.220 --> 08:46.340
的小程序

08:48.580 --> 08:50.260
好 然后接下来这个pass

08:52.020 --> 08:58.740
pass的话我们就让它是首页啊 所以这边就是配级是下面的index 下面的index

08:59.620 --> 09:01.300
好 然后接下来的话image

09:02.740 --> 09:04.340
image ur

09:05.860 --> 09:08.580
好 这边的话给了张图啊 这边image

09:09.060 --> 09:11.380
这边啊 放了一张图 to do list

09:11.780 --> 09:18.260
ok 回头的话 我就想这个分享的时候 这边啊 这个位置 这个位置的话展示的是这张图片

09:18.660 --> 09:21.300
啊 那你在这边的话 你就写下这个图片的地址

09:21.860 --> 09:23.620
它就是在image是

09:24.340 --> 09:28.020
下面的to do list啊 让这个gpg

09:29.300 --> 09:32.820
ok啊 保存 保存之后啊 重新编一下吧

09:33.940 --> 09:35.300
好 我们这边我们点击分享

09:36.100 --> 09:40.900
啊 走 你看 说这是一个带班事项的小程序 合作是不是就对上了

09:41.060 --> 09:45.220
大家这边这边是不是就是这个图片 对不对 那回头你这边就可以发送

09:45.860 --> 09:51.700
ok 这就是关于这个分享啊 整体的 整体来讲的话也非常简单

09:52.100 --> 09:55.940
对不对 人家这个API给我们封装好了 直接用就可以了啊

09:56.340 --> 10:00.500
而且现在的话就是分享到这个朋友圈比之前要方便多了

10:01.060 --> 10:04.340
之前早期的时候 他不支持那个分享到这个朋友圈

10:04.980 --> 10:07.300
早期的话我们还得用点其他的办法

10:07.860 --> 10:10.340
就比如说 呃 汇制一张海报

10:11.140 --> 10:14.420
通过看话日 汇制一张海报 那回头把这张海报

10:14.900 --> 10:18.260
保存到用户的这个相册里面 然后让这个用户

10:18.820 --> 10:24.180
去这个用这个相册里面的这张图片去发朋友圈啊 早期的话是这样子来做的

10:24.580 --> 10:28.420
ok 但现在的话就很简单了 现在这边的话是不是直接就支持了

10:29.220 --> 10:31.460
对不对 share time line 直接就支持了

10:32.020 --> 10:37.220
ok 好 这是关于这个分享功能啊 大家下来可以自己试一试

10:37.220 --> 10:40.100
ok 这期课就到这里 再见

