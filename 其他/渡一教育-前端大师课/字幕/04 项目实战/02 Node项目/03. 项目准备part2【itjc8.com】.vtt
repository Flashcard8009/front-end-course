WEBVTT

00:00.560 --> 00:05.960
好 这节课的话 我们继续来书写 我们的这个个人博客的这个服务乞断啊

00:06.520 --> 00:08.920
上节课的话 我们已经把这个三层架构

00:09.680 --> 00:13.920
已经把它搭建好了 对吧 其实的话 这边就是建了一个这个dao的目录

00:14.360 --> 00:21.360
然后这个是sovice 我们这个业务逻辑层的目录 然后接下来我们的这个表现成 表现成了就是这个入词

00:21.800 --> 00:28.080
这个我们没动他 对吧 这是我们的第一个准备工作 把这个价值先把它搭建起来

00:28.800 --> 00:31.360
那这节课的话 我们干嘛呢 我们把数据库

00:32.200 --> 00:39.640
把它连接了啊 数据库的话 我在第一节课我就说过 我们这边数据库的话 我们使用什么呢 使用my circle

00:40.320 --> 00:48.320
my circle的话 这个大家是学过的 对不对 所以我这边的话 不会再讲什么my circle的安装啊 my circle的这个使用

00:49.320 --> 00:53.800
如何使用啊 这个的话你就直接看之前的那个袁老师的那个路播客

00:54.400 --> 00:59.920
对吧 袁老师那个load的路路播客里面已经讲得很清楚了啊 那我们这边呢 就是直接用

01:00.560 --> 01:07.880
好不好 好 我这边的话已经把我的这个my circle已经装好 并且已经这个启动了 在这个位置

01:09.720 --> 01:14.560
啊 这里这里的话有个my circle 看到没有 my circle 然后接下来这边的话我是已经启动了

01:15.240 --> 01:19.320
啊 我这边装的是8点0点27啊 这边有个stop

01:20.120 --> 01:26.360
啊stop 这个my circle server就停止服务器 那说明我现在的话是不是启动的

01:27.080 --> 01:31.720
对不对啊 启动了 然后接下来的话 这里 这里有个这个level kit

01:32.600 --> 01:39.640
这个东西 这个东西的话我相信大家也是装了的啊 这个我看袁老师之前在讲my circle的时候是给大家介绍了的

01:40.400 --> 01:48.160
ok 好 那我这边的话 我这里有一个叫做my site的这个数据库啊 这个是我之前写的时候 我创建的数据库

01:48.720 --> 01:52.920
好 那我这边的话 我要带着大家写一遍 随着我这边让我创建一个新的数据库

01:53.560 --> 01:59.720
所以我们在这边的话 新建数据库 这里叫做my site啊 二

02:00.640 --> 02:06.600
ok my settle 二 好那其他的这些制服级排序规则这些 这些就让他默认就可以了啊 这边点击好

02:07.960 --> 02:12.720
好 那我们这边的这个my site 二是不是就创建好了 好 当然现在的话是没有表的

02:13.200 --> 02:18.040
看表 我展开的话一张表都没有啊 好 那接下来回到我们代码这边

02:19.160 --> 02:22.480
这边的话 我们就需要用什么呢 我们就需要用那个sqnize

02:23.680 --> 02:26.800
用sqnize 啊 大家还记不记得那个sqnize

02:28.870 --> 02:34.630
他这个sqnize的话 他是一个基于promise的这个load.js的这个orm

02:35.310 --> 02:39.630
对吧 他可以就是支持很多种这个数据库啊 把这个数据库

02:40.030 --> 02:45.550
硬设成这个模型对象 那回头的话 你在你的代码里面啊 无论你是

02:46.550 --> 02:51.630
添加数据还是怎么着 反正你操作数据的话 这都是通过什么的 都是通过这个模型

02:52.430 --> 02:56.870
去操作 然后他底层的这个数据库的话 可以随时的进行个替换

02:57.790 --> 03:02.150
对不对 我们把这个sqnize 我们把这个官网打开 我们这边再来看一下

03:04.600 --> 03:10.560
这个的话 关于这个sqnize的话 也是之前这个袁老师讲过的 这个的话你一定要去看

03:11.440 --> 03:14.160
知道吧 不要 这边还敲错了 出来了 是吧

03:15.760 --> 03:18.680
一定要去看哈 看了 然后接下来再来看我的这个课

03:19.480 --> 03:25.000
啊 不能 我这边让我不会讲太多的关于这个sqnize他的用法 我这边让就是直接就开始用了

03:25.600 --> 03:27.960
啊 我这边假定你是express你会的

03:28.600 --> 03:34.920
my circle你会的 那这个sqnize你会的 在这个的基础上 然后接下来我再来带你写这个服务器

03:35.800 --> 03:36.800
明白吧啊

03:37.680 --> 03:46.080
啊 这边啊 他是基于这个promise.no的gsorm 啊 支持这么一些数据库 啊 当我们这边用的是什么呢 用的是啊 my circle

03:47.080 --> 03:51.280
吧 好了 接下来首先我们第一步第一步 我们要干嘛呢 我们要在我们的项目里面安装

03:52.120 --> 03:53.520
啊 安装的话他这边

03:54.400 --> 03:56.360
是不是就直接在这里 这这行代码

03:57.240 --> 04:02.280
啊 保存一下 保存了 然后还需要装这个驱动啊 所以把这个驱动也装一下

04:03.080 --> 04:04.960
我们来到这边 把这个停一下

04:04.960 --> 04:10.320
好 首先的话 一个是这个sqnize 还有就是my circle

04:10.800 --> 04:16.040
二 是不是这两个东西啊 把它装一下 装了之后 然后接下来的话

04:16.680 --> 04:22.600
我们在我们的这个数据库里面 我们新建一个文件叫做db 好 这边已经装好了啊

04:23.160 --> 04:24.240
好 这边可以把他提起来

04:26.400 --> 04:32.160
ok 提起来 好 然后接下来这个文件 这个文件就放在哪里呢 这个文件就放在我们的dao里面

04:33.080 --> 04:39.000
ok 好 我们这边呢 就创建 创建两个文件 一个叫做db connect

04:40.960 --> 04:47.760
conlect connect 是不是这么拼的 这样拼的 是吧 db connect 点接手

04:48.480 --> 04:53.800
好 这个文件干嘛的呢 这个文件就是专门负责做这个数据库的这个连接的

04:54.560 --> 05:00.320
他连接完了之后 是不是会有一个叫做sqnize的这个实列 然后把这个实令我们把它扔出去

05:01.120 --> 05:05.520
ok 好 说说我们这边的话 我给大家写一下啊 该文件

05:06.880 --> 05:13.160
负责什么呢 负责连接数据库啊 说说我们这边的话 const

05:14.800 --> 05:16.160
等于一个require

05:17.320 --> 05:20.320
require 啊 这边的话这个sqnize

05:21.880 --> 05:26.720
对吧 好 然后把这个的话 把它导出出来 这边的话就是sqnize

05:27.720 --> 05:34.000
ok 先把这个引到 引到之后 然后干嘛呢 创建数据库连接

05:35.280 --> 05:39.920
数据库连接 好 那接下来这边就const

05:40.520 --> 05:50.060
一个这个sqnize 等于什么呢 等于我们这边要用到这里 导出来的这个sqnize 啊 这边是new

05:51.620 --> 05:55.380
new一个sqnize 连接 这个连接的这个实力

05:56.180 --> 06:04.180
好 然后接下来这里 这里的话 他就是接收那么几个参数啊 这个的话你肯定是背不到的 这个直接去干嘛 直接去查文档

06:05.060 --> 06:09.660
知道吧 这个你哪背得到吗 这边文档是不是他就这里写的呀

06:10.540 --> 06:15.420
对不对 有方法一有方法二啊 那我们看方法二 方法二的话 这边的话就是

06:16.620 --> 06:20.900
哦 这里还有方法三啊 这边就是什么呢 这边就是你的数据库

06:21.500 --> 06:27.180
数据库的名称 然后接下来你数据库的这个用户名密码 然后包括这边

06:27.700 --> 06:36.540
host 后面我们就是本地 然后接下来这边这个delete 啊 选择就是究竟是哪种数据库类型 好 那我们这边的话就直接用这种

06:37.540 --> 06:40.500
数就ok了 好 那我们这边来

06:41.980 --> 06:49.340
好 然后这边报错 报错是因为这个还没选啊 这边的话我们选什么 是选my circle

06:51.060 --> 06:59.620
对吧 好 选my circle 好 现在就不会报错了 格式画一下 好 大家这边这边一个一个来改 我们的数据库名称 数据库名称叫做my site

07:00.740 --> 07:02.540
对不对 my site

07:03.980 --> 07:11.340
然后用户名用户名的话我这个是route 密码我也是用的是route 啊 但这边的话你填你自己的数据库账号密码

07:12.140 --> 07:18.020
知道吧 你不要傻傻糊糊的啊 我写个route 你也写个route 这个要看你那个数据库 你的那个

07:18.660 --> 07:24.980
那个密码是多少 你不见得和我一样 对不对 你如果没有设置 没有设置 他默认是空的 没有的

07:26.020 --> 07:31.540
知道吧 这个我就不多说了啊 好 然后接下来话 这里 这里的话是localhost

07:32.900 --> 07:34.260
好 然后这里的话是

07:35.540 --> 07:40.580
呃my sql 然后这样我这里的话再多设置一个 多设置一个这个nogering

07:41.340 --> 07:46.220
是什么呢 是这个force啊 这个的话袁老师是介绍了的啊 你把这个

07:47.180 --> 07:53.300
呃这个log 把它关闭之后 他生成了那些circle语句 他是不是就不会再控制台显示啊

07:54.260 --> 07:58.300
对啊 我们这边不需要显示啊 好 然后接下来完事之后

07:59.340 --> 08:07.220
我们来看文档 这里的话就可以测试这个连接啊 我们这边我们来测试一下 就直接用他这个代码直接复制过来就可以了

08:08.140 --> 08:12.100
好 然后拿过来拿过来

08:13.060 --> 08:16.740
好 然后完事之后我们就应该干嘛呢 我们就应该执行一下

08:17.140 --> 08:20.740
这个代码 对不对 怎么执行的 那你可以的话 把这个服务器

08:21.420 --> 08:26.860
你可以把这个服务器停掉 停掉之后 然后接下来的话 你通过loaddbconnect

08:27.580 --> 08:34.980
来执行 那你也可以干嘛呢 你也可以在这个app.js里面啊 因为我们这边启动服务器是不是就是启动的这个文件

08:35.860 --> 08:43.180
对不对 好 你在这个app.js里面 你干嘛呢 你把这个引入一下啊 这边的话 引入数据库

08:44.180 --> 08:51.100
引入数据库啊 连接 那你这边的话 就是直接require

08:53.300 --> 08:59.420
require一个什么呢 这里的话就当前目录下面的dao 下面的dbconnect

09:00.940 --> 09:05.420
对不对 好 完事之后 然后接下来你在一起保存啊 全部保存

09:06.420 --> 09:11.260
ok 啊 这边是否爆错了 咱们看爆了什么错啊 wait is only

09:11.860 --> 09:16.100
这个y里的in a sync function啊 这个错误是吧 这个很简单

09:16.900 --> 09:21.340
对不对 那我们这边怎么办呢 我们这边呢 可以写一个这个sync函数

09:22.220 --> 09:25.940
sync function 我们让它是一个立即执行函数

09:29.410 --> 09:37.660
然后这里啊 让它立即执行 然后把这个的话扔进去是不是就可以啊 格式画一下 重新再来

09:38.620 --> 09:38.940
保存

09:40.540 --> 09:47.620
ok 看到没有 connexion has been这个italized successfully 什么意思啊 是不是进了这

09:48.420 --> 09:52.300
对不对 说明什么 说明我们的数据库 是不是连接成功的

09:53.420 --> 09:59.820
对不对 是连接成功的啊 所以这一步的话很简单 你现在的话可以把那个视频暂停一下

10:00.260 --> 10:07.620
把你的这个数据库先把它弄好啊 你这边的话 你要先新建啊 你打开你的这个my circle 打开你的never gate

10:08.100 --> 10:17.060
你先新建一个这个my site2 新建了之后 然后接下来这边的话再做这些操作 啊 记得把这个skrnize和这个my circle2

10:17.700 --> 10:18.580
把这两个装了

10:21.260 --> 10:26.580
啊 大家下来的话 把这个做一做吧啊 那我们支持的话 我们整个这个准备工作

10:27.220 --> 10:34.540
就做完了 把项目的价值搭起来了 数据库的话也已经连通了 那后面的话 我们就要开始一点一点的来

10:34.540 --> 10:39.220
输写整个项目了 好了 好 这几个就先到这里 再见

