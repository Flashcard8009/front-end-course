WEBVTT

00:00.000 --> 00:03.280
首先跟同学们表达一下歉意

00:03.480 --> 00:05.600
上节课我自己讲完了

00:05.600 --> 00:07.640
感觉自己都讲的不是很好

00:07.760 --> 00:11.400
因为昨天我录的也不多

00:11.400 --> 00:14.280
昨天我主要就是写这个玩意儿

00:14.720 --> 00:16.000
就给他写这个玩意儿

00:16.000 --> 00:17.600
所以说昨天身体不太舒服

00:17.840 --> 00:21.920
今天不能再停了

00:21.920 --> 00:23.720
因为我知道同学也很着急

00:23.720 --> 00:25.480
看到这个录的也是

00:25.480 --> 00:26.200
我也很着急

00:26.200 --> 00:28.320
想给大家快点录完

00:29.080 --> 00:32.000
在这两天身体不太舒服

00:32.600 --> 00:34.320
昨天上节课没有讲到一个东西

00:34.320 --> 00:37.760
就是为什么说Origin不要用信号

00:37.760 --> 00:39.880
官方文章是这样说的

00:39.880 --> 00:41.880
就是你如果说要带一个评证的

00:41.880 --> 00:43.880
就是身份评证的寝求的时候

00:46.560 --> 00:48.560
就是你要把这个东西设置为

00:48.560 --> 00:50.080
你不能设置为信号

00:50.080 --> 00:52.800
你必须要设置为具体的域

00:52.800 --> 00:55.040
所以说不推荐使用信号

00:55.040 --> 00:56.040
就这么个原因

00:57.040 --> 01:00.760
这边我给大家说一下

01:00.760 --> 01:01.760
这个玩意儿

01:01.760 --> 01:05.280
其实我们上节课是自己写了一个中间线

01:07.280 --> 01:08.280
自己写的一个中间线

01:08.280 --> 01:10.040
好在就是有这个文档

01:10.040 --> 01:12.800
上节课应该有朋友听出来

01:12.800 --> 01:15.520
我这个声音不是没有那么性感的

01:15.520 --> 01:17.160
没有那么带词性的

01:17.160 --> 01:21.680
所以说还好有这个文档

01:21.680 --> 01:22.520
所以大家看文档

01:22.520 --> 01:24.680
基本上所有东西都给你讲完了

01:25.440 --> 01:26.760
就是还有一个中间线

01:26.760 --> 01:28.760
就是中间线我们上节课是自己写的

01:28.760 --> 01:30.080
对吧

01:30.080 --> 01:31.760
其实我们不用自己写

01:31.760 --> 01:33.680
没有必要自己写写

01:33.680 --> 01:36.240
我们完全可以用一些线程的中间线

01:36.240 --> 01:37.320
线程中间线是啥呢

01:37.320 --> 01:37.760
就这个

01:38.960 --> 01:40.280
CORS

01:40.280 --> 01:40.920
就这个中间线

01:42.040 --> 01:42.640
就看一下吧

01:42.640 --> 01:43.760
这个非常非常简单

01:43.760 --> 01:44.880
它的用法

01:44.880 --> 01:47.240
它就是把一些常驾的跨越的功能

01:47.240 --> 01:47.920
给我们写完了

01:47.920 --> 01:49.360
可以进行一些配置

01:49.360 --> 01:50.320
其实它本质写的话

01:50.320 --> 01:53.320
就是按照我们的类似的逻辑来写的

01:53.360 --> 01:54.400
我们来安装用一下吧

01:55.880 --> 01:56.360
npm

01:58.000 --> 01:58.360
我怕

01:59.760 --> 02:00.600
CORS

02:01.760 --> 02:05.490
安装一下

02:05.490 --> 02:06.890
好安装好了

02:06.890 --> 02:07.970
然后怎么用呢

02:07.970 --> 02:08.930
非常简单

02:08.930 --> 02:11.450
如果说你所有的都允许跨越的话

02:11.450 --> 02:12.450
一句话就写完了

02:12.450 --> 02:14.410
你看它这里告诉你怎么用

02:14.410 --> 02:15.290
就是use

02:15.290 --> 02:16.090
CORS

02:16.090 --> 02:16.490
对吧

02:16.490 --> 02:17.410
调整它就完事了

02:17.410 --> 02:17.530
好

02:17.530 --> 02:18.250
咱们来试一下吧

02:19.330 --> 02:20.530
如果说我这里呢

02:20.530 --> 02:21.770
我这里不是这样子的

02:21.770 --> 02:23.650
我们这里就是那个想导入

02:23.690 --> 02:24.930
这个CORS

02:24.930 --> 02:26.330
require

02:26.330 --> 02:27.810
CORS

02:27.810 --> 02:28.410
导入进来

02:28.410 --> 02:29.570
然后它是个函数

02:29.570 --> 02:30.690
调一下就完事了

02:30.690 --> 02:32.250
调一下它会返回一个中间键

02:33.970 --> 02:34.770
CORS

02:34.770 --> 02:35.970
返回个中间键

02:35.970 --> 02:36.970
没了

02:36.970 --> 02:37.730
没了

02:37.730 --> 02:38.570
咱们再试一下吧

02:39.770 --> 02:40.610
npm start

02:42.090 --> 02:43.810
接下来我们到浏览器里边

02:43.810 --> 02:44.970
这个地方

02:44.970 --> 02:45.770
我们这里

02:45.770 --> 02:46.170
双击

02:47.570 --> 02:47.970
运行

02:48.850 --> 02:49.730
然后这里

02:49.730 --> 02:50.810
检查

02:50.810 --> 02:51.210
看一下

02:52.210 --> 02:53.010
好

02:53.010 --> 02:54.410
这个地方为什么出问题了

02:54.410 --> 02:55.130
我们看一下

02:55.130 --> 02:55.970
先把这个

02:55.970 --> 02:57.570
这个把个接下来拿出来

02:57.570 --> 02:59.410
我们首先看不看预检请求

02:59.410 --> 03:01.370
不看这个请求

03:01.370 --> 03:02.090
我们看一下这个

03:05.250 --> 03:05.930
双击

03:05.930 --> 03:06.570
说没问题

03:06.570 --> 03:07.370
能够获取数据

03:07.370 --> 03:07.810
对吧

03:07.810 --> 03:08.490
跨越了嘛

03:08.490 --> 03:08.810
对不对

03:08.810 --> 03:10.010
能获取数据

03:10.010 --> 03:12.050
然后我们看一下预检请求

03:12.050 --> 03:13.250
预检请求里边

03:13.250 --> 03:14.810
如果说我把这个取掉

03:14.810 --> 03:16.650
不允许戴COOCY

03:16.650 --> 03:17.650
不戴COOCY的话

03:17.650 --> 03:18.530
你看是不是正常的

03:18.530 --> 03:18.770
对吧

03:18.770 --> 03:19.730
可以跨越的

03:19.730 --> 03:20.970
但戴COOCY就不行了

03:20.970 --> 03:22.210
所以说它还是

03:22.250 --> 03:23.050
默认情况下

03:23.050 --> 03:24.850
还是不允许戴COOCY的

03:24.850 --> 03:25.290
对吧

03:25.290 --> 03:26.410
都是它默认的情况

03:26.410 --> 03:27.330
它就预检请求

03:27.330 --> 03:28.050
简单请求都可以

03:28.050 --> 03:30.650
但是戴这个身份认证的请求

03:30.650 --> 03:31.450
它是不允许的

03:31.450 --> 03:32.410
它默认的情况

03:32.410 --> 03:33.290
那你可以配置

03:33.290 --> 03:35.450
我们来看一下它的配置

03:35.450 --> 03:37.250
配置其实很简单

03:37.250 --> 03:38.090
这里我再说一下

03:38.090 --> 03:39.890
它别的用法

03:39.890 --> 03:41.290
那如果说

03:41.290 --> 03:44.210
我只是针对某一些接口

03:44.210 --> 03:46.970
我只是针对某一些接口

03:46.970 --> 03:48.490
我要进行跨越

03:48.490 --> 03:50.130
那么你可以用这种方式

03:50.130 --> 03:51.770
这种方式是不是在提醒我们

03:51.810 --> 03:53.770
之前做那个就是

03:53.770 --> 03:55.370
那个token的认证的时候

03:55.370 --> 03:56.170
其实也可以用

03:56.170 --> 03:57.210
我们自己写农链键

03:57.210 --> 03:58.450
也可以用类似的方式

03:58.450 --> 03:58.770
对吧

03:58.770 --> 04:00.210
我们当时不是用这种方式

04:00.210 --> 04:01.610
当时是在统一处理的

04:01.610 --> 04:03.450
在写个配置统一处理的

04:03.450 --> 04:05.770
那么也可以用这种类似的方式

04:05.770 --> 04:06.890
用这种方式也可以

04:06.890 --> 04:08.330
当然我们这里是全部都允许

04:08.330 --> 04:09.010
对吧

04:09.010 --> 04:10.530
然后还可以配置

04:10.530 --> 04:11.530
它里边可以传配置的

04:11.530 --> 04:13.090
就是这里传一个all形式

04:13.090 --> 04:14.330
一个对象配置

04:14.330 --> 04:15.050
配置的就是

04:15.050 --> 04:16.410
你可以允许什么域

04:16.410 --> 04:16.890
orange

04:16.890 --> 04:18.050
可以配置为一个

04:18.050 --> 04:19.210
配置为一个字部串

04:19.210 --> 04:20.250
还可以配置这个东西

04:20.290 --> 04:22.130
后面有一些完整的配置列表

04:22.130 --> 04:23.250
还可以配置这个东西

04:23.250 --> 04:23.930
这个东西是什么

04:23.930 --> 04:26.730
就是想用的消息码

04:27.450 --> 04:28.410
想用的消息码

04:28.410 --> 04:30.370
它这里摸着是204

04:30.370 --> 04:31.250
为什么是204

04:31.250 --> 04:32.850
204是什么消息码

04:32.850 --> 04:33.730
204是这样子

04:33.730 --> 04:34.930
我给大家解释一下

04:34.930 --> 04:37.410
这是一个脑调牙的消息码

04:37.410 --> 04:38.730
就是说

04:38.730 --> 04:40.810
我想用一个204

04:40.810 --> 04:43.530
反正二开头的都表示成功

04:43.530 --> 04:44.690
204是什么意思呢

04:44.690 --> 04:48.010
就是表示你不要挑到我的页面去

04:48.010 --> 04:49.570
啥意思呢

04:49.610 --> 04:50.370
就是说

04:50.370 --> 04:53.490
我这个页面上可能有一个Foam表单

04:53.490 --> 04:54.970
可能有一个Foam表单

04:54.970 --> 04:57.210
比方说把我们请求另外一个地址

04:57.210 --> 04:59.770
比方说随便一个地址吧

04:59.770 --> 05:01.810
然后我们提交这个表单的时候

05:01.810 --> 05:03.210
它就会挑到这个地址去

05:04.610 --> 05:07.690
如果说这个地址给我响应的是204的话

05:07.690 --> 05:08.610
我就不会挑过去

05:08.610 --> 05:09.810
我仍然完成请求

05:09.810 --> 05:10.850
但是我不会挑过去

05:10.850 --> 05:12.610
就这么个意思

05:12.610 --> 05:13.530
这些脑调牙的

05:13.530 --> 05:14.730
我们现在不打用了

05:14.730 --> 05:16.570
你现在都是用二开头的

05:16.570 --> 05:18.730
然后它这里可以改这个消息码

05:18.770 --> 05:19.610
可以改成200了

05:19.610 --> 05:20.290
当然无所谓了

05:20.290 --> 05:21.290
这个东西都无所谓

05:22.290 --> 05:25.290
然后如果说你要搞一个白名单出来的话

05:25.290 --> 05:26.370
他告诉你可以怎么弄

05:26.370 --> 05:27.610
你可以自己写个数组

05:27.610 --> 05:27.890
对吧

05:27.890 --> 05:29.130
我们上一课自己做过

05:29.130 --> 05:29.330
对吧

05:29.330 --> 05:30.490
一个白名单

05:30.490 --> 05:32.050
如果说你要写白名单的话

05:32.050 --> 05:34.930
那么你可以写成这么一个数组的形式

05:34.930 --> 05:36.090
然后来这边

05:36.090 --> 05:38.010
orange就可以配置一下

05:38.010 --> 05:39.130
orange配置一下

05:39.130 --> 05:40.490
然后这边

05:42.490 --> 05:43.570
orange配置一下

05:43.570 --> 05:45.210
然后可以写个函数

05:45.210 --> 05:46.530
它是支持函数的

05:46.530 --> 05:48.570
函数里面的第一个参数就是orange

05:48.570 --> 05:51.250
就是客户端传怪的orange

05:51.250 --> 05:53.490
你看一下orange在不在你的白名单里边

05:53.490 --> 05:55.610
如果说你允许这些域名跨域的话

05:55.610 --> 05:55.890
ok

05:55.890 --> 05:57.450
那么你调用callback

05:57.450 --> 05:59.170
第一个参数就是错误

05:59.170 --> 05:59.930
有没有错误

05:59.930 --> 06:01.450
没有错误的话就写到

06:01.450 --> 06:03.050
第二个参数就表示允许

06:03.050 --> 06:04.610
就这么简单

06:04.610 --> 06:05.730
这就是这种写法

06:05.730 --> 06:08.450
不要后面来搞一个白名单吧

06:08.450 --> 06:09.890
来搞一个白名单在这边

06:11.770 --> 06:14.330
这边我们来写一下这个CORS

06:14.330 --> 06:17.250
这边我们可以给他写上一个

06:17.250 --> 06:17.770
叫做什么

06:17.770 --> 06:18.330
orange

06:18.370 --> 06:19.250
配置一下

06:19.250 --> 06:20.490
把它写成个函数

06:20.490 --> 06:21.130
orange

06:22.130 --> 06:23.690
然后这里是callback

06:23.690 --> 06:23.930
对吧

06:25.930 --> 06:26.170
好

06:26.170 --> 06:27.290
我们弄一个白名单

06:29.010 --> 06:29.610
white

06:30.930 --> 06:31.330
nest

06:32.450 --> 06:34.410
一个就是null

06:34.410 --> 06:35.810
如果说还有别的的话就该写

06:35.810 --> 06:37.530
如果说你所有的允许的话

06:37.530 --> 06:38.210
就不要白名单了

06:38.210 --> 06:38.970
对吧

06:38.970 --> 06:40.450
orange我们就这样的写

06:40.450 --> 06:42.130
就直接写上callback

06:44.090 --> 06:45.050
null

06:45.050 --> 06:46.050
orange

06:46.050 --> 06:46.490
对不对

06:46.530 --> 06:48.290
这就搞弄成一个白名单了

06:48.290 --> 06:49.250
当然还要判断一下

06:50.050 --> 06:51.610
判断一下就是white list

06:51.610 --> 06:52.650
是不是包含

06:52.650 --> 06:53.970
包含这个orange

06:53.970 --> 06:55.250
如果说包含的话

06:55.250 --> 06:57.130
那么我就用callback

06:57.130 --> 06:58.250
如果不包含的话

06:58.250 --> 06:59.090
那么else

07:00.210 --> 07:01.770
我们就叫用callback给他

07:04.650 --> 07:06.210
callback给他传一个错误

07:06.210 --> 07:06.930
对不对

07:06.930 --> 07:07.290
air

07:08.490 --> 07:09.650
not allowed

07:12.050 --> 07:13.090
好了就完成了

07:13.090 --> 07:13.450
对吧

07:13.450 --> 07:14.890
然后我们来看一下

07:14.890 --> 07:15.490
刷新

07:16.050 --> 07:16.810
现在弄到有问题

07:16.810 --> 07:17.050
对吧

07:17.050 --> 07:17.690
弄到有问题

07:17.690 --> 07:18.010
为什么

07:18.010 --> 07:19.090
已经就加上这个东西了

07:19.090 --> 07:19.610
对吧

07:19.610 --> 07:19.810
好

07:19.810 --> 07:20.370
我们再来看

07:22.090 --> 07:22.970
往下走

07:22.970 --> 07:24.050
下面他高速领了

07:24.050 --> 07:25.050
后面我们不看了

07:25.050 --> 07:26.130
下面是高速领了

07:26.130 --> 07:26.930
他有一些配置

07:28.850 --> 07:30.210
刚才那个导视频导完了

07:30.210 --> 07:30.970
上前一颗的视频

07:32.170 --> 07:34.170
那么这里我们看一下

07:34.170 --> 07:35.130
erl headers

07:35.130 --> 07:35.370
对吧

07:35.370 --> 07:35.810
讲过了

07:35.810 --> 07:36.170
对不对

07:36.170 --> 07:37.130
他就是配置这个东西

07:37.130 --> 07:39.330
你看注射就明白了

07:41.170 --> 07:41.850
erl headers

07:41.850 --> 07:43.490
这个是exposed headers

07:44.450 --> 07:46.290
就是允许客户端

07:46.290 --> 07:47.490
获取的寻求头

07:48.130 --> 07:48.850
都不要跳了

07:55.450 --> 07:56.290
继续看

07:56.290 --> 07:57.730
下面有这么一个东西

07:57.730 --> 07:58.730
就是max edge

07:58.730 --> 07:59.530
他一定可以配置

07:59.530 --> 07:59.770
对吧

07:59.770 --> 08:00.890
这一看下就明白了

08:01.690 --> 08:03.170
这么一个东西叫做

08:03.170 --> 08:05.650
那个credentials

08:06.290 --> 08:08.050
要把稍微触及完事了

08:08.050 --> 08:09.370
对不对

08:09.370 --> 08:10.570
我们这里把配置一下

08:11.610 --> 08:12.330
把这个地方

08:13.330 --> 08:14.730
这是orange

08:14.730 --> 08:16.010
配置一下这个东西

08:16.010 --> 08:17.690
把它配置为去

08:19.250 --> 08:20.010
保存

08:20.010 --> 08:20.850
现在我们看一下

08:20.850 --> 08:21.210
这边

08:21.970 --> 08:22.810
刷新

08:22.810 --> 08:23.890
你看是不是可以了

08:23.890 --> 08:24.410
对吧

08:24.410 --> 08:24.730
可以了

08:24.730 --> 08:25.850
当然我这里

08:25.850 --> 08:27.450
还有一些验证没通过

08:27.450 --> 08:27.650
OK

08:27.650 --> 08:28.730
就完事了

08:28.730 --> 08:30.010
就是使用一个中间键

08:30.010 --> 08:31.050
celrs中间键

08:31.050 --> 08:34.210
完成这个就是功能

08:34.210 --> 08:35.050
没了

08:35.050 --> 08:35.930
就讲一下这个中间键

08:35.930 --> 08:36.650
实际上这个中间键

08:36.650 --> 08:37.410
我上去可以讲了

08:37.410 --> 08:38.690
实际上上去我实在撑不住了

08:40.130 --> 08:41.850
那么就是这一块东西

08:41.850 --> 08:43.050
给大家补充一下

08:43.050 --> 08:43.650
其他没啥了

