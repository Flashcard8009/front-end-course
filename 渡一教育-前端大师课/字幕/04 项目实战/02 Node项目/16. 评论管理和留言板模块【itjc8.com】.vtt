WEBVTT

00:00.370 --> 00:04.210
这节课的话 我们把这个留言板

00:04.470 --> 00:08.810
一个是留言板以及什么呢 以及这个博客文章里面还有个什么啊

00:09.070 --> 00:10.350
是不是还有一个这个评论

00:10.870 --> 00:12.910
对不对 把留言板和评论

00:13.170 --> 00:14.450
我们把它一起做了

00:14.970 --> 00:19.310
这个留言板和评论的话 这个看上去像是这个两个模块

00:19.570 --> 00:23.410
对不对 但其实的话这边我们用到的其实就一个模块

00:23.670 --> 00:25.970
后面我们写那个数据模型的时候

00:26.230 --> 00:29.810
就数据库对应的那个数据模型 其实一个模型就够了

00:30.790 --> 00:34.930
其实你这边的话你仔细观察哈 你会发现这边无论是评论还是留言板

00:35.190 --> 00:36.210
他们都是三个

00:36.970 --> 00:40.050
看到没有 都是三个 比如这边那是这个添加评论

00:41.330 --> 00:43.890
添加评论的话 他这边的话就是不需要这个token验证

00:44.410 --> 00:46.450
因为我们这个评论的话 我们可以直接

00:46.710 --> 00:47.470
比如在前台

00:48.250 --> 00:49.770
前台这边是不是直接就添加了

00:50.290 --> 00:54.390
对不对 这边你输入内容 这边输入内容点提交 这边是不是添加了

00:54.650 --> 00:56.170
对不对 这边是不需要token的

00:56.430 --> 00:57.970
包括什么呢 包括这个留言板

00:58.730 --> 00:59.770
这边这个留言板

01:00.010 --> 01:02.570
留言板也是 我这边直接输入内容点提交

01:02.830 --> 01:03.850
就直接就提交了

01:04.370 --> 01:04.630
对不对

01:04.890 --> 01:08.730
所以这边的话就是添加评论 添加评论的话他这边你把这个消息

01:08.990 --> 01:09.750
拿过去

01:10.010 --> 01:12.810
拿过去了他这边其实也很简单 就一个

01:13.070 --> 01:13.850
leaklame

01:14.090 --> 01:14.870
你的移称

01:15.130 --> 01:16.650
你的评论的这个内容

01:16.910 --> 01:18.450
那接下如果是

01:18.710 --> 01:21.010
如果是评论 他多一个东西

01:21.530 --> 01:24.090
叫做什么呢 叫做blog id

01:24.850 --> 01:25.370
什么

01:25.630 --> 01:27.410
是不是你文章的这个id

01:27.890 --> 01:30.690
这里的话是不是就有一个这个关联关系在里面

01:31.970 --> 01:32.490
对不对

01:32.730 --> 01:33.770
有个关联关系在里面

01:34.270 --> 01:37.350
然后如果你是留言 留言就不存在这个问题

01:37.850 --> 01:39.130
你看这边提交留言

01:39.390 --> 01:42.730
提交留言的话他就只有什么呢 只有leaklame和content

01:42.990 --> 01:44.250
他就不存在那个

01:44.510 --> 01:46.050
博客文章的这个id

01:46.810 --> 01:47.330
看了没有

01:47.590 --> 01:48.970
好 然后接下来这边

01:49.230 --> 01:50.910
分页获取留言

01:51.690 --> 01:53.990
看了没有 这边分页获取留言

01:54.250 --> 01:55.530
好 然后接下来这边

01:56.530 --> 02:00.610
这边的话就有一个分页获取评论

02:01.870 --> 02:02.390
看了没有

02:02.650 --> 02:03.670
是不是都是一样的呀

02:03.930 --> 02:07.010
你会发现一会儿的话我们写的时候 就一张表就搞定了

02:07.770 --> 02:09.570
知道吧 没有必要搞两张表

02:09.830 --> 02:11.090
一张表就搞定了

02:11.350 --> 02:13.290
一张表的话 然后里面有

02:13.550 --> 02:14.630
那么几个字段

02:14.890 --> 02:16.470
一个是你的这个leaklame

02:16.990 --> 02:19.290
一个是你的这个评论的这个内容

02:19.550 --> 02:21.850
一个是你那个博客的id

02:22.110 --> 02:23.890
但这个博客id是可选的

02:24.410 --> 02:26.450
你如果没有博客id他就是什么

02:26.710 --> 02:27.990
他就是留言

02:28.250 --> 02:29.770
有博客id他就是什么

02:30.030 --> 02:31.310
他是不是就应该是评论

02:32.090 --> 02:32.590
对不对

02:32.850 --> 02:35.670
然后接下来这边删除 删除也是一样的

02:36.170 --> 02:38.230
删除在哪里 这边删除评论

02:38.490 --> 02:40.790
删除评论的话 这边就需要这个token了

02:41.550 --> 02:43.610
看了没有 因为删除删除只会在哪里

02:43.870 --> 02:45.130
是不是只会在这个后台啊

02:45.910 --> 02:47.450
对不对 后台才能删除

02:48.210 --> 02:49.990
前台的话就只能新增

02:50.250 --> 02:51.530
新增和获取

02:51.790 --> 02:53.330
这边是删除评论

02:54.350 --> 02:55.370
下面的话这边

02:55.630 --> 02:56.910
删除留言

02:58.190 --> 02:58.970
是不是需要这个token

02:59.730 --> 03:00.230
对不对

03:00.490 --> 03:03.570
这两个两个板块我们就一起来做

03:03.830 --> 03:05.630
好 回到我们这边这个代码

03:07.150 --> 03:09.710
回到我们的这个代码里面

03:10.490 --> 03:12.270
这里把这些都关了

03:12.790 --> 03:14.590
关了然后接下来把这个

03:15.350 --> 03:16.370
把它收缩一下

03:16.870 --> 03:18.670
好 然后接下来我们这边还是一样的

03:18.930 --> 03:19.690
先见什么

03:19.950 --> 03:21.750
是不是先见那个就是model

03:22.770 --> 03:23.270
对不对

03:23.470 --> 03:25.270
好 那我们这边就新建一个

03:26.290 --> 03:27.570
新建一个叫做

03:28.090 --> 03:29.110
message

03:30.130 --> 03:30.890
model

03:31.410 --> 03:32.170
.js

03:33.970 --> 03:35.770
好 然后接下来这边

03:36.270 --> 03:38.850
这边我们找一个少点的吧 就这个吧 这个就比较少

03:39.610 --> 03:40.890
然后复制过来

03:42.410 --> 03:44.210
对吧 复制过来 好 你就可以关掉了

03:44.470 --> 03:47.030
好 然后这边就叫做message

03:48.830 --> 03:49.590
message

03:49.850 --> 03:51.390
好 这边多了一个空格

03:52.150 --> 03:53.170
注意仔细

03:53.470 --> 03:55.270
好 然后这边这边的就三个字段

03:55.530 --> 03:56.750
一个是

03:57.010 --> 03:57.750
necdemo

03:58.010 --> 03:58.850
它是street

03:59.110 --> 04:01.930
好 然后接下来一个是什么呢 一个是这个content

04:02.430 --> 04:03.590
你评论了这个内容

04:03.850 --> 04:04.750
它也是street

04:05.010 --> 04:06.030
这边还有一个

04:06.530 --> 04:08.830
还有一个是你的这个日期

04:10.370 --> 04:11.650
creator.dat

04:12.670 --> 04:13.710
creator.dat

04:14.210 --> 04:16.510
好 这边的话它对应的也是

04:17.490 --> 04:18.310
也是这两项

04:20.350 --> 04:21.630
这个是creator.dat

04:21.830 --> 04:24.150
好 然后接下来这边的话有一个这个头像

04:24.910 --> 04:25.930
away

04:26.710 --> 04:27.990
at

04:28.490 --> 04:29.510
这个是头像

04:29.770 --> 04:31.830
头像对应的也是一个street

04:32.090 --> 04:32.590
ok

04:32.850 --> 04:33.610
好 就写完了

04:33.870 --> 04:35.410
首先这边是model

04:35.670 --> 04:38.470
model完了之后 接下来来到你的什么呢

04:38.730 --> 04:40.270
来到你的这个

04:40.790 --> 04:41.290
db

04:42.570 --> 04:43.090
db

04:43.350 --> 04:43.850
这边

04:44.110 --> 04:45.910
好 这边你是不是引入一下

04:46.670 --> 04:48.210
对不对 引入这个模型

04:49.230 --> 04:50.510
这边的话就是

04:52.090 --> 04:53.630
这个message model

04:56.280 --> 04:58.080
message model

04:59.100 --> 05:01.660
好 然后除了引入以外

05:02.180 --> 05:03.980
这边的话还需要干嘛呢

05:04.480 --> 05:06.520
这边的话还需要我们

05:06.780 --> 05:09.040
去定义一个这个关联关系

05:09.800 --> 05:12.680
你注意哦 这里的话是有这个关联关系的

05:13.180 --> 05:13.840
你想想

05:14.100 --> 05:15.220
就是你的这个评论

05:15.480 --> 05:16.780
留言版都还好

05:17.280 --> 05:19.080
你如果是这个文章评论的话

05:19.340 --> 05:20.600
那你这个评论

05:20.860 --> 05:22.660
和这个文章之间

05:23.120 --> 05:24.920
是不是会有一个关联关系

05:25.940 --> 05:26.440
对不对

05:26.700 --> 05:28.960
说这边的话需要有一个这个关联关系

05:29.220 --> 05:30.560
这是我们的第二个关联关系

05:31.060 --> 05:31.560
就是什么呢

05:31.820 --> 05:32.840
就是博客

05:33.360 --> 05:34.900
和博客

05:35.160 --> 05:35.920
评论

05:36.680 --> 05:37.200
之间

05:37.460 --> 05:38.480
存在

05:39.000 --> 05:39.760
关联

05:41.040 --> 05:41.560
关系

05:42.580 --> 05:43.080
对不对

05:43.600 --> 05:45.900
好了 你一个这个博客他可以干嘛

05:46.160 --> 05:47.960
是不是有多个评论

05:48.980 --> 05:49.480
对不对

05:49.740 --> 05:51.280
说这边的就是blog

05:51.540 --> 05:52.320
model

05:53.320 --> 05:54.140
他可以干嘛呢

05:54.400 --> 05:55.940
他可以 has many

05:56.700 --> 05:58.500
有多个有多个什么呢

05:58.760 --> 06:00.300
message model

06:01.320 --> 06:01.820
对不对

06:02.080 --> 06:03.620
好 然后接下来这边的话这个

06:05.160 --> 06:06.440
foreigner key

06:07.200 --> 06:08.740
foreigner key的话这边呢就是

06:09.260 --> 06:10.280
blog id

06:11.820 --> 06:12.840
blog id

06:13.100 --> 06:14.880
对应了这个target组件

06:15.140 --> 06:17.200
那组件的话就是你的那个评论的

06:17.460 --> 06:18.220
这个 id

06:19.240 --> 06:19.740
对不对

06:20.000 --> 06:20.500
好

06:21.280 --> 06:22.300
然后接下来的话这边

06:23.620 --> 06:25.020
复制一份 复制上面的

06:27.180 --> 06:29.240
好 然后接下来的话这边反过来

06:30.000 --> 06:32.820
反过来的话是不是应该是message model

06:34.100 --> 06:38.700
他应该是blog model

06:39.740 --> 06:40.240
对不对

06:40.500 --> 06:42.040
好 大家把这复制一份

06:43.560 --> 06:45.620
然后把他拿过来

06:46.380 --> 06:48.440
拿过来之后 然后接下来这边一个别名

06:48.700 --> 06:50.220
别名的话我们就是blog

06:51.500 --> 06:51.840
OK

06:52.100 --> 06:53.440
把这个关联关系

06:53.820 --> 06:54.660
把它定义好

06:54.920 --> 06:57.740
好 定义好之后 然后接下来这边我们保存一下

06:59.280 --> 06:59.780
保存

07:00.560 --> 07:01.840
没有问题 对吧

07:02.100 --> 07:04.660
没有问题的话 然后接下来这边来看一下这个表

07:05.940 --> 07:07.480
来看一下这个表

07:08.500 --> 07:09.260
是不是就OK了

07:09.780 --> 07:11.580
对不对 OK 之后让我们这边把他

07:11.820 --> 07:12.860
自动布局一下

07:13.360 --> 07:13.860
你看呀

07:14.380 --> 07:15.660
这边关联关系是不是就出来了

07:16.180 --> 07:17.220
对不对 你看这边

07:17.700 --> 07:20.780
message下面他有一个这个叫做blog id

07:21.300 --> 07:22.580
有这么一个外界

07:22.920 --> 07:23.960
他对应的就是什么呢

07:24.200 --> 07:25.800
对应的就是一个blog

07:26.640 --> 07:27.000
对不对

07:27.260 --> 07:29.560
blog这边有一个外界

07:29.800 --> 07:30.560
catcury id

07:30.820 --> 07:32.520
他对应的就是一个blog type

07:33.280 --> 07:33.800
对不对

07:34.040 --> 07:35.080
这个关联关系

07:35.340 --> 07:35.840
就出来了

07:36.360 --> 07:36.860
好

07:37.120 --> 07:38.660
然后接下来的话继续

07:39.940 --> 07:41.480
message线是空的

07:41.740 --> 07:43.280
好 接下来继续

07:43.520 --> 07:44.800
接下来的话就

07:45.060 --> 07:46.080
一层一层写呗

07:46.840 --> 07:47.360
对不对

07:47.620 --> 07:48.900
那首先从哪里开始呢

07:49.160 --> 07:52.480
首先的话我们这边先把路由先帮他写

07:52.800 --> 07:53.800
先把这几个

07:54.480 --> 07:55.800
文件先把它创建了吧

07:56.060 --> 07:57.800
首先的话这边的是message

08:00.630 --> 08:01.770
忘记加jess了

08:02.810 --> 08:04.330
好 这边从命名

08:05.370 --> 08:06.050
点

08:06.390 --> 08:07.170
jess

08:08.690 --> 08:10.490
然后以及这边service下面

08:11.510 --> 08:13.810
service下面一个message

08:14.570 --> 08:15.610
service

08:16.130 --> 08:16.370
点

08:16.630 --> 08:17.130
jess

08:17.910 --> 08:18.410
对吧

08:18.670 --> 08:20.210
以及这个dio下面

08:21.490 --> 08:22.770
dio下面一个

08:23.490 --> 08:24.390
message

08:24.650 --> 08:25.790
dio

08:26.050 --> 08:27.070
点jess

08:27.830 --> 08:28.190
对不对

08:28.450 --> 08:29.630
先把这几个文件创建了

08:29.890 --> 08:30.910
好 创建了之后

08:31.170 --> 08:32.950
然后接下来的话这边这个message

08:34.510 --> 08:36.290
好 你找一个把它复制过来

08:36.790 --> 08:37.570
就找banner吧

08:37.830 --> 08:39.630
我一般喜欢复制这个banner

08:39.890 --> 08:40.650
因为他少

08:41.410 --> 08:41.930
对不对

08:42.690 --> 08:43.970
message

08:44.730 --> 08:45.250
这边

08:46.010 --> 08:47.050
然后把这个

08:47.310 --> 08:48.070
把这些删了

08:48.830 --> 08:50.370
好 然后我们这边应该是有几个

08:51.090 --> 08:52.170
这边也有三个

08:52.670 --> 08:53.690
对不对 分别是什么

08:53.950 --> 08:54.970
分别是这个

08:55.230 --> 08:55.990
添加

08:57.790 --> 08:59.830
添加留言

09:00.090 --> 09:00.870
或者

09:01.370 --> 09:01.890
评论

09:02.410 --> 09:03.930
对吧 然后这边那是

09:04.190 --> 09:04.970
获取

09:05.470 --> 09:06.250
留言

09:06.750 --> 09:07.270
或者

09:08.030 --> 09:08.550
评论

09:08.810 --> 09:10.070
然后这还有个什么

09:10.330 --> 09:11.350
不删除

09:11.870 --> 09:12.630
留言

09:12.890 --> 09:13.410
或者

09:13.930 --> 09:14.430
评论

09:15.210 --> 09:15.710
对不对

09:15.970 --> 09:17.770
好 看一下他那个接口那边

09:18.750 --> 09:22.070
那边的话 这边是apimessage

09:22.850 --> 09:25.650
啊 这边留言版 留言版的话是apimessage

09:26.170 --> 09:27.450
这边apimessage

09:27.710 --> 09:29.250
同意都是apimessage

09:29.510 --> 09:30.770
好 然后这边

09:31.030 --> 09:32.310
博客文章这边

09:32.570 --> 09:33.850
博客文章这边

09:34.110 --> 09:35.630
这边他又叫什么

09:35.890 --> 09:37.690
他是不是又叫做这个comment

09:38.450 --> 09:38.970
对不对

09:39.230 --> 09:40.510
这边又叫comment

09:40.770 --> 09:42.050
啊 叫comment

09:42.550 --> 09:43.830
这边的话有的同学就

09:44.090 --> 09:44.850
犯难了

09:45.110 --> 09:46.910
那我这个我该怎么做呢

09:47.970 --> 09:49.170
我这个该怎么做呢

09:49.430 --> 09:50.790
这个其实很简单

09:51.050 --> 09:51.670
很简单

09:51.930 --> 09:53.210
你这边的话就是两个

09:53.470 --> 09:55.150
写同一个这个rotor

09:55.410 --> 09:56.170
就可以了

09:56.930 --> 09:57.450
对不对

09:57.710 --> 09:59.250
怎么做 我们这边来到这里

10:00.530 --> 10:01.290
来到这边

10:01.550 --> 10:04.870
好 首先的话我们在app.js里面

10:06.150 --> 10:08.470
app.js里面 我们还是把它引入

10:10.250 --> 10:11.530
这边的话 我们就是

10:13.070 --> 10:13.830
说应该是

10:14.090 --> 10:14.870
message

10:16.130 --> 10:16.650
对不对

10:16.850 --> 10:18.390
然后叫这边对应的是

10:18.650 --> 10:19.930
messagerouter

10:20.190 --> 10:22.750
好 然后再回头的话 你在这下面

10:23.010 --> 10:24.790
在这下面的话你就写两个

10:25.570 --> 10:26.590
一个是

10:26.850 --> 10:28.890
apimessage

10:29.150 --> 10:30.170
一个是comment

10:30.690 --> 10:32.210
你这边就复制两分

10:32.990 --> 10:34.530
一个是message

10:35.810 --> 10:36.570
一个是什么呢

10:36.830 --> 10:37.610
一个是

10:38.110 --> 10:38.870
comment

10:39.130 --> 10:39.630
对不对

10:39.890 --> 10:42.970
然后叫他们两个都对应什么呢 都对应这个messagerouter

10:44.250 --> 10:45.010
是不是就OK了

10:45.270 --> 10:45.790
对不对

10:45.990 --> 10:47.030
很简单

10:47.290 --> 10:48.050
很简单

10:48.550 --> 10:51.370
好 然后在这边顺便把这个排除了这个写了

10:51.630 --> 10:53.170
哪个是不需要talking一样子的

10:54.190 --> 10:55.990
这边的话是不是就是应该是

10:57.270 --> 10:58.290
这个message

11:00.810 --> 11:02.350
message它的这个get

11:02.870 --> 11:03.630
还有什么

11:03.890 --> 11:05.170
还有这个post

11:05.930 --> 11:07.810
对不对 新增和这个

11:08.070 --> 11:08.750
获取

11:09.010 --> 11:10.290
是不是都是不需要的

11:10.550 --> 11:11.310
对不对 包括什么呢

11:11.570 --> 11:12.850
包括这个comment

11:14.980 --> 11:15.500
对不对

11:15.760 --> 11:17.040
它的get和post

11:17.300 --> 11:18.560
是不需要的

11:18.780 --> 11:19.540
把这个写了

11:20.820 --> 11:23.120
好 写了之后 然后接下来就来呗

11:23.380 --> 11:24.140
一个来呗

11:24.400 --> 11:25.420
先从哪个开始

11:25.680 --> 11:26.700
先从添加开始吧

11:27.220 --> 11:29.980
添加的话 我们这边的话就直接

11:31.260 --> 11:32.080
await

11:32.340 --> 11:34.380
这边的话就写一个

11:34.900 --> 11:36.540
我们这边的话在这个

11:36.800 --> 11:38.480
messageservice这边

11:38.740 --> 11:40.780
我们就写一个这个新增

11:42.740 --> 11:44.780
新增评论或者留言

11:45.300 --> 11:46.060
这边

11:46.320 --> 11:47.340
新增

11:48.620 --> 11:49.660
评论

11:50.220 --> 11:50.980
或者

11:51.740 --> 11:52.260
留言

11:53.020 --> 11:57.380
这边呢就是model.expose.end

11:58.400 --> 11:59.420
message

11:59.680 --> 12:01.220
然后service

12:01.980 --> 12:03.520
等于一个async

12:04.280 --> 12:04.800
function

12:06.700 --> 12:07.720
function

12:08.480 --> 12:10.800
这边的话是不是应该是你的这个newmessage

12:11.300 --> 12:12.320
你新的这个

12:12.580 --> 12:13.860
留言的这个信息

12:14.880 --> 12:16.680
对不对 新的留言信息

12:16.940 --> 12:19.240
好 接下来这边这边的话就是应该是

12:19.500 --> 12:20.260
调用什么

12:20.720 --> 12:22.260
是不是就是调用你的这个

12:22.520 --> 12:23.800
刚才写的那个方法

12:24.820 --> 12:26.600
对不对 这边那就是

12:26.860 --> 12:27.900
end

12:28.660 --> 12:29.800
这个message

12:30.060 --> 12:30.960
service

12:32.240 --> 12:35.840
好 然后接下来这边那就是req.body

12:36.860 --> 12:37.880
是吧 传过去

12:38.640 --> 12:39.160
对不对

12:39.420 --> 12:41.200
好 然后接下来的话在这边

12:42.480 --> 12:44.280
在这边的话 我们首先来

12:45.040 --> 12:46.840
订一个这个数据验证规则

12:47.860 --> 12:49.400
数据验证

12:50.120 --> 12:50.640
规则

12:50.900 --> 12:52.440
好 这边呢我们就const

12:52.880 --> 12:54.680
一个message

12:54.940 --> 12:55.440
root

12:56.000 --> 12:56.520
等于

12:57.880 --> 12:58.960
好 这边呢就是

12:59.220 --> 12:59.840
nickname

13:01.120 --> 13:03.440
他对应的有一个这个presence

13:04.200 --> 13:06.360
啊 这边的话是要出席

13:06.620 --> 13:08.040
然后这边的话no

13:08.300 --> 13:08.820
mt

13:10.600 --> 13:11.120
mt

13:11.380 --> 13:13.160
是一个force

13:14.560 --> 13:17.000
好 然后接下来的话他的这个type

13:19.780 --> 13:20.300
type

13:21.460 --> 13:23.940
type的话对应的是一个street

13:24.440 --> 13:24.940
ok

13:25.200 --> 13:27.780
一个写完之后 然后后面的话你就复制一下就可以了

13:28.300 --> 13:29.420
好 这边那就是什么呢

13:29.680 --> 13:30.580
这边就是content

13:32.220 --> 13:33.060
他的内容

13:33.320 --> 13:35.820
内容的话 这边也是对应的是一个street

13:36.480 --> 13:36.980
对不对

13:37.240 --> 13:39.300
然后还有什么呢 还有这个blog

13:40.820 --> 13:41.860
blog id

13:43.990 --> 13:45.270
blog

13:46.290 --> 13:48.090
那我们的这个id写的是大写的小写

13:49.370 --> 13:50.130
写的大写是吧

13:50.390 --> 13:52.190
好 那这边那是blog id

13:53.050 --> 13:54.850
blog id的话他这边呢就是这个type

13:55.610 --> 13:56.370
是一个什么

13:56.890 --> 13:57.410
是不是street

13:57.910 --> 13:59.710
对不对 但他是什么 他是可选的

14:00.730 --> 14:02.010
对吧 你想想如果是留言

14:02.270 --> 14:04.050
留言的话他是没有blog id了

14:04.570 --> 14:05.330
只有什么呀

14:05.590 --> 14:06.370
只有评论

14:06.610 --> 14:08.150
评论的话你是针对某个

14:08.410 --> 14:09.690
文章是不是来进行评论

14:10.450 --> 14:10.970
对不对

14:11.230 --> 14:12.510
他才有这个blog id

14:13.010 --> 14:13.270
ok

14:13.790 --> 14:16.090
好 然后加这边验证规则写了

14:16.350 --> 14:18.130
写了之后 然后接下来的话 这边

14:18.650 --> 14:19.410
进行

14:20.950 --> 14:22.230
进行数据

14:22.950 --> 14:23.470
验证

14:23.970 --> 14:25.250
好 这边呢就是

14:25.510 --> 14:31.440
vili.vili.vili.

14:31.940 --> 14:32.700
把什么

14:32.960 --> 14:34.760
把你的这个new message

14:35.520 --> 14:36.300
传过去

14:36.560 --> 14:37.320
还有个什么

14:37.580 --> 14:38.860
是message row

14:40.140 --> 14:41.160
对不对 传过去

14:41.420 --> 14:43.200
好 这边的话拿到一个什么呢

14:43.460 --> 14:47.040
拿到一个vili.result

14:48.060 --> 14:48.580
ok

14:48.840 --> 14:50.360
好了 接下来的话如果

14:51.400 --> 14:52.160
if

14:52.620 --> 14:53.900
这边这个非

14:55.440 --> 14:57.480
这个vili.result

14:57.740 --> 14:59.020
是不是说明验证通过

14:59.280 --> 15:00.560
对不对 可以增加

15:00.820 --> 15:02.360
否则的话 这边干嘛呢

15:02.620 --> 15:03.900
这抛出一个错误

15:05.180 --> 15:06.460
对不对 这边的话

15:06.960 --> 15:07.720
new

15:08.240 --> 15:09.000
这个

15:09.780 --> 15:12.340
vili.arrow

15:13.100 --> 15:14.140
这边的话就是

15:14.400 --> 15:15.660
数据验证失败

15:17.460 --> 15:18.220
验证

15:18.740 --> 15:19.500
失败

15:20.020 --> 15:20.520
ok

15:20.720 --> 15:22.520
好了 接下来如果通过验证

15:23.280 --> 15:27.140
如果通过验证的话 这里有那么几个事情要做

15:27.900 --> 15:28.400
什么呢

15:28.660 --> 15:31.740
首先的话 我们这边要看他有没有这个

15:32.000 --> 15:33.280
blog 这个id

15:34.800 --> 15:37.120
等一下 这里的话我想一想

15:37.880 --> 15:38.640
对的

15:38.900 --> 15:41.460
我们首先的话 我们得看他有没有

15:41.720 --> 15:42.500
这个blog id

15:42.760 --> 15:45.060
有的话呢 接下来的话他这个blog id

15:45.320 --> 15:46.840
就等于他传过来的字

15:47.100 --> 15:49.660
如果没有的话 我们这边给他一个字

15:49.860 --> 15:50.900
是一个这个空

15:51.160 --> 15:52.940
说我们这边对这个new message

15:53.200 --> 15:54.480
我们要进行一定的处理

15:54.740 --> 15:57.540
首先的话他的这个blog id

15:58.060 --> 15:59.080
等于什么呢

15:59.340 --> 16:00.120
等于一个

16:00.380 --> 16:03.440
这个new message.blog id

16:03.700 --> 16:04.720
看你有没有

16:04.980 --> 16:06.240
如果有

16:06.500 --> 16:08.820
好 那你这边你的字就是

16:09.080 --> 16:11.120
你这边传过来的blog id

16:11.380 --> 16:12.900
否则是一个什么呢

16:13.160 --> 16:14.440
否则是一个路

16:15.720 --> 16:16.240
是个not

16:16.500 --> 16:17.260
是个空

16:17.740 --> 16:18.740
好的 第二个

16:19.000 --> 16:21.820
第二个的话就是关于这个new message

16:22.080 --> 16:25.140
他有一个什么呢 有一个这个叫做create that

16:26.680 --> 16:27.080
对不对

16:27.340 --> 16:28.980
create that

16:29.240 --> 16:33.860
他就应该等于什么呢 他就应该是等于一个data.no

16:34.120 --> 16:36.420
是获取当前的时间戳

16:37.440 --> 16:39.740
对不对 获取当前的时间戳

16:41.020 --> 16:42.820
好 接下来还有一个

16:43.580 --> 16:44.080
还有个什么呢

16:44.340 --> 16:45.380
你看我们这边

16:46.100 --> 16:46.860
有一个什么

16:47.120 --> 16:48.660
是不是有一个这个

16:49.420 --> 16:50.460
这个头像啊

16:51.220 --> 16:51.480
对不对

16:51.740 --> 16:55.060
这个头像的话它是随机生成的 注意

16:55.320 --> 16:57.360
有一个

16:57.880 --> 16:59.420
头像的

16:59.920 --> 17:00.440
地址

17:01.200 --> 17:03.000
该头像

17:04.810 --> 17:08.670
该头像是什么呢 是随机

17:09.430 --> 17:10.450
生成的

17:11.210 --> 17:13.270
这个头像在哪里呢 大家还记不记得

17:13.910 --> 17:17.830
这个头像是不是在我们的这个public下面有个static

17:18.090 --> 17:18.850
下面有一个

17:19.110 --> 17:19.870
avatar

17:20.650 --> 17:21.930
是不是有个data

17:22.950 --> 17:23.450
对不对

17:24.490 --> 17:27.310
他这里的话是不是你看 是不是随机生成的

17:28.830 --> 17:29.350
看到没有

17:30.630 --> 17:33.190
看到没有 我们这边有这么一些头像 随机生成

17:33.450 --> 17:39.090
有时候说那随机生成简了嘛 我这边让随机的去读一个文件 然后数一下它有多长

17:39.850 --> 17:40.350
对不对

17:40.550 --> 17:43.630
数一下它有多长 然后接下来我这边随机把这些

17:43.890 --> 17:45.430
装到一个这个数组里面

17:45.690 --> 17:48.490
把这些名字装到一个数组里面 然后随机的话

17:48.750 --> 17:50.030
然后就是取一个

17:50.290 --> 17:55.410
但是你这样子的话就是比较麻烦的就是什么呢 你如果我后期我这个avatar里面

17:55.670 --> 17:57.710
我添加了新的这个头像

17:58.230 --> 17:59.510
我又添加了新的头像

18:00.010 --> 18:02.570
那你是不是得修改你代码里面的这个数组啊

18:03.850 --> 18:04.370
对不对

18:04.630 --> 18:06.410
你得修改这个代码里面的数组

18:06.670 --> 18:09.750
说说我们这边干嘛呢 我们这边的话去读取

18:11.150 --> 18:13.150
啊 我们这边去读取这个目录

18:14.070 --> 18:14.990
读取

18:15.750 --> 18:16.510
哪个目录啊

18:16.950 --> 18:18.230
读取这个

18:18.990 --> 18:20.270
啊 Static

18:21.550 --> 18:24.150
Static 下面的

18:24.390 --> 18:25.350
avatar

18:27.350 --> 18:28.630
avatar目录

18:29.670 --> 18:30.190
看不看

18:30.430 --> 18:31.950
我们去读取啊

18:32.230 --> 18:34.790
那我们这边的话我们就写一个方法

18:36.670 --> 18:37.790
这边的话我们就

18:38.350 --> 18:39.150
在这上面吧

18:39.390 --> 18:40.550
我们来书写一个方法

18:41.030 --> 18:42.550
这边呢就是 a sync

18:43.310 --> 18:44.350
一个方形

18:45.870 --> 18:48.430
方形啊 这边呢叫做 read

18:49.190 --> 18:50.110
dir

18:50.470 --> 18:51.150
nose

18:52.430 --> 18:55.870
就读取你这个目录里面有多少个文件

18:57.390 --> 18:59.190
接受一个什么呢 接受一个

18:59.430 --> 19:00.990
你给传一个这个目录给我

19:02.070 --> 19:03.230
好 这边写一下啊

19:04.070 --> 19:04.830
这边的话

19:06.710 --> 19:07.390
读取

19:08.670 --> 19:09.830
读取

19:10.910 --> 19:12.910
一个目录下

19:13.430 --> 19:16.910
有多少个文件

19:17.430 --> 19:19.910
啊 这边的话这个接受一个参数 这个就是什么呢

19:20.150 --> 19:21.750
这个就是目录地址

19:22.710 --> 19:23.110
OK

19:23.550 --> 19:24.710
好了 这边的话就是

19:25.070 --> 19:25.990
返回一个什么呢

19:26.270 --> 19:29.710
我们这边的话就是返回一个 new promise

19:31.230 --> 19:32.270
啊 new promise

19:32.790 --> 19:33.550
好 这边呢

19:33.790 --> 19:34.670
resolve

19:37.060 --> 19:37.460
OK

19:37.740 --> 19:39.780
那这地方是不肯定得用的 FS 某块

19:40.540 --> 19:41.940
对 Fs

19:43.180 --> 19:44.660
啊 这边我们引入一下吗

19:44.940 --> 19:51.580
const fs 等于一个 require fs

19:52.900 --> 19:53.420
对吧

19:53.700 --> 19:56.620
好 然后在这边就 fs 点什么呢

19:56.860 --> 19:57.780
read

19:58.700 --> 20:00.340
他有一个方法叫做 read

20:00.580 --> 20:01.380
dir

20:02.140 --> 20:03.020
有这么一个方法

20:03.300 --> 20:05.220
啊 这个方法里面的话接受一个什么呢

20:05.460 --> 20:06.980
接受一个回调

20:07.180 --> 20:09.300
首先第一个 第一个是你要读的这个目录

20:09.660 --> 20:10.340
啊 接受

20:10.580 --> 20:13.140
那第二个 第二个的话是一个回调函数

20:14.140 --> 20:14.580
OK

20:14.820 --> 20:17.540
好 这个回调函数里面首先第一个是错误对象

20:17.780 --> 20:19.860
第二个的话就是这个 files

20:20.380 --> 20:21.900
就读出来了这个文件

20:22.140 --> 20:24.300
好 然后加这边呢我们就是 if

20:24.980 --> 20:25.500
arrow

20:25.740 --> 20:27.540
如果有错我们就干嘛呢

20:27.780 --> 20:30.860
我们这边的话就应该是抛出我们自定义的错误是吧

20:31.140 --> 20:34.860
那我们这边呢就是抛出一个 snow new

20:35.340 --> 20:37.260
这个 unknown

20:38.020 --> 20:38.540
arrow

20:41.510 --> 20:43.830
其实这边不应该叫做 unknown

20:44.190 --> 20:45.630
但是其实这里不会爆出

20:46.390 --> 20:46.710
对不对

20:46.950 --> 20:49.350
你这边知道你的这个目录长什么样子

20:49.590 --> 20:50.390
啊 这边读取

20:50.630 --> 20:51.750
啊 这边是不会爆出的

20:52.270 --> 20:54.590
如果你这边的话你要再去

20:55.110 --> 20:57.390
扩展一下的话 你可以把你的这个 arrow

20:58.430 --> 21:00.470
把这边呢 你再加一个错误类型就可以了

21:01.750 --> 21:04.070
可不可以啊 我这边呢没有对应的这个错误类型

21:04.550 --> 21:05.590
啊 你如果这个

21:06.110 --> 21:08.150
非要那个的话 你就再加一个错误类型

21:08.390 --> 21:11.510
啊 我这边我就懒得加了啊 我这边就直接写这个 unknown

21:11.750 --> 21:12.390
这个 arrow

21:12.590 --> 21:15.150
啊 抛出这个 我们自己的这个错误

21:15.670 --> 21:17.470
啊 但这个是有错误的情况下

21:17.710 --> 21:19.270
啊 否则的话 我们这边就干嘛呢

21:19.510 --> 21:21.310
我们这边呢 就resolve

21:22.070 --> 21:23.750
这个files

21:24.870 --> 21:25.350
ok

21:25.670 --> 21:26.670
resolve files

21:27.190 --> 21:30.670
好 然后接下来的话 这边 我们拿到这个files

21:32.070 --> 21:33.070
拿到这下面

21:33.830 --> 21:35.390
这边的话 我们就

21:35.910 --> 21:36.430
呃

21:36.790 --> 21:37.350
调用

21:38.910 --> 21:40.070
这边的话就是

21:41.110 --> 21:41.870
read

21:42.310 --> 21:43.350
dir.lens

21:44.110 --> 21:44.430
啊

21:44.670 --> 21:45.550
然后把什么呢

21:45.790 --> 21:47.350
把我们的这个dir

21:48.030 --> 21:48.870
把它传进去

21:49.150 --> 21:50.630
啊 让我们这边呢 就const

21:51.270 --> 21:51.910
在这里

21:52.670 --> 21:53.750
我们const

21:54.950 --> 21:56.510
const 一个dir

21:56.990 --> 21:57.710
等于什么呢

21:57.950 --> 22:00.510
等于一个当前目录下面的

22:01.030 --> 22:01.790
public

22:02.230 --> 22:03.070
下面的

22:03.590 --> 22:04.350
static

22:04.590 --> 22:05.310
下面的什么

22:06.070 --> 22:06.910
这个avatar

22:08.350 --> 22:10.350
对不对 这个是我们的这个目录地址

22:10.790 --> 22:11.830
好 把这个目录

22:12.590 --> 22:13.110
把它

22:13.630 --> 22:14.310
传进去

22:15.230 --> 22:15.670
对不对

22:16.430 --> 22:18.670
好 传进去之后 然后接下这边等待

22:20.780 --> 22:21.980
这边的话

22:22.500 --> 22:22.980
等待

22:23.220 --> 22:25.300
等待之后 然后接下它会返回一个什么呢

22:25.540 --> 22:27.420
会返回一个files

22:28.660 --> 22:29.220
是不是拿到

22:29.740 --> 22:32.020
好 拿到之后 然后接下来我们这边的话

22:32.260 --> 22:33.060
const

22:33.300 --> 22:34.660
一个random

22:36.140 --> 22:37.580
random index

22:37.820 --> 22:39.220
就随机的这个下标

22:39.460 --> 22:40.740
他就应该等于什么呢

22:40.940 --> 22:43.260
等于max.flaw

22:43.780 --> 22:47.100
然后接下来这边max.random

22:47.500 --> 22:49.660
然后乘以他的什么呢 可能性数

22:49.940 --> 22:51.900
可能性数是不是应该是你的

22:52.740 --> 22:54.780
files.nse

22:55.540 --> 22:59.620
对不对 加上第1个可能值 第1个可能值是不是应该是从零开始

23:00.380 --> 23:01.940
对不对 从零开始这边就不用加了

23:03.220 --> 23:03.740
OK

23:04.500 --> 23:06.540
那这里的话 是不是就拿到一个这个随机的

23:07.300 --> 23:08.340
随机的这个下标

23:08.580 --> 23:10.260
对不对 根据你这边这个

23:10.460 --> 23:12.460
这个文件的长度

23:12.700 --> 23:14.060
拿到一个随机的下标

23:14.300 --> 23:16.380
好 然后接下来的话 我们这边那就是

23:16.860 --> 23:18.140
new message

23:19.420 --> 23:20.980
点这个avata

23:21.980 --> 23:23.340
他就应该等于什么呢

23:23.580 --> 23:24.660
等于一个

23:24.900 --> 23:26.100
static

23:26.620 --> 23:29.100
下面的这个avata

23:30.700 --> 23:31.620
avata

23:31.900 --> 23:33.780
然后接下来再拼接一个什么

23:34.020 --> 23:36.260
再拼接一个这个files

23:38.580 --> 23:39.380
files

23:39.620 --> 23:40.380
对应了什么

23:40.660 --> 23:43.100
是不是这个random index

23:44.060 --> 23:46.100
是不是这个avata的这个就出来了

23:46.740 --> 23:47.260
对不对

23:47.500 --> 23:48.540
好 出来之后

23:48.540 --> 23:50.220
然后接下来我们就需要干嘛呢

23:50.460 --> 23:51.740
接下来开始新增

23:52.980 --> 23:54.740
接下来开始

23:55.180 --> 23:55.940
新增

23:56.220 --> 23:58.060
这边的话是读取 读取了之后

23:58.060 --> 23:58.780
再加这边

23:59.020 --> 23:59.980
我写下注释

24:00.220 --> 24:02.540
随机摇一个文件

24:04.660 --> 24:06.580
摇一个文件

24:06.940 --> 24:07.420
出来

24:07.860 --> 24:09.300
对不对 随机摇一个

24:09.580 --> 24:11.340
好 然后接下来我们只能够这个

24:11.340 --> 24:12.380
new message

24:13.140 --> 24:13.900
就准备好了

24:14.420 --> 24:17.740
准备好了之后再加我们这边开始这个新增

24:19.020 --> 24:20.300
开始新增的话 我们这边

24:21.580 --> 24:23.900
对应我们的这个dao这边

24:24.380 --> 24:25.660
这边我们还没写是吧

24:26.940 --> 24:29.260
那我们这边那就是model.expose

24:30.540 --> 24:33.860
model.expose

24:34.380 --> 24:35.660
然后这边点

24:35.900 --> 24:36.940
and

24:37.700 --> 24:38.740
message

24:38.980 --> 24:39.740
dao

24:40.260 --> 24:41.300
等于一个

24:41.540 --> 24:42.060
sync

24:43.080 --> 24:43.600
function

24:44.620 --> 24:46.420
他这边就应该拿到一个什么

24:46.660 --> 24:49.220
是吧 拿到一个new message

24:50.260 --> 24:51.780
对不对 一个新的信息

24:52.040 --> 24:52.820
他这边简单

24:53.080 --> 24:54.860
他这边的话就只需要这边

24:55.120 --> 24:56.660
message model

24:56.920 --> 24:59.220
然后调什么 是不是调这个quade的方法

24:59.480 --> 25:00.500
是不是新增就可以了

25:01.000 --> 25:02.540
对不对 把你的这个new message

25:03.060 --> 25:03.820
传过去

25:04.080 --> 25:06.120
这一层其实很简单

25:06.380 --> 25:07.400
好 这边等待一下

25:07.920 --> 25:10.220
等待之后然后加这边Const

25:11.860 --> 25:12.620
这边的话

25:12.920 --> 25:13.700
data

25:13.960 --> 25:14.980
values

25:15.740 --> 25:17.800
对不对 然后加这边返回

25:18.300 --> 25:19.740
返回这边新增的

25:20.000 --> 25:21.120
data values

25:22.400 --> 25:22.900
对不对

25:23.160 --> 25:24.200
好 然后加这边

25:24.460 --> 25:25.220
回到我们这边

25:25.480 --> 25:28.800
这边的话是不是就应该是调用刚才内存的这个方法

25:29.320 --> 25:30.340
好 这边那就是

25:31.100 --> 25:31.620
await

25:32.120 --> 25:33.660
这边那就是and

25:33.920 --> 25:34.940
message

25:35.200 --> 25:35.960
dao

25:36.480 --> 25:38.780
然后把你的这个new message

25:39.560 --> 25:40.320
就拿过去

25:40.780 --> 25:43.100
对不对 拿过去之后再加这边const

25:43.360 --> 25:43.860
data

25:45.400 --> 25:45.900
data

25:46.160 --> 25:47.440
拿到新增的数据

25:47.960 --> 25:50.780
好 拿到了新增的数据 然后你以为就完了吗

25:51.280 --> 25:52.040
不是

25:52.300 --> 25:55.380
不是 这边的话其实还有一件事情

25:56.660 --> 25:57.680
还有一件事情

25:57.940 --> 25:58.440
怎么事情呢

25:58.700 --> 26:01.000
你这边的话如果是评论的话

26:01.260 --> 26:04.080
那你的那个文章的评论数是不是要加加呀

26:04.840 --> 26:05.360
对不对

26:05.620 --> 26:06.640
如果

26:07.400 --> 26:10.220
如果是文章的

26:10.520 --> 26:11.600
评论数

26:11.860 --> 26:13.400
如果是文章的评论

26:13.900 --> 26:17.240
那么对应文章的

26:17.740 --> 26:19.020
这个评论

26:19.280 --> 26:20.300
数量

26:20.820 --> 26:22.100
是不是也要

26:22.600 --> 26:23.380
自征啊

26:24.660 --> 26:25.160
对不对

26:25.420 --> 26:27.480
说说这边你得做个判断

26:27.980 --> 26:30.040
说说你现在你慢慢就体会得到

26:30.300 --> 26:32.080
什么叫做业务逻辑层

26:32.840 --> 26:35.400
业务逻辑层 你看这些这些是不是就是业务逻辑

26:36.440 --> 26:36.940
对不对

26:37.200 --> 26:38.220
这些就是业务逻辑

26:38.940 --> 26:43.300
我这边的话我这个DNO这一层DNO这一层其实做得很简单

26:43.540 --> 26:46.880
这一层是不是就是专门负责和数据库打交道

26:47.640 --> 26:50.980
对不对 增加一个数据 然后删除一个数据 更新一个数据

26:51.240 --> 26:53.280
我不管其他的业务逻辑的

26:53.800 --> 26:56.100
我不管你是什么该不该新增

26:56.600 --> 26:57.880
该不该删除

26:58.140 --> 27:00.700
该不该这个修改 我都不管

27:00.960 --> 27:03.000
你既然来到我这一层

27:03.260 --> 27:06.340
你命令我干嘛我就干嘛 你命令我新增

27:06.840 --> 27:07.360
我就新增

27:07.820 --> 27:12.680
对不对 那你所有的这些什么该不该新增 该不该删除 该不该修改

27:12.940 --> 27:16.020
或者说比如说修改了之后要干嘛都放在哪里

27:16.280 --> 27:17.560
都放在这一层

27:18.580 --> 27:19.080
对不对

27:19.340 --> 27:20.380
都放在这一层

27:21.140 --> 27:22.420
你现在的话就稍微

27:22.680 --> 27:24.200
清晰点没有 各位

27:24.980 --> 27:26.000
有没有清晰点

27:27.020 --> 27:30.600
所以这边就判断 这边就是New Message

27:31.380 --> 27:34.200
点什么呢 点这个如果他有BlogID

27:34.920 --> 27:39.320
OK 那我们这边呢 是不是根据他的这个BlogID

27:39.580 --> 27:40.860
是不是来找到这篇博文

27:41.620 --> 27:43.660
对不对 那我们这边呢就是直接

27:43.920 --> 27:44.700
await

27:45.200 --> 27:47.780
这边呢他有个方法 这个方法叫做Fender

27:48.800 --> 27:49.560
Blog

27:49.820 --> 27:50.580
byID

27:51.100 --> 27:51.600
DAO

27:51.860 --> 27:53.400
这个是我们之前写好了的

27:54.680 --> 27:55.440
你看一下

27:56.220 --> 27:56.980
在

27:58.260 --> 28:02.100
在哪里 在这个BlogDAO里面

28:02.620 --> 28:03.380
这边是不是写了的

28:03.840 --> 28:05.640
FenderBlogByID

28:06.660 --> 28:08.960
对不对 写了的 根据这个

28:09.220 --> 28:10.760
根据这个组件来找

28:11.020 --> 28:12.560
所以我们这边就直接

28:12.800 --> 28:13.560
把什么呢

28:13.820 --> 28:15.880
把这个NewMessage

28:16.640 --> 28:18.440
点这个BlogID

28:19.200 --> 28:20.240
把它传过去

28:21.000 --> 28:24.320
对不对 传过去之后再加这边Const

28:24.580 --> 28:26.360
BlogData

28:26.620 --> 28:28.680
注意啊 你这边就拿到你的这个

28:28.940 --> 28:31.240
这篇博客 这篇博客的信息

28:31.500 --> 28:32.520
这篇博客

28:33.500 --> 28:35.280
这篇博客 他有一个什么呢

28:35.540 --> 28:37.560
他有一个comment

28:38.820 --> 28:39.640
lumber

28:39.900 --> 28:41.180
是不是应该是加加

28:42.200 --> 28:45.520
对不对 加加完了之后再加进这边等待一下

28:46.040 --> 28:50.400
BlogData.save

28:50.900 --> 28:51.680
是保存

28:52.440 --> 28:55.760
对吧 保存完了之后 然后接下来这边再来return

28:56.280 --> 28:57.300
这边return

28:57.560 --> 28:59.360
format

29:00.640 --> 29:01.660
format

29:02.120 --> 29:02.900
resbounce

29:03.400 --> 29:04.940
好 这边就是0

29:05.440 --> 29:06.480
然后这个

29:06.740 --> 29:07.960
然后接下来的话

29:08.220 --> 29:08.740
data

29:09.540 --> 29:11.860
ok 那我们整个这个新增

29:12.360 --> 29:13.380
我们就写完了

29:13.900 --> 29:15.180
新增就写完了

29:15.440 --> 29:17.220
好 那我们这边让我们来看一下

29:17.740 --> 29:19.280
来看一下好不好 保存

29:19.780 --> 29:21.080
首先看一下他会不会爆错

29:21.840 --> 29:22.860
不会爆错 是吧

29:23.120 --> 29:25.160
不会爆错 然后接下来来到我们这边

29:25.420 --> 29:26.700
这边就应该是post

29:28.240 --> 29:30.800
post 然后接下来我们这边如果是

29:31.020 --> 29:32.040
message

29:32.540 --> 29:33.820
message 是不是留言

29:34.580 --> 29:36.900
对不对 留言 然后我们这边的话

29:37.420 --> 29:39.720
留言 留言

29:39.980 --> 29:42.020
我们这边的话留言

29:42.280 --> 29:44.060
提交留言 我们就用这个

29:44.580 --> 29:45.340
就用这个

29:47.170 --> 29:48.450
好 拿过来

29:49.470 --> 29:50.490
走

29:52.030 --> 29:53.050
爆错了 是吧

29:53.310 --> 29:55.370
爆错了 我们这边我们过来看一下什么错

29:56.890 --> 30:01.250
update banner service is not defined

30:03.090 --> 30:04.890
好 这边肯定是哪没改到

30:05.330 --> 30:06.610
哦 这里这里

30:08.510 --> 30:09.510
这里是不是

30:10.590 --> 30:12.670
应该没了吧 保存

30:14.670 --> 30:16.030
我看一下我看一下

30:16.790 --> 30:17.350
ok

30:20.080 --> 30:20.920
ok and

30:21.160 --> 30:22.160
应该是没问题的

30:22.400 --> 30:23.360
好 这边再来

30:24.840 --> 30:26.360
再来 走

30:27.320 --> 30:27.880
哦

30:28.800 --> 30:29.880
这边卡住了

30:31.320 --> 30:32.720
这边怎么会卡住呢

30:33.920 --> 30:35.760
到这边res是剩的

30:36.540 --> 30:38.860
然后这边and message service

30:39.660 --> 30:42.140
and message service

30:43.020 --> 30:43.900
啊 这边对的呗

30:45.540 --> 30:47.340
好 大家这边最后return了的呀

30:49.580 --> 30:50.380
return了的呀

30:51.980 --> 30:53.620
怎么会卡住了 他在哪儿卡住了

30:53.900 --> 30:54.540
我看一下

30:56.060 --> 30:56.500
这边

30:57.380 --> 30:58.740
这边也是return了的呀

31:00.380 --> 31:01.660
这边return了

31:02.820 --> 31:03.780
然后

31:06.060 --> 31:08.140
这边啊 我们来看一下啊

31:09.020 --> 31:10.020
这边怎么回事

31:11.940 --> 31:13.780
我们首先看一下这边 这边这个data

31:14.220 --> 31:14.980
能不能出来

31:15.780 --> 31:16.580
这边log

31:17.260 --> 31:18.420
log data

31:21.240 --> 31:21.840
好 保存

31:24.600 --> 31:26.600
好 保存之后 然后接下来到这边

31:27.400 --> 31:28.520
然后走

31:29.560 --> 31:30.600
然后过来看一眼

31:31.600 --> 31:32.480
这儿都没到

31:33.240 --> 31:33.720
是不是

31:34.360 --> 31:35.080
这儿都没到

31:35.680 --> 31:38.040
这儿都没到 然后接下来我们看一下

31:39.520 --> 31:41.320
嗯 看一下这边的验证结果

31:42.260 --> 31:45.220
首先看一下这边 这边的这个newmessage 这边过来没有

31:46.460 --> 31:48.780
log newmessage

31:51.300 --> 31:51.740
保存

31:53.880 --> 31:55.480
好 保存之后 然后接下来这边

31:56.120 --> 31:56.560
走

31:57.600 --> 31:58.560
那这边来看一下

32:01.320 --> 32:03.160
是不是这边都没过来

32:03.640 --> 32:06.800
newmessage interesting 这边都没过来

32:07.320 --> 32:10.200
好 这边都没过来的话 那这里的话

32:11.100 --> 32:13.300
啊 啊 我们

32:14.100 --> 32:14.780
是不是写错了

32:15.340 --> 32:15.700
对不对

32:16.620 --> 32:17.580
这边是post

32:18.220 --> 32:20.580
啊 这边的话是或许 或许是get

32:21.220 --> 32:24.020
对不对 删除删除的是delete

32:24.780 --> 32:26.180
对不对啊 保存

32:26.700 --> 32:27.820
啊 这次应该就ok了

32:28.820 --> 32:30.940
啊 我们这边让我们这边再来走

32:32.580 --> 32:33.180
是不是ok了

32:34.380 --> 32:34.780
对不对

32:35.420 --> 32:36.180
这边就ok了

32:36.780 --> 32:39.780
啊 我们这边呢 这个新增啊 它是一个什么呢

32:39.780 --> 32:41.840
它是一个留言

32:42.340 --> 32:44.640
对不对 留言所以这边blog id是一个now

32:44.900 --> 32:46.680
啊 你这边让你回头看一下这个数据库

32:47.720 --> 32:49.760
啊 虽然这个数据库的话 每次我们得

32:50.020 --> 32:51.300
手动刷新一下

32:52.840 --> 32:54.880
啊 这边得把它关掉

32:55.140 --> 32:57.200
它的刷新功能就像一个摆设一样

32:57.700 --> 32:58.200
就出来了

32:58.980 --> 32:59.480
对不对

33:00.000 --> 33:00.260
出来了

33:00.760 --> 33:02.560
好 那接下来我们这边 我们如果是comment

33:04.600 --> 33:05.640
如果是comment

33:05.880 --> 33:08.440
comment的话 然后接下来的话 你这边叫加一个什么

33:09.160 --> 33:09.940
所以加一个字段

33:10.700 --> 33:13.260
对不对 加一个这个blog

33:14.020 --> 33:14.540
id

33:15.300 --> 33:16.080
啊 对应

33:16.340 --> 33:19.400
好 比如说我们这边的话 我们针对某篇文章进行一个评论

33:19.920 --> 33:22.220
我们这边就针对这个id为5吗

33:22.480 --> 33:25.040
id为5 它现在的话评论数是0

33:25.800 --> 33:28.100
我们这边就针对id为5的

33:28.620 --> 33:29.900
好 这边那就是

33:30.420 --> 33:32.460
啊 这边随便加点啊 22

33:33.220 --> 33:34.000
22

33:34.760 --> 33:35.260
好 走

33:36.260 --> 33:39.000
诶 这边数据教验失败了

33:40.840 --> 33:44.440
数据教验失败 好 我们这边我们来看一下

33:46.220 --> 33:47.240
数据教验失败

33:49.040 --> 33:50.560
啊 把这个这个就删了

33:51.600 --> 33:53.120
数据教验失败看哪个

33:53.380 --> 33:54.160
是不是看这个

33:54.420 --> 33:54.920
对不对

33:55.180 --> 33:56.200
这边log一下

33:56.720 --> 34:01.320
vd.result

34:02.080 --> 34:04.640
啊 然后这边也不用打印了

34:06.080 --> 34:06.760
好 保存

34:09.280 --> 34:11.840
好 保存之后然后接下这边来看一眼

34:12.100 --> 34:12.600
走

34:13.120 --> 34:14.640
然后这里看一下怎么失败了

34:15.880 --> 34:19.520
哦 他must必须是一个支付串 啊 必须是个支付串

34:21.980 --> 34:22.740
是不是支付串

34:23.260 --> 34:24.800
我这边我们看一下这个接口文章

34:26.020 --> 34:27.740
这边如果是评论

34:28.740 --> 34:31.460
博客文章 然后

34:32.940 --> 34:34.540
呃 添加评论

34:35.820 --> 34:37.100
啊 四个支付串是吧

34:37.560 --> 34:38.840
好 那我们这边把这儿改一下

34:40.380 --> 34:41.400
啊 这边那就是

34:41.920 --> 34:42.680
这个 这个

34:43.440 --> 34:43.960
啊 走

34:45.240 --> 34:45.760
是不是OK了

34:46.520 --> 34:49.080
对不对 OK 之后再加你这边回数据库看一下

34:49.840 --> 34:51.120
把这个关掉

34:51.880 --> 34:52.920
这边重新打开

34:53.680 --> 34:54.460
你看这边

34:54.720 --> 34:56.760
这边的评论书是不是新增一

34:57.520 --> 34:58.040
对不对

34:58.300 --> 34:59.320
评论书新增一

34:59.580 --> 35:01.120
好 这边的这个message

35:01.880 --> 35:02.920
message他这边

35:03.920 --> 35:06.760
这边他这个的话是不是就是这里的话就不再是这个空

35:07.100 --> 35:09.660
他是有具体的这个博客的这个ID

35:10.440 --> 35:10.940
看了没有

35:11.700 --> 35:12.720
有具体的博客ID

35:12.980 --> 35:15.280
啊 这就是关于我们的这个新增功能

35:16.060 --> 35:17.340
啊 我们就写完了

35:17.840 --> 35:18.620
其实还是很简单

35:19.640 --> 35:19.900
是吧

35:20.420 --> 35:21.180
挺简单的

35:21.700 --> 35:23.220
好 新增写完了

35:23.480 --> 35:25.780
新增写完了之后 然后接下来我们继续

35:26.040 --> 35:29.120
剩下两个 剩下两个的话就简单了

35:29.380 --> 35:31.160
我们这边首先来写什么呢

35:31.420 --> 35:32.440
先写这个

35:33.720 --> 35:35.000
分页获取吧

35:35.520 --> 35:36.540
先写分页获取

35:37.820 --> 35:39.360
啊 这边的话分页

35:40.880 --> 35:42.420
分页获取

35:42.940 --> 35:43.700
评论

35:43.960 --> 35:44.980
或者

35:45.760 --> 35:46.520
留言

35:47.040 --> 35:51.140
好 这边的就是model.exports

35:52.160 --> 35:53.440
model.exports

35:53.700 --> 35:56.520
然后接下来这边的就是有一个叫做fender

35:57.280 --> 35:58.040
message

35:58.300 --> 35:59.320
然后by

36:00.080 --> 36:00.600
page

36:00.860 --> 36:01.360
然后

36:01.880 --> 36:02.660
service

36:02.920 --> 36:04.700
你不要怕这个名字长

36:04.960 --> 36:05.980
不要怕这个名字长

36:06.440 --> 36:08.500
你关键是什么呢 关键是好维护

36:09.760 --> 36:10.280
知道吧

36:10.800 --> 36:12.080
关键是好维护

36:12.840 --> 36:14.380
我外面都开始放烟花了

36:15.140 --> 36:16.680
马上要过年了

36:17.440 --> 36:19.240
现在1月19号

36:19.760 --> 36:20.780
马上要过年了

36:21.040 --> 36:23.600
我也不知道你看这个视频是什么时候

36:23.860 --> 36:26.420
有可能你看这个视频的时候是大夏天

36:26.680 --> 36:27.180
是吧

36:27.440 --> 36:31.540
现在的话我录这个视频是2022年1月19号

36:32.040 --> 36:32.960
星期三

36:33.220 --> 36:34.860
晚上快10点钟了

36:36.200 --> 36:38.480
好 然后我们这边继续 把这讲完

36:38.740 --> 36:40.280
讲完我今天晚上我就休息了

36:41.560 --> 36:42.600
function

36:43.880 --> 36:45.920
然后接下来他应该接受一个什么

36:46.180 --> 36:49.240
他是不是就是应该是接受一个你分页的这个信息

36:50.000 --> 36:52.560
对不对 所以这边就是page infer

36:53.080 --> 36:55.080
接受你一个分页的这个信息

36:55.340 --> 36:56.420
你这边你看一下

36:57.180 --> 37:00.240
比如说我这边的话 我分页获取评论

37:00.500 --> 37:02.040
他是不是就是传这些信息

37:03.320 --> 37:04.860
对不对 传这些信息

37:04.960 --> 37:07.880
有page 有limit 有blog ID

37:08.140 --> 37:09.680
还有这个比如说keyword

37:10.180 --> 37:14.280
有这些信息 就和我们那个分页获取博客是一样的

37:15.040 --> 37:16.580
分页获取博客是一样的

37:16.840 --> 37:17.880
好 那我们这边

37:19.140 --> 37:20.180
这边的话

37:20.680 --> 37:22.220
我们在这个

37:23.880 --> 37:25.560
在message.do这边

37:26.060 --> 37:27.340
这边把注释写下

37:27.840 --> 37:32.460
这边的话是添加留言或者评论

37:33.320 --> 37:35.420
好 然后接下来这边model

37:36.380 --> 37:39.860
model.pods.

37:41.220 --> 37:42.860
这边的话就是应该是

37:43.420 --> 37:44.100
fand

37:44.700 --> 37:46.620
fand message

37:46.760 --> 37:51.560
然后by page.do等于一个

37:52.060 --> 37:52.860
sync

37:54.420 --> 37:56.220
sync function

37:57.100 --> 37:59.820
这边是不是应该是接受一个你的分页信息

38:02.280 --> 38:04.120
对不对 这个是分页

38:05.000 --> 38:06.640
分页获取

38:07.060 --> 38:10.640
这个留言或者评论

38:11.160 --> 38:15.000
当我们现在的话 这个留言和评论很少

38:15.500 --> 38:18.420
很少 我们这边多添加点嘛 反正有pods.me

38:19.080 --> 38:21.640
是吧 我们这个评论我们添加个10条

38:22.400 --> 38:23.240
这边1

38:23.880 --> 38:24.380
2

38:24.880 --> 38:25.380
3

38:25.640 --> 38:26.140
4

38:26.520 --> 38:27.020
5

38:27.280 --> 38:27.780
6

38:28.040 --> 38:28.540
7

38:28.800 --> 38:29.300
8

38:29.560 --> 38:30.060
9

38:30.320 --> 38:30.720
10

38:30.980 --> 38:31.700
添加10条

38:31.960 --> 38:33.480
好 然后接下来这边

38:33.960 --> 38:34.600
留言

38:35.120 --> 38:36.440
留言再来个10条

38:36.760 --> 38:38.200
留言是不是就没有这玩意儿了

38:39.080 --> 38:39.480
对不对

38:39.960 --> 38:40.840
就没有这玩意儿了

38:41.120 --> 38:42.480
好 这边来添加一下

38:43.160 --> 38:43.660
1

38:44.180 --> 38:44.680
2

38:45.120 --> 38:45.620
3

38:45.880 --> 38:46.360
4

38:46.600 --> 38:47.100
5

38:47.360 --> 38:47.700
6

38:47.880 --> 38:48.360
7

38:48.640 --> 38:49.060
8

38:49.320 --> 38:49.820
9

38:50.080 --> 38:50.320
10

38:50.560 --> 38:51.160
好 搞定

38:51.600 --> 38:53.920
好 搞定这边的数据过来 过来漏一眼

38:55.200 --> 38:56.200
我又得把他关掉

38:56.600 --> 38:57.680
他的刷新

38:57.960 --> 38:59.240
由如一个摆设

39:00.160 --> 39:00.760
这边有了

39:01.480 --> 39:02.880
对不对 这边就有了

39:03.360 --> 39:06.720
有了之后 然后接下来的话 来到我们这边

39:08.240 --> 39:09.280
这边我们要获取

39:10.560 --> 39:12.360
获取的话 这边的话就是

39:13.120 --> 39:15.680
得根据什么呢 根据这个blog id

39:16.440 --> 39:16.960
来

39:17.220 --> 39:17.980
就是分情况

39:18.760 --> 39:19.520
这边我写一下

39:20.800 --> 39:21.320
这里

39:21.560 --> 39:23.360
需要根据什么呢

39:23.880 --> 39:26.440
根据blog id

39:27.200 --> 39:27.720
来

39:27.960 --> 39:29.000
区分情况

39:30.520 --> 39:31.300
区分情况

39:31.560 --> 39:32.320
为什么呢

39:32.520 --> 39:34.580
因为你如果是这个

39:34.840 --> 39:35.860
有blog id

39:36.620 --> 39:38.160
你说明你是获取什么

39:38.420 --> 39:41.740
说获取的是对应blog id的这个评论

39:42.780 --> 39:43.280
对不对

39:43.540 --> 39:45.320
你如果没有blog id

39:45.580 --> 39:46.340
说明什么

39:46.600 --> 39:47.900
说明是不是获取留言

39:48.400 --> 39:48.920
对不对

39:49.180 --> 39:50.440
如果

39:51.480 --> 39:53.260
如果有

39:54.020 --> 39:55.580
blog id

39:56.080 --> 39:57.360
说明是

39:57.880 --> 39:58.900
获取什么呢

39:59.400 --> 40:00.180
获取

40:00.440 --> 40:01.460
对应

40:01.940 --> 40:06.540
blog id的这个文章

40:07.300 --> 40:08.060
评论

40:08.320 --> 40:08.840
对不对

40:09.100 --> 40:10.880
如果没有

40:11.140 --> 40:12.680
说明是

40:12.940 --> 40:13.960
获取什么呢

40:14.220 --> 40:15.500
说获取留言啊

40:16.520 --> 40:17.020
对不对

40:17.280 --> 40:20.100
说这边的话 你需要做这么一个判断

40:20.620 --> 40:21.380
if

40:22.660 --> 40:23.940
这边的话这个

40:24.700 --> 40:26.500
pg infer

40:27.260 --> 40:29.060
点这个blog id

40:31.090 --> 40:32.110
如果他有这个

40:32.310 --> 40:34.370
传了这个blog id过来

40:34.630 --> 40:37.170
那这边他是获取这个评论

40:37.430 --> 40:38.710
否则的话

40:39.750 --> 40:40.770
他是获取什么呢

40:41.030 --> 40:43.070
否则的话他是获取留言

40:44.610 --> 40:45.370
获取

40:45.630 --> 40:46.650
留言

40:47.930 --> 40:49.730
好 获取留言我们先来写这个留言

40:49.990 --> 40:50.750
留言很简单

40:51.270 --> 40:53.570
这边呢就是message model

40:54.070 --> 40:54.850
点什么呢

40:55.110 --> 40:57.670
点fender and counter or

40:58.430 --> 40:59.190
掉这个方法

40:59.710 --> 41:00.990
好 然后接下来这边

41:01.190 --> 41:02.230
传一个对象

41:02.490 --> 41:04.530
对象里面然后接下来这边

41:06.340 --> 41:07.380
offset

41:08.140 --> 41:10.440
这边就应该是对应的是你的这个

41:10.700 --> 41:12.380
pg infer

41:13.000 --> 41:14.280
点pg

41:15.060 --> 41:17.100
呈一个什么呢 呈一个e

41:17.360 --> 41:18.380
减一个e

41:18.640 --> 41:20.180
这个应该很熟悉啊

41:20.440 --> 41:21.460
呈一个什么

41:21.720 --> 41:25.040
pg infer点limit

41:26.060 --> 41:26.580
对不对

41:26.840 --> 41:29.640
好 大家那limit 就应该等于什么

41:29.900 --> 41:31.180
pg infer

41:31.980 --> 41:33.420
点limit

41:33.680 --> 41:34.620
呈一个e

41:35.380 --> 41:37.020
对不对 把它转成这个数字

41:37.280 --> 41:38.820
首先这个分页就写好了

41:39.320 --> 41:41.620
分页写好之后 然后接下来这边vier

41:42.900 --> 41:43.680
vier什么呢

41:43.940 --> 41:46.240
vier的话这边是不是应该是blog

41:47.780 --> 41:48.540
id

41:49.300 --> 41:49.980
是什么

41:50.220 --> 41:51.100
是不是空

41:52.380 --> 41:54.420
对不对 是空 因为我是留言嘛

41:54.680 --> 41:56.740
留言的话 统一的这个特点就是

41:57.000 --> 41:57.940
blogid

41:58.200 --> 41:58.780
他是空

41:59.800 --> 42:00.320
对不对

42:00.680 --> 42:03.080
好 再加这边让你还可以对他进行一个排序

42:03.840 --> 42:05.900
这边让你可以进行一个order

42:07.180 --> 42:07.700
排序

42:08.200 --> 42:09.240
按照什么来排呢

42:09.500 --> 42:12.040
按照这个cret

42:12.300 --> 42:13.280
cret

42:13.540 --> 42:14.600
dat

42:14.860 --> 42:15.880
怎么排呢

42:16.140 --> 42:18.180
这边的话 dsc

42:18.440 --> 42:19.220
将去来排

42:19.980 --> 42:20.500
看到没有

42:20.760 --> 42:21.520
这个就是

42:21.780 --> 42:22.800
获取留言

42:23.560 --> 42:24.600
啊 获取留言

42:25.100 --> 42:25.620
好

42:26.380 --> 42:29.460
然后如果是获取这个评论

42:29.760 --> 42:33.240
获取评论的话 这边的话就又有两种情况

42:34.520 --> 42:36.320
又有两种情况 哪两种情况呢

42:36.840 --> 42:37.600
你看我这边

42:39.400 --> 42:40.160
你看我这边

42:40.680 --> 42:42.720
我这边的话是不是有一个这个评论管理

42:44.000 --> 42:46.320
对不对 我这边有一个评论管理模块

42:46.560 --> 42:50.400
那当我点击进去的时候 他这边是不是应该有一个这个table表格

42:50.920 --> 42:54.000
那表格里面是不是显示所有的这个评论

42:55.520 --> 42:56.040
对不对

42:56.300 --> 42:57.320
显示所有的评论

42:57.580 --> 42:59.120
但是如果我是前台

42:59.520 --> 43:02.480
前台的话 比如说我点击进去某一篇文章

43:04.280 --> 43:05.840
某一篇文章 比如这篇文章

43:06.080 --> 43:08.200
这篇文章的话 他就只获取什么

43:08.480 --> 43:12.200
所以只获取这篇文章的这个评论

43:13.760 --> 43:14.240
对不对

43:14.520 --> 43:16.200
只获取这篇文章的评论

43:16.440 --> 43:18.600
说这里的话 又分为两种情况

43:19.120 --> 43:20.400
那我这边写一下

43:21.680 --> 43:22.560
这边

43:24.460 --> 43:26.580
这边又分为

43:29.040 --> 43:30.060
又分为

43:30.580 --> 43:32.220
两种情况

43:32.440 --> 43:36.800
什么呢 获取所有的文章评论

43:37.560 --> 43:39.840
就我不管你是哪篇文章的

43:40.360 --> 43:42.400
我这边就要获取所有的这个评论

43:42.660 --> 43:44.200
只要你那个blog id

43:44.720 --> 43:45.680
不是这个nau

43:46.240 --> 43:47.680
不是那个对不是nau

43:48.200 --> 43:49.320
我就要查订到

43:49.840 --> 43:50.800
还有一种情况是什么呢

43:51.060 --> 43:53.920
我只获取对应blog id

43:54.680 --> 43:55.320
他的什么呢

43:55.580 --> 43:56.480
他的一个这个评论

43:57.220 --> 43:57.620
ok

43:59.500 --> 44:01.940
还有一种

44:02.460 --> 44:06.940
就是获取对应文章的

44:07.440 --> 44:08.220
这个评论

44:10.000 --> 44:10.260
评论

44:11.020 --> 44:11.540
ok

44:12.060 --> 44:14.860
好 那这里的话 我们应该怎么来做呢

44:15.380 --> 44:17.680
这边的话 其实我针对这个前台

44:18.440 --> 44:19.980
我稍微做了一下修改

44:20.740 --> 44:22.300
这边前台的话

44:22.540 --> 44:24.340
我找到我们 后台啊 后台

44:24.800 --> 44:27.120
后台的话 我稍微做了一点点修改

44:27.360 --> 44:29.560
我回头把这个后台我重新发给你们

44:30.320 --> 44:31.440
我回头把这个

44:31.720 --> 44:33.000
ban光的system

44:33.520 --> 44:34.520
我重新发给你们

44:34.780 --> 44:37.920
你们这边的话就是看一下这个ban光的

44:38.360 --> 44:41.440
这个system里面做了一些细节上的修改

44:41.700 --> 44:44.000
不多 就是一个小地方稍微改了一下

44:44.520 --> 44:45.280
比如说这里

44:45.540 --> 44:47.600
这里的话 我针对这个评论

44:49.120 --> 44:50.400
评论评论评论在哪里

44:50.660 --> 44:51.440
这边comment

44:52.380 --> 44:56.000
这边的话 我稍微修改了一个地方

44:57.020 --> 44:59.080
我看获取所有评论在哪里

45:00.360 --> 45:02.160
get

45:02.920 --> 45:05.980
get comment 这边传入当前的页码

45:06.240 --> 45:08.040
每一页多少

45:08.540 --> 45:10.340
那就应该是在API里面

45:11.880 --> 45:13.660
API里面comment

45:14.420 --> 45:15.460
这里看了没有

45:15.720 --> 45:17.760
我稍微做了一点点修改 就是这边什么呢

45:18.020 --> 45:20.460
blog id 我传了一个参数

45:20.660 --> 45:22.820
对应的值是什么呢 对应的值是or

45:23.940 --> 45:26.300
看了没有 对应了一个or的这个值

45:26.560 --> 45:28.200
那现在的话什么就知道了

45:28.860 --> 45:29.360
对不对

45:29.620 --> 45:31.100
那我这边的话我就可以干嘛呢

45:31.360 --> 45:32.440
这边我就很好判断了

45:32.700 --> 45:33.600
这边呢 if

45:36.000 --> 45:37.540
if你的这个

45:38.000 --> 45:38.940
pg

45:39.460 --> 45:40.220
infer

45:40.480 --> 45:42.540
他的这个blog id

45:43.300 --> 45:45.080
如果全等于什么呢

45:45.340 --> 45:47.400
如果全等于or

45:48.160 --> 45:49.440
是返回所有评论

45:50.420 --> 45:52.980
返回所有评论

45:53.240 --> 45:56.820
对不对 for the else

45:58.100 --> 45:59.380
这边就是该干嘛

45:59.640 --> 46:00.920
是返回

46:03.180 --> 46:07.780
返回对应文章的评论

46:08.560 --> 46:09.580
这边是这样子

46:10.860 --> 46:11.380
对不对

46:12.140 --> 46:14.180
好那接下来的话这边基本是差不多的

46:14.440 --> 46:15.980
我们这边刚才忘记

46:16.240 --> 46:17.780
忘记这边return了

46:18.540 --> 46:19.580
return还有什么

46:19.780 --> 46:22.860
这边基本是差不多的

46:23.120 --> 46:24.140
把这儿复制一份

46:24.660 --> 46:27.980
好然后接下来这边返回对应文章的评论

46:28.500 --> 46:30.020
这边的话只需要修改哪里

46:32.240 --> 46:33.260
这边只需要修改哪里

46:33.780 --> 46:37.860
这边的话是不是只需要修改你的这个blog id

46:38.120 --> 46:40.680
他就应该是等于一个这个pg

46:41.460 --> 46:43.000
pg infer

46:43.760 --> 46:46.320
点这个blog id

46:46.820 --> 46:48.100
成一个e

46:49.100 --> 46:50.220
这边是这样子

46:50.660 --> 46:51.180
对不对

46:51.420 --> 46:55.260
就指定返回对应的blog id

46:55.520 --> 46:58.860
就是对应这个blog id的评论

46:59.360 --> 47:02.180
这边order的话你看一下要不要排序

47:02.440 --> 47:05.000
这边也可以反正对他进行一个排序

47:05.500 --> 47:06.020
对不对

47:06.280 --> 47:07.820
好然后接下来这里

47:09.340 --> 47:09.860
上面

47:10.380 --> 47:13.700
上面的话是返回所有的评论

47:14.460 --> 47:17.020
所有的评论的话那这边的话你注意

47:17.220 --> 47:19.540
这边稍微的话这里就要改一下了

47:19.800 --> 47:21.320
首先这边ware

47:21.580 --> 47:24.660
ware的话这边对应了这个blog id

47:25.160 --> 47:26.960
他对应了值就应该是什么呢

47:27.220 --> 47:29.260
对应了值他叫等于什么呀

47:29.520 --> 47:31.060
就等于这个空

47:32.340 --> 47:32.840
对不对

47:33.100 --> 47:34.120
等于这个空

47:34.380 --> 47:36.420
等于这个空的话你这边怎么写呢

47:36.680 --> 47:38.720
这边的话对应的是一个对象

47:39.500 --> 47:43.080
这边就是op.ne

47:43.860 --> 47:45.640
然后在这边对应的是一个什么呢

47:45.900 --> 47:46.400
空

47:47.480 --> 47:48.080
看了没有

47:48.520 --> 47:52.080
注意啊这个的话是那个你要去查那个文档啊

47:52.600 --> 47:53.880
这是文档里面写的有

47:54.400 --> 47:56.960
怎么我这边我要先去给你找

47:57.220 --> 47:58.240
你自己找一下

47:58.500 --> 47:59.260
他是有的

47:59.520 --> 48:01.560
在哪个地方来着

48:03.460 --> 48:05.260
我这边一时半会我找不到了

48:05.500 --> 48:07.540
你自己找一找他有那个就是关系的

48:08.580 --> 48:10.620
就是根据那个关系来查询

48:11.380 --> 48:12.660
我看是哪个来着

48:13.440 --> 48:14.460
query type吗

48:15.740 --> 48:16.780
大字好像就是这

48:17.760 --> 48:20.060
他就在附近query type

48:21.080 --> 48:23.320
然后press action

48:23.580 --> 48:24.160
这里吗

48:26.360 --> 48:28.400
反正这个的话你得自己去找一找

48:28.660 --> 48:29.840
反正就在这个文档里面

48:30.360 --> 48:30.720
OK

48:30.980 --> 48:32.400
我不知道这个袁老师讲没有

48:32.920 --> 48:35.320
这边就是我这边的话blog id

48:35.580 --> 48:36.600
他要是这个空

48:36.860 --> 48:38.920
是空的话这边那就是可以通过这样子

48:39.420 --> 48:39.920
来写

48:40.180 --> 48:41.200
这是ware之段

48:41.460 --> 48:43.960
好然后接下来这边还需要进行一个关联

48:45.850 --> 48:47.390
关联的话是不是increw的

48:48.150 --> 48:48.670
对不对

48:48.790 --> 48:50.210
对应的是一个数组

48:50.470 --> 48:51.990
数组里面然后对象

48:52.250 --> 48:53.790
关联了这个model

48:54.550 --> 48:56.350
对应的是什么呢对应的是这个

48:56.610 --> 48:58.150
blog model

48:59.430 --> 49:01.210
然后接下来这边

49:01.730 --> 49:03.770
别名blog

49:05.050 --> 49:05.550
OK

49:05.830 --> 49:08.650
这边那就是关于查询这个所有的这个

49:08.890 --> 49:09.410
评论

49:10.690 --> 49:12.230
这边查询就出来了

49:12.730 --> 49:15.290
好出来之后然后接下来我们来看一下

49:16.070 --> 49:17.850
我看我这边return了

49:18.050 --> 49:19.850
return之后然后接下来

49:20.610 --> 49:23.690
分页查询到这边还没调是吧我们来到这个service

49:23.950 --> 49:24.710
我们来调用一下

49:25.730 --> 49:27.030
这边的话就是fand

49:29.070 --> 49:31.370
awaitfandmessage

49:33.500 --> 49:35.820
by这个pkgdlo

49:37.100 --> 49:37.860
他给我引的吗

49:39.140 --> 49:41.180
然后再把这个pkginfo

49:41.700 --> 49:42.720
把它传进去

49:42.980 --> 49:46.060
传进去之后然后将我这边const一个data

49:46.820 --> 49:47.340
等于

49:47.800 --> 49:49.600
但是你这边让你要做一下处理

49:50.880 --> 49:55.220
要做一下处理他拿到了也是就是一个数组然后里面的话是那个

49:55.480 --> 49:58.040
就是含有那个data value的那种对象

49:58.300 --> 50:00.600
这边让你对他进行处理

50:00.860 --> 50:03.160
这个我们之前处理那个

50:03.920 --> 50:07.000
处理那个好像那个博客文章我们遇到过了

50:07.260 --> 50:08.800
好这边就直接写了啊

50:09.060 --> 50:11.100
这边就用我们之前写的那个方法

50:11.360 --> 50:13.400
handle data partner

50:14.160 --> 50:16.120
然后把这个data

50:16.540 --> 50:17.160
点

50:17.620 --> 50:18.260
ros

50:18.780 --> 50:19.660
把它传进去

50:20.680 --> 50:24.100
好传进去之后然后接下来的话这边的话return

50:26.060 --> 50:27.700
return一个format

50:27.960 --> 50:28.820
racebunce

50:29.080 --> 50:30.060
这边就是0

50:30.340 --> 50:31.180
空置创

50:31.940 --> 50:33.620
然后下这边一个对象

50:33.740 --> 50:35.540
对象里面的话首先有一个

50:36.300 --> 50:36.820
toto

50:37.580 --> 50:39.100
toto对应的就是什么呢就是

50:39.380 --> 50:40.660
data.count

50:41.260 --> 50:42.700
这个我们之前是不看到过的

50:43.460 --> 50:45.140
对不对他这边返回的这个data

50:45.440 --> 50:49.360
是一个对象对象里面有一个属性叫做count

50:49.800 --> 50:52.320
count对应的就是你这个数组的这个数量

50:52.760 --> 50:54.920
大家第2个第2个的话就是这个race

50:55.280 --> 50:56.600
race对应的就是个数组

50:56.860 --> 50:58.040
数组里面就是

50:58.280 --> 51:00.600
你查出来的一个一个的这个数据

51:01.040 --> 51:02.760
只不过他是含有那个data value

51:03.280 --> 51:04.560
这个data value似的

51:04.820 --> 51:06.360
所以我们使用这个把它处理一下

51:07.120 --> 51:07.520
对吧

51:07.880 --> 51:08.900
这边是第1个

51:09.160 --> 51:10.440
第2个的话是race

51:12.580 --> 51:14.380
race对应的就是

51:14.640 --> 51:15.300
race

51:16.820 --> 51:17.280
对不对

51:17.540 --> 51:19.080
race对应的就是race

51:19.600 --> 51:20.880
好这边就返回

51:21.140 --> 51:23.180
返回了之后然后接下来这个

51:23.700 --> 51:24.700
message这边

51:26.000 --> 51:26.500
这边

51:26.760 --> 51:28.300
这边的话是不是就是调用这个方法

51:29.580 --> 51:31.620
res点渗的

51:32.900 --> 51:34.700
然后加这边的就await

51:35.460 --> 51:35.980
什么

51:36.500 --> 51:39.040
是不是这个fan的message

51:39.300 --> 51:41.100
by page service

51:41.860 --> 51:42.380
对不对

51:42.640 --> 51:44.940
把什么呢把你的这个req body

51:45.660 --> 51:47.200
req.query

51:47.460 --> 51:48.220
是不是穿过去了

51:48.980 --> 51:49.500
对不对

51:49.760 --> 51:52.060
req.query

51:52.320 --> 51:53.340
把它穿过去

51:54.100 --> 51:54.620
ok

51:55.140 --> 51:57.940
这就是我们这个获取留言或者评论

51:58.200 --> 51:59.480
我们这边来测试一下

52:00.500 --> 52:01.280
全部保存

52:03.670 --> 52:07.010
保存之后然后加我们这边poster man我们来try一try

52:07.770 --> 52:09.050
这边get

52:09.310 --> 52:11.090
首先的话这边的话是这个

52:11.350 --> 52:13.410
我们获取这个message

52:14.170 --> 52:16.470
获取这个message就是留言

52:16.770 --> 52:18.830
后面加一个什么呢加一个page

52:19.330 --> 52:20.630
等于一个de

52:21.390 --> 52:22.410
and

52:22.670 --> 52:23.690
limit

52:23.950 --> 52:25.230
等于一个我

52:25.990 --> 52:27.030
走

52:27.530 --> 52:28.550
哦抱错了

52:28.810 --> 52:30.590
啊抱错了我们看一下抱的什么错

52:33.510 --> 52:34.790
unknown

52:35.050 --> 52:37.870
这个message啊这个是那个

52:38.130 --> 52:39.150
排序那边

52:41.810 --> 52:43.850
我们刚才是不是用了一个这个排序啊

52:45.130 --> 52:45.890
对不对

52:46.150 --> 52:47.170
用了一个排序

52:47.430 --> 52:51.270
这边排序啊这里的话是应该是也是一个输组

52:52.370 --> 52:55.150
他也是个输组啊这边把这个加上

52:55.930 --> 52:57.990
他也是个输组好保存

52:58.750 --> 53:01.310
好保存之后然后这边再来

53:02.070 --> 53:02.830
走

53:03.090 --> 53:04.110
是不是OK了

53:05.150 --> 53:07.450
对不对你看我这边就找的是留言哦

53:07.710 --> 53:12.310
一二三四五首先是五条是不是就是留言

53:13.090 --> 53:13.850
对不对

53:14.110 --> 53:14.870
就是留言

53:15.130 --> 53:16.930
好了我这边如果是这个comment

53:18.710 --> 53:20.510
comment这边的话再加一个什么

53:20.730 --> 53:23.790
再加一个这个blog id

53:24.050 --> 53:26.350
对了我比如说等于一个什么呢等于一个这个or

53:27.110 --> 53:27.890
就全部

53:28.390 --> 53:28.910
走

53:29.670 --> 53:30.970
哎又抱错了

53:31.730 --> 53:32.490
抱的是什么

53:33.770 --> 53:35.570
op is not defined

53:37.350 --> 53:39.410
op啊我看一下啊

53:41.350 --> 53:42.130
op

53:42.890 --> 53:44.950
op我们是在这边写的

53:45.450 --> 53:45.970
是吧

53:46.730 --> 53:50.330
好这边的话op我看他这边是哦这边op他要引一下

53:53.600 --> 53:54.600
这边const

53:55.720 --> 53:57.360
等于一个require

53:58.800 --> 54:00.160
啊这边的是

54:00.760 --> 54:01.960
这个sacrifice

54:03.240 --> 54:06.840
好这边的结构把这个op把他拿出来

54:07.400 --> 54:08.160
啊保存

54:10.180 --> 54:12.220
好然后再来

54:12.740 --> 54:14.340
再来一遍走

54:17.800 --> 54:18.240
what

54:20.580 --> 54:21.380
是不是拿到了

54:22.260 --> 54:23.060
是不是拿到了

54:23.900 --> 54:25.420
对不对这边的这个blog

54:25.420 --> 54:27.140
blog他是关联查询了的

54:27.640 --> 54:30.680
啊所以这边看到可以看到这个数据啊比较大

54:31.040 --> 54:33.040
但是这边呢是不是把所有的那个

54:33.760 --> 54:35.440
把所有的那个就是评论

54:36.200 --> 54:37.080
是不是拿到了

54:38.040 --> 54:38.560
对不对

54:38.880 --> 54:40.480
所有评论都拿到了啊

54:41.080 --> 54:44.760
然后这边让我们因为这边呢是都是这个blog id都是5

54:45.280 --> 54:47.680
啊所以你现在的话这边你输这个5

54:47.960 --> 54:49.360
他拿到了也是个结果

54:49.880 --> 54:53.200
你回头的话你把这边数据库的这个数据把它改一下就可以了

54:53.640 --> 54:55.640
啊比较这边这边你有的改成3

54:55.740 --> 54:57.180
有的改成4有的改成5

54:57.440 --> 54:58.700
稍微把它改一下

54:59.480 --> 55:00.500
改一下就ok了

55:01.540 --> 55:04.860
好吧啊所以这个的话就是关于获取这个评论

55:05.620 --> 55:06.900
我们也就写完了

55:08.440 --> 55:11.000
好最后一个最后一个删除评论

55:11.260 --> 55:12.780
把删除评论写了哈

55:13.300 --> 55:14.580
写了我们这个就写完了

55:15.860 --> 55:17.900
先从dao程开始写吧

55:18.420 --> 55:19.460
这边是删除

55:21.500 --> 55:23.020
删除留言

55:23.540 --> 55:24.580
或者

55:25.040 --> 55:25.560
评论

55:25.820 --> 55:26.840
好了这个就简单了

55:27.600 --> 55:29.900
这边的这个model.export

55:30.420 --> 55:31.960
点delete

55:32.980 --> 55:34.760
message.do

55:35.280 --> 55:36.820
他等于一个async

55:37.080 --> 55:37.580
function

55:38.100 --> 55:39.640
他这边的话就应该是什么

55:39.900 --> 55:42.200
是不接受你要传一个id给我

55:43.220 --> 55:43.740
对不对

55:44.000 --> 55:47.060
你传一个id给我然后接下来我这边await

55:47.820 --> 55:48.860
message

55:49.880 --> 55:50.640
model

55:51.160 --> 55:52.440
然后加这边什么呢

55:52.700 --> 55:53.200
destroy

55:54.180 --> 55:54.580
对吧

55:54.820 --> 55:57.500
他接受一个对象这个系了好多次了

55:57.760 --> 55:59.300
这边ware id

56:00.580 --> 56:01.340
这边是这样子

56:02.620 --> 56:02.980
对不对

56:03.240 --> 56:04.940
应该是这样子我接受一个id

56:05.180 --> 56:08.500
接受一个id之后然后这样我这边直接删除就可以了

56:09.780 --> 56:12.100
好然后接下来的话来到这边

56:13.380 --> 56:14.140
这边

56:14.900 --> 56:17.220
这边的话也是删除

56:18.500 --> 56:19.780
删除

56:20.540 --> 56:22.340
删除留言

56:22.560 --> 56:24.080
或者评论

56:24.340 --> 56:28.180
好这边的就导出一个方法model.export

56:28.440 --> 56:29.960
点delete

56:30.480 --> 56:31.520
message

56:31.760 --> 56:32.800
service

56:33.040 --> 56:34.840
等于一个async

56:35.100 --> 56:35.600
function

56:36.880 --> 56:37.400
对吧

56:37.640 --> 56:38.680
这边真的是什么

56:38.940 --> 56:40.360
是不接受一个id

56:41.760 --> 56:42.200
对不对

56:42.460 --> 56:44.320
接受一个id然后接下来的话这边

56:44.560 --> 56:45.600
调用什么呢

56:45.840 --> 56:47.640
调用delete

56:48.160 --> 56:49.160
message

56:49.680 --> 56:50.200
d.o

56:51.180 --> 56:52.980
把这个id扔过去

56:53.420 --> 56:54.100
对不对

56:54.340 --> 56:56.340
删了之后然后下这边return一个

56:56.600 --> 56:57.380
我看一下这边

56:57.620 --> 56:59.420
删除成功之后返回什么

57:00.700 --> 57:01.720
删除评论

57:01.980 --> 57:02.740
这返回去

57:03.500 --> 57:06.060
对不对那那边留言版那边应该也是一样的

57:07.100 --> 57:07.860
留言版

57:08.120 --> 57:09.140
删除留言

57:10.180 --> 57:10.940
这返回去

57:11.460 --> 57:11.960
对不对

57:12.220 --> 57:13.740
好所以这边的就是直接

57:14.020 --> 57:14.780
return

57:15.800 --> 57:17.340
format

57:18.320 --> 57:20.360
然后response

57:21.120 --> 57:22.160
这边就应该是零

57:22.420 --> 57:23.180
控制创

57:23.680 --> 57:24.520
然后一个

57:26.760 --> 57:27.280
对不对

57:28.040 --> 57:30.360
好然后接下来的话这边message这边

57:30.860 --> 57:32.400
这边的话就直接调用

57:33.160 --> 57:33.920
这边

57:34.700 --> 57:36.480
这边的话就是应该是

57:36.740 --> 57:39.320
res.send

57:39.820 --> 57:41.360
这边的话await

57:41.620 --> 57:42.640
调用那个

57:42.900 --> 57:44.440
是不是delete

57:45.200 --> 57:45.960
message

57:46.480 --> 57:47.240
service

57:48.060 --> 57:48.760
把什么呢

57:49.020 --> 57:53.960
把这个req.charmus.id

57:54.720 --> 57:55.880
就把它传过去

57:57.020 --> 57:57.660
对不对

57:58.300 --> 57:59.580
好我们这边保存一下

58:01.600 --> 58:02.360
保存一下

58:03.380 --> 58:05.420
保存了之后我们这边我们来测试一下

58:05.680 --> 58:06.720
我们删了一个呢

58:07.480 --> 58:09.720
我们就把id为一的删了

58:09.980 --> 58:10.500
好吧

58:11.060 --> 58:13.380
好我们这边那就是应该是delete

58:14.140 --> 58:16.700
delete然后接下来的话

58:17.700 --> 58:19.720
我想一想啊

58:21.000 --> 58:23.320
我想一想他这边的话比如说我这里

58:23.820 --> 58:24.580
我看一下

58:25.620 --> 58:29.700
他这里的话如果是删出留言是message

58:30.980 --> 58:33.300
如果是他反正路由是一样的是吧

58:33.560 --> 58:34.820
好下只云的下

58:35.080 --> 58:36.360
好这边的话这边

58:36.620 --> 58:37.640
就这个comment

58:38.140 --> 58:39.940
然后将这边的斜杠

58:40.720 --> 58:41.480
走

58:43.370 --> 58:45.410
好又爆出了非常nice

58:45.670 --> 58:46.950
看一下爆了什么错

58:48.530 --> 58:49.810
not found

58:51.090 --> 58:52.170
这里这里

58:52.690 --> 58:54.170
这里是需要有一个

58:54.430 --> 58:54.930
就这个的

58:55.970 --> 58:56.730
对不对

58:57.250 --> 58:58.770
好再来走

58:59.550 --> 59:00.210
搞定

59:00.570 --> 59:02.610
搞定之后然后接下来的话这边

59:03.370 --> 59:04.410
重新关了

59:06.610 --> 59:07.890
第一个就被删除了

59:08.410 --> 59:11.330
对不对那你这边如果是这个message他是一样的

59:12.410 --> 59:13.730
message比如说二

59:14.650 --> 59:15.170
走

59:15.930 --> 59:16.850
然后回到这边

59:17.370 --> 59:17.890
关了

59:19.170 --> 59:19.690
打开

59:20.250 --> 59:22.290
是吧第二条id为二的就被删除了

59:23.290 --> 59:23.810
对不对

59:25.050 --> 59:27.050
好那我们这边的话就是整个这个

59:27.290 --> 59:28.690
关于这个留言

59:29.450 --> 59:30.730
留言和评论

59:31.490 --> 59:32.250
这个模块

59:32.490 --> 59:33.290
就写完了

59:33.530 --> 59:37.490
其实主要就是什么呢主要就是新增和获取来到这边

59:38.930 --> 59:40.970
其实主要就是新增和获取

59:41.490 --> 59:43.210
这个逻辑稍微要多一些

59:44.050 --> 59:45.290
看看啊这个是新增

59:45.530 --> 59:47.130
新增这边稍微有些逻辑

59:47.370 --> 59:48.730
还有什么呢还有就是获取

59:48.930 --> 59:50.330
获取的话是在这边

59:50.850 --> 59:52.890
是在这个dao城这边

59:53.130 --> 59:54.570
这边的话是不是稍微有些逻辑

59:55.330 --> 59:55.850
对不对

59:56.090 --> 59:56.890
这边

59:57.130 --> 59:57.930
就这两边

59:58.170 --> 59:59.290
逻辑稍微多一点

59:59.530 --> 01:00:01.490
其他的话基本上是一个套路

01:00:02.250 --> 01:00:03.530
啊基本上是一个套路

01:00:04.050 --> 01:00:05.850
所以大家下来的话把这个

01:00:06.090 --> 01:00:07.610
留言版和评论

01:00:07.890 --> 01:00:09.610
把这个这个这两个

01:00:10.130 --> 01:00:11.010
模块

01:00:11.530 --> 01:00:12.370
把它写一下

01:00:12.730 --> 01:00:15.890
啊这也是就是最后我这么直指细细的讲

01:00:16.330 --> 01:00:18.330
啊后面的话我们还剩下什么

01:00:18.930 --> 01:00:20.850
我们还剩下这个

01:00:21.610 --> 01:00:24.170
呃关于我设置

01:00:24.410 --> 01:00:26.890
还有一个什么呢还有一个那个改账号密码的一个

01:00:27.650 --> 01:00:28.610
啊就是这几个

01:00:29.370 --> 01:00:30.970
就是关于页面

01:00:31.210 --> 01:00:32.450
全局设置

01:00:33.210 --> 01:00:33.770
对不对

01:00:34.010 --> 01:00:35.330
然后还有一个就是这边

01:00:35.850 --> 01:00:37.610
更新管理员信息

01:00:37.890 --> 01:00:41.210
还剩这几个这几个我就合成一节课来讲了

01:00:41.730 --> 01:00:43.410
因为后面就都很简单了

01:00:44.290 --> 01:00:46.490
OK我甚至我有些我会

01:00:46.730 --> 01:00:48.130
先提前写好一些代码

01:00:49.050 --> 01:00:49.570
好吧

01:00:49.970 --> 01:00:52.650
OK好这一块就先到这里吧

01:00:52.930 --> 01:00:54.890
大家下去写一写啊再见

