WEBVTT

00:00.000 --> 00:07.360
ok 接下来的话 咱们来看一下微信小程序里面 啊 如何制作这种类似于指南针一样的这个应用

00:07.920 --> 00:10.080
啊 整体来讲的话 这一类的话 也不难

00:10.800 --> 00:16.560
因为这个微信小程序的话 它已经给我们提供好了这个风筝好的这个API 啊 咱们这些可以把它过一下

00:16.960 --> 00:22.040
ok 好 我们这边呢 要做的是这么一个应用啊 这边呢 就是一个类似于这种指南针的

00:22.520 --> 00:27.080
首先的话 一进来的话 这边是一个首页 首页的话 一般是一个提示啊 这边呢 就是

00:27.480 --> 00:36.320
请您远离磁场干扰员 然后并按下图所示啊 然后叫准指南针啊 反正就是一个提示了 好 人家这边点击我知道了

00:37.480 --> 00:45.640
过来 过来的话 大家这边会跳转到一个页面啊 这个页面的话 由于我们用的是模拟器 那模拟器呢 它是没有那个 就是

00:46.480 --> 00:46.960
罗盘的

00:49.520 --> 00:55.480
所以他刚才的话有个弹珠光啊 说这这个就是这个应用没有罗盘 大家这边呢 也没有任何东西显示出来

00:55.880 --> 01:04.120
那正常的话 一会等我们做完之后啊 你用这个手机来扫描 那手机上的话 你这边就可以看到啊 表示这边是多少度啊 表示45度

01:04.520 --> 01:09.160
那45度 然后既然又是什么方向啊 表示正北方 还是西南方向

01:09.800 --> 01:12.920
ok 大致就是这么样的一个应用 ok

01:13.800 --> 01:19.200
好 然后我们接下来来到这边 我把这个就关了啊 这个这个项目我们就把它关了

01:21.490 --> 01:27.850
好 来到这里 这里的话 这边是还是就是这个新项目啊 干干净净的这个新项目

01:28.170 --> 01:36.370
然后我把一些就是一会会用到的这个样式 我已经提前放过来了 啊 比如这边这个app.wxss 以及这边

01:38.170 --> 01:42.290
这边 这边会用到的一些样式 我提前把它放过来了 ok

01:42.890 --> 01:50.370
好 然后接下来这里 这里的话 首先这个是首页 首页的话 其实没有做什么事情 首页主要就是做一个提示与跳转

01:51.770 --> 02:00.130
首页主要就是做一个提示啊 以及什么呢 以及跳转

02:01.850 --> 02:08.530
好 我这边我就直接写了啊 这边view.container 好 然后下面 下面呢 首先第一个是文本提示

02:10.650 --> 02:13.530
文本提示 文本提示完了 下面是一张图片

02:16.160 --> 02:17.880
对吧 好 这边的话view

02:18.840 --> 02:24.880
view.text 好 人家这边呢这个text 这边呢是请您

02:26.440 --> 02:30.840
请您这个远离远离磁场

02:32.760 --> 02:35.360
干扰啊 复制一份啊 并按

02:37.440 --> 02:40.360
并且按照下图

02:41.160 --> 02:43.320
说是啊 校准

02:45.120 --> 02:52.760
校准指南针 ok 就一个单纯的这个提示 好 然后加这边 这边呢是一张图片 这边view

02:53.480 --> 02:58.520
点image啊 这个样式内都写好了的啊 这边呢是image

02:59.200 --> 03:00.720
image 这边src是

03:01.800 --> 03:09.680
image是下面的这个tip ok啊 这个mod mod好像是没有设置啊 mod没设置就不管他

03:09.920 --> 03:14.400
那接下来这边给个class class 这边的话是这个tip

03:16.240 --> 03:22.200
tip 然后pc ok 好 下面一个button button的话 然后接下来就是我知道了

03:24.360 --> 03:29.400
好 我知道了 然后加这边就会做一个什么 就会做个跳转 对吧 好吧 这个样式内写一下

03:30.080 --> 03:32.160
这边呢是tip

03:33.080 --> 03:36.320
btn 好 然后接下来这边bound type

03:37.320 --> 03:39.760
等于一个jump

03:41.400 --> 03:44.880
ok 好 那回头的话在这边 在json这边

03:45.600 --> 03:48.560
json 还是放到这边来啊 把其他的关了

03:49.640 --> 03:53.200
其他我看有没有什么没保存的 我先保保存一下

03:55.700 --> 03:59.300
保存了 然后把其他的关了 这边关闭其他

04:00.820 --> 04:03.100
ok 这边也是把其他的关了

04:04.020 --> 04:10.220
关闭其他 ok 好 然后接下来这里 这里的话就是一个什么 这里的话是不是就是一个jump

04:11.100 --> 04:12.460
对不对 就是一个jump

04:13.660 --> 04:17.540
jump 那jump的话这边就是干嘛 是不是做一个页面的跳转

04:19.060 --> 04:22.540
做一个页面的跳转

04:25.420 --> 04:30.860
ok 那我们这边呢 我们就还需要一个页面啊 我们在这边来到app.json这边

04:31.580 --> 04:32.980
这边呢 我们再来配置一个页面

04:34.620 --> 04:36.380
这边的话 再来一个compass

04:38.870 --> 04:39.470
compass

04:41.510 --> 04:47.430
ok 好 我看我这个window下面有没有配置啊 我这边的话 好像这个window这边 我看一下

04:48.310 --> 04:51.830
呃 这边还好 这边没有配置 好 那重新保存一下

04:53.190 --> 04:59.030
保存 ok 是不出来了 对了 这个就是首页啊 首页没有啥 好 人家这边点击我知道了

04:59.430 --> 05:07.510
这边 哦 跳转还没写啊 这边就跳转 跳转还记得吧 这边咱们就做一个这个普通的这个跳转 所以有一个叫做微信

05:09.030 --> 05:15.350
微信点never get to对不对啊 这边这边呢 是这个pages

05:17.110 --> 05:21.110
pages 下面的compass 下面的compass

05:22.950 --> 05:24.230
好 这边保存

05:24.710 --> 05:31.910
好 我知道了 跳过来了 对吧 好 那接下来我们的重点就落到了什么呢 落到了这个compass这边

05:32.710 --> 05:37.910
啊 这边 把拿过来compass compass这边 这边的话 然后

05:38.630 --> 05:40.630
看我这边还是把这个样式把拿过来

05:43.130 --> 05:45.130
啊 直接把这个样式放过来

05:46.090 --> 05:49.450
你们当时写的时候也是啊 这个样式直接拿过来就可以了啊

05:49.930 --> 05:53.610
主要就是把这个结构写好的 重点是什么 重点是不是j

05:54.570 --> 05:59.530
对吧 好 然后接下来这里 这里的话是首先view

06:00.730 --> 06:06.090
点container最外层的容器啊 人家这边的这个信息

06:07.610 --> 06:14.250
就上方 他分为两两个部分 一个是上方一个是下方 上方是什么呢 上方是这个信息的展示

06:15.770 --> 06:20.890
信息的展示就包括比如说你现在的话是多少度啊 然后接下来的话你的方向是什么

06:21.370 --> 06:25.850
那接下来下方 下方的话就是这个啊 罗盘的旋转

06:26.970 --> 06:28.890
罗盘的图片啊

06:30.010 --> 06:39.210
图片啊 然后会进行个什么呢 会进行个旋转 对吧 根据你这个手机倾斜的角度 那罗盘的话他会发生一个旋转

06:39.930 --> 06:42.010
好 然后加上方 上方的话首先这边

06:42.970 --> 06:46.810
view点text text里面 然后接下来这边

06:47.770 --> 06:50.410
text 这边首先有一个direction

06:51.210 --> 06:56.330
首先有一个direction 这个表示什么呢 这个表示方向

06:59.080 --> 07:02.040
这个表示方向好 还有一个是什么呢 还有一个是角度

07:03.560 --> 07:03.960
text

07:08.580 --> 07:11.300
angle 这个呢是旋转的角度

07:17.260 --> 07:21.900
旋转的角度啊 这个是当前的方向

07:23.660 --> 07:26.780
ok 那这个的话肯定就是在哪里 是不是在js里面

07:27.660 --> 07:30.380
我们来到js这边啊 js这边的话把这个

07:31.340 --> 07:33.740
用不到呢 我们把它删了啊 看着清爽一些

07:34.540 --> 07:39.820
把这些都删了吧 要用的是在写吗 好 这里

07:41.260 --> 07:45.260
这里是数据啊 数据的话呢 这边就有两个 一个是direction

07:45.900 --> 07:48.300
一个是angle啊direction

07:50.950 --> 07:56.260
direction 好 默认值的话是两杠

07:56.980 --> 07:59.380
ok啊 这个表示什么呢 表示方向

08:00.340 --> 08:06.980
方向 它大概的值是长什么样子呢 大概的值是这个样子的 就后期的话大值就是比如说西北

08:08.180 --> 08:11.140
啊 然后接下来的话比如说西南

08:12.020 --> 08:16.260
大值就是这样子的值 ok 好 然后接下来这边呢 还有就是一个angle

08:18.340 --> 08:20.020
好 这个的话一开始也是

08:21.540 --> 08:22.100
两根杠

08:23.060 --> 08:27.380
它后期的这个值的话大致是就是大致是这个样子的 就比如说

08:28.340 --> 08:30.420
269.73

08:31.540 --> 08:37.540
啊 大家杜 它后面有个那个杜啊 就这个啊多少度 ok 大致就是这个样子

08:38.980 --> 08:44.180
ok 好 这是这两个 好 然后回到我们的这个wxmail

08:44.900 --> 08:48.900
好 然后下面 下面呢 是这个罗盘的这个图片 说这边的这个view

08:49.780 --> 08:51.220
点这个pic

08:52.660 --> 08:53.860
好 这边呢 image

08:54.820 --> 09:01.860
img src src 的话是在img 下面的compasspng

09:02.660 --> 09:05.060
啊 然后接下来的话 这边style

09:05.060 --> 09:07.380
这mode没写啊 这边呢 是style

09:08.420 --> 09:09.060
等于

09:10.340 --> 09:14.100
好 这里很关键 这边的话我们要干嘛呢 我们这边呢 是trice form

09:15.620 --> 09:17.700
trice form 让他什么呢 让他选准

09:19.060 --> 09:22.260
啊 选准多少度呢 选准多少度我们现在不知道

09:22.980 --> 09:29.540
ok 说我们这边呢 写成一个动态的 这边旋转多少第一季啊 比如你这边你写个10

09:29.540 --> 09:34.820
他就旋转了这个10度 对不对 但具体的多少度 我们是在这个jess里面来控制的

09:34.820 --> 09:36.820
说这边呢 我们来写个rotate

09:39.220 --> 09:41.860
ok 好 rotate 那接下来在这边

09:44.410 --> 09:48.250
在这边rotate啊 这个是什么呢 这个是罗盘

09:48.810 --> 09:51.770
旋转的这个角度啊 一开始的话是一个空

09:52.490 --> 09:55.770
罗盘

09:56.570 --> 09:59.210
旋转的这个角度

10:00.010 --> 10:01.930
ok 那现在的话 我们这个

10:02.570 --> 10:04.810
整个wxmail啊 以及这个

10:05.930 --> 10:11.930
呃 样式啊 写好了 那jess的话 这边这个数据是绑定了 对不对 我们来看一下啊 编译

10:13.610 --> 10:19.690
我知道了 说出来了 对不对 这边出来了啊 现在的话 这边都是两缸啊 都是两缸

10:20.330 --> 10:23.610
好 然后接下来的话 下一步 下一步的话 是不是就是

10:24.010 --> 10:29.770
应该开始就是进行罗盘 这个罗盘的操作 对不对啊 我们这边在这个onload

10:32.390 --> 10:36.630
onload这边啊 这边的话你就调用什么呢 他这边有一个微信点

10:37.190 --> 10:39.350
on compass change

10:40.310 --> 10:46.070
ok 有这么一个啊 这么一个人家 我们这边我们来看一下console.log

10:47.510 --> 10:51.670
result 啊 这边就叫res吗 就叫res

10:52.630 --> 10:57.190
ok 保存啊 但是这边看不到啊 这边这边他那个模拟其他没有

10:58.390 --> 11:04.150
没有 所以大家这边的话也没办法看到啊 我这边的话 我们去他的那个去他的文档里面看一下

11:06.230 --> 11:15.110
我们来到这边 我们来看一下这个文档啊 这边微信on compass change

11:17.190 --> 11:18.310
啊 过来 你看

11:19.030 --> 11:27.110
这边呢 他是监听罗盘数据变化事件啊 频率的话是这个五次每秒 那就一秒钟会有五次

11:27.750 --> 11:33.350
人家这边呢 这个接口调用后会自动开始监听 可以使用什么呢 可以使用这个stop compass

11:33.910 --> 11:41.510
停止这个监听 我们来看一下他这边 这边他是直接是接受一个函数 那我们这边是不是已经传了一个函数

11:42.070 --> 11:48.150
对不对啊 这个函数的话 回头他会有一个这个参数参数的话 这边他是个对象 对象里面有这两个东西

11:48.470 --> 11:52.710
一个是direction啊 一个是这个精度 一个是这个角度 一个是精度

11:53.590 --> 11:57.590
ok 好 那接下来我们这边 我们来看一下啊

11:59.110 --> 12:03.830
这边的话 他这边说了一些这个平台的这个差异啊

12:05.030 --> 12:15.940
好 那回到我们这边 我们这边这样子可以开个真这个真机调时啊 真机调时大家就知道了

12:17.860 --> 12:19.380
稍等啊 我们这边扫一下

12:21.540 --> 12:27.620
好 这边这个二位马出来了 出来了之后再让我们开启一个真机调时啊 这边大家就看得到

12:30.940 --> 12:33.340
ok 来到这边啊 我知道了

12:34.460 --> 12:39.820
哎 你看出来了 看到没有 他这边的话 大字出来的就是这样子的结果

12:40.700 --> 12:46.220
好了 大字的话就是这个样子的结果啊 这边是阿耶斯 把他接这个结束吧

12:48.550 --> 12:51.190
ok 啊 这边他这个阿耶斯

12:55.610 --> 13:01.130
出来的时候拿到的是一个对象 对不对 这个对象是这个样子的 这边有这个参数 实际上有个这个direction

13:01.530 --> 13:02.730
那家这边有一个什么

13:03.610 --> 13:08.010
curricy 我们看一下这个curricy呢 这个curricy好像就是刚才他所说的那个

13:08.730 --> 13:09.610
curricy 啊 精度

13:10.250 --> 13:13.930
看到没有 是个精度 啊 精度他这边拿到的只是一个这个

13:14.570 --> 13:15.290
unreadable

13:15.930 --> 13:16.570
readable

13:17.450 --> 13:19.370
啊 这里不可信啊 原因未知

13:19.930 --> 13:25.370
ok 好 那我们不管这个啊 我们这边呢 实际上要谁就可以了 要这个direction就可以了

13:25.690 --> 13:31.530
啊 我们这边根据这个direction 我们就可以判断出他的这个方向以及他的这个角度啊

13:33.610 --> 13:34.170
根据

13:36.650 --> 13:45.990
根据direction 就能够啊获取到这个精度

13:46.950 --> 13:48.550
精度和

13:49.590 --> 13:50.230
角度

13:50.790 --> 13:52.310
ok 好 那我们这边

13:52.870 --> 13:55.430
let一个啊 或者啊 就let

13:55.990 --> 13:56.870
let一个new

13:57.350 --> 13:57.670
angel

13:59.990 --> 14:02.550
啊 这个应该就什么 angle 是吧 angle

14:03.190 --> 14:05.030
等于一个什么呢 等于res

14:05.750 --> 14:06.790
点direction

14:07.430 --> 14:09.430
啊 大家点to fixed

14:11.110 --> 14:11.590
两位

14:11.990 --> 14:14.150
啊 那这个他到时候转出来就是多少

14:14.550 --> 14:16.230
这边就是比如说202

14:17.110 --> 14:18.710
点这个70

14:18.950 --> 14:24.070
什么大字就这样子了 对吧 因为你这边69吗 69这边是转出来就70啊 new angle

14:24.710 --> 14:26.950
好 然后接下来的话 这边let一个

14:28.950 --> 14:30.550
let一个这个radius

14:33.290 --> 14:35.290
等于一个 这边是要个0

14:38.980 --> 14:39.700
这边是0

14:40.420 --> 14:44.020
好 0的话 这边转出来就多少 这边是不是就是差不多203

14:44.580 --> 14:47.860
对不对 也就是说一个是保留两位小数 一个是保留一位

14:48.100 --> 14:51.940
保留两位小数的话 回头我要把它设置给谁 是不是设置给他

14:53.380 --> 14:54.100
就设置给他

14:55.140 --> 15:00.900
对不对 回头我要设置给他 好 大家这个呢 这个的话是拿来这个计算这个方向的

15:01.620 --> 15:03.940
ok 主要是拿来计算方向的啊

15:04.660 --> 15:09.220
好 我这边的话 我就直接把那个check那个函数我就直接把拿过来

15:09.460 --> 15:10.420
我这边onload

15:10.420 --> 15:13.060
onload下面的话 这边还有个什么呢 还有个这个check

15:15.660 --> 15:15.980
check

15:16.620 --> 15:18.220
好 这个方法是拿来干什么的呢

15:18.300 --> 15:22.940
这个的话就是根据你的这个角度来判断方向

15:24.940 --> 15:28.380
根据角度来判断

15:29.580 --> 15:32.380
方向啊 比如你这边你传一个这个角度给我

15:33.500 --> 15:38.060
传给我了之后 然后在这边我就根据你这个角度 我这边就把这个方向给你

15:39.180 --> 15:40.220
给你这个返回

15:40.780 --> 15:44.060
ok 我这个这个就直接拿过来了啊 这个就是一些这个e file是判断

15:45.020 --> 15:52.060
看没有啊 如果你这边呢 是这个15到75之间 这边是东北啊 75到105这边是正东啊

15:52.060 --> 15:54.860
这个就是一些这个方向的这个判断 ok

15:54.860 --> 16:00.860
好 那接下来回到这边 回到这边 那我现在的话 我这个角度和这个方向 是不是就都有了

16:01.340 --> 16:04.460
对不对 说我接下来我这边就可以干嘛呢 我这边就可以

16:05.020 --> 16:08.220
z点set data

16:09.660 --> 16:12.700
进行设置 首先的话是什么呢 首先是角度

16:12.860 --> 16:17.100
啊 angel angel对呢 就是什么 这个new

16:18.700 --> 16:22.940
new uh 叫 angle angle 稍微读错啊 angle

16:24.140 --> 16:30.300
ok啊 首先这个的话是啊 角度好 然后接下来的话是方向 方向这边的话是direction

16:31.980 --> 16:35.980
direction啊 direction 这边这边就应该是什么 是不是 this

16:36.540 --> 16:37.420
点这个check

16:38.380 --> 16:42.060
掉这个方法 掉这个方法 然后把谁传过去啊 是把radius传过去啊

16:43.980 --> 16:51.260
对不对 把radius传过去啊 好 然后接下来最后一个 最后一个就是还有就是你旋转多少度 就是这个

16:51.260 --> 16:54.060
rotate 就是你罗盘旋转的这个

16:54.700 --> 17:01.340
度数 那这个度数它就是应该是360啊 360度嘛 那减去一个这个radius

17:03.700 --> 17:07.060
减去一个radius ok 那整个这个数据就已经

17:07.620 --> 17:12.820
完了 完了之后人家这边就应该就已经就生效了 那我们这边 我们来预览一下

17:15.560 --> 17:21.240
啊 预览一下我这边我用手机测一下啊 我本来说做一个投屏 但是我那个投屏软件好像过期了

17:21.720 --> 17:24.280
用不了 我看一下这边啊 ok 的

17:25.400 --> 17:30.120
ok的 没问题的啊 你们回头的话这个拿到这份代码你可以自己

17:30.600 --> 17:35.080
就是把他跑起来 跑起来用自己手机测试一下 没有问题的

17:35.560 --> 17:40.120
ok 没问题啊 这边这个度数我记得我这边还写了一个那个

17:41.000 --> 17:45.400
多少度啊 对对对 这边有一个这个符号啊 这个符号写不写都可以了

17:46.520 --> 17:52.680
这个无所谓啊 我把整个拿过来吧 就这边那有一个这个有个这个圈的这个符号

17:56.150 --> 18:05.220
这边有个圈的符号 ok 这样子的 保存就这样子了啊 多少度 ok

18:06.100 --> 18:11.860
好 然后就ok了啊 这边呢 还有一个啊 还有一个这个兜底的这个措施

18:12.260 --> 18:17.940
什么是兜底的措施呢 就你这边的话 你要判断一下手机是否有这个罗盘啊 所以我们在这边

18:18.900 --> 18:19.460
在这边

18:21.460 --> 18:28.340
那这边呢 是就是你这个每次康复是亲戚的时候会掉这个接口吗 对不对 好 然后在这边的话 我们要判断一下

18:30.020 --> 18:30.660
判断

18:32.340 --> 18:33.540
判断是否

18:34.420 --> 18:34.820
有

18:35.620 --> 18:38.980
罗盘啊 那接下来我们这边就做一个set timeout

18:40.900 --> 18:42.580
set timeout

18:44.100 --> 18:52.380
ok 啊 这边呢 一个一个回调函数啊 然后在这边过多少呢 过三秒

18:54.540 --> 18:58.460
过三秒啊 过了三秒之后然后就在这边一副

18:59.180 --> 19:08.220
你的这个 z 是点data 点这个direction啊 然后如果全等于就还等于什么呢 还等于两个钢

19:08.780 --> 19:18.540
对吧 过了三秒钟他还是两个钢 并且z点data点这个angle 他也是啊 还等于什么呢 还等于两个钢

19:18.860 --> 19:25.100
那说明什么 说明你这个是不是罗盘 没用啊 对不对 没用我们这边就微信点修

19:26.380 --> 19:26.780
toast

19:29.050 --> 19:31.370
啊 这边没有电子罗盘

19:33.930 --> 19:40.010
电子罗盘啊 这边这个icon icon的话 给个比较loading

19:41.210 --> 19:44.650
对吧 那给个这个duration 给个三秒

19:46.890 --> 19:49.770
啊 那给个这个mask 是这个q

19:51.370 --> 19:53.530
ok 啊 这边保存一下

19:54.570 --> 19:59.210
好 保存了之后 然后叫这边过来啊 三秒之后他就会弹出 你这边没有

19:59.530 --> 20:07.290
可不 没有电子罗盘 ok 啊 这是一个兜底的操作啊 但正常你手机这个扫描的话 他就是啊正常的

20:07.850 --> 20:13.530
啊 大家下来的话 可以自己把这个案例自己试一下 没有问题的啊 除非怎么 除非他这个接口变了

20:14.330 --> 20:21.530
啊 我之前呢 我就是这次 这次讲这个微信小程序 我把我之前写的很多这个案例拿出来 发现很多这个接口都变了

20:22.170 --> 20:24.730
啊 包括什么录音的这些接口啊 他很多变了啊

20:25.290 --> 20:31.210
说 除非就是后面 后面你听这个课的时候已经隔了很久了啊 这个接口变了 那他就可能不好使

20:31.610 --> 20:35.290
啊 他可 就应该也不会不好使 因为他要考虑一个这个兼容性

20:36.090 --> 20:39.770
知道吧 他就是什么 他就是这儿给你来一杠啊 就特别难看

20:40.570 --> 20:45.690
对吧 特别难看啊 用还是能够用 因为他保证就是之前的小程序能够跑嘛

20:46.250 --> 20:52.810
对吧 用还是能够用 但是这个你打开那个代码就很难看 他这边就给你废弃了 这边给你添加一杠啊

20:53.770 --> 21:02.810
ok啊 这个是关于这个这么这个微信小程序啊 这么一个这个指南针的这个应用啊 主要就是用到了他这个on compass清计

21:03.370 --> 21:12.090
ok 就接受他这个罗盘变化的时候 接受一些数据 接下来针对这些数据进行一个操作处理

21:13.370 --> 21:17.130
好 大家下来话可以写写啊 这些课就到这里 再见

