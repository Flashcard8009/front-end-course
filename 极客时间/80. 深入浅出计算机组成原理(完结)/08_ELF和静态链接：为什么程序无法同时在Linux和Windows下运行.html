<html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover"> <meta name="format-detection" content="telephone=no"> <title>08 | ELF和静态链接：为什么程序无法同时在Linux和Windows下运行？</title>         <style type="text/css"> html { color: #333; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-rendering: optimizelegibility; font-family: Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif } html.borderbox *,html.borderbox :after,html.borderbox :before { box-sizing: border-box } article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul { margin: 0; padding: 0 } article,aside,details,figcaption,figure,footer,header,menu,nav,section { display: block } audio,canvas,video { display: inline-block } body,button,input,select,textarea { font: 300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif } button::-moz-focus-inner,input::-moz-focus-inner { padding: 0; border: 0 } table { border-collapse: collapse; border-spacing: 0 } fieldset,img { border: 0 } blockquote { position: relative; color: #999; font-weight: 400; border-left: 1px solid #1abc9c; padding-left: 1em; margin: 1em 3em 1em 2em } @media only screen and (max-width: 640px) { blockquote { margin:1em 0 } } abbr,acronym { border-bottom: 1px dotted; font-variant: normal } abbr { cursor: help } del { text-decoration: line-through } address,caption,cite,code,dfn,em,th,var { font-style: normal; font-weight: 400 } ol,ul { list-style: none } caption,th { text-align: left } q:after,q:before { content: "" } sub,sup { font-size: 75%; line-height: 0; position: relative } :root sub,:root sup { vertical-align: baseline } sup { top: -.5em } sub { bottom: -.25em } a { color: #1abc9c } a:hover { text-decoration: underline } .typo a { border-bottom: 1px solid #1abc9c } .typo a:hover { border-bottom-color: #555; color: #555 } .typo a:hover,a,ins { text-decoration: none } .typo-u,u { text-decoration: underline } mark { background: #fffdd1; border-bottom: 1px solid #ffedce; padding: 2px; margin: 0 5px } code,pre,pre tt { font-family: Courier,Courier New,monospace } pre { background: hsla(0,0%,97%,.7); border: 1px solid #ddd; padding: 1em 1.5em; display: block; -webkit-overflow-scrolling: touch } hr { border: none; border-bottom: 1px solid #cfcfcf; margin-bottom: .8em; height: 10px } .typo-small,figcaption,small { font-size: .9em; color: #888 } b,strong { font-weight: 700; color: #000 } [draggable] { cursor: move } .clearfix:after,.clearfix:before { content: ""; display: table } .clearfix:after { clear: both } .clearfix { zoom:1} .textwrap,.textwrap td,.textwrap th { word-wrap: break-word; word-break: break-all } .textwrap-table { table-layout: fixed } .serif { font-family: Palatino,Optima,Georgia,serif } .typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote { margin-bottom: 1rem } h1,h2,h3,h4,h5,h6 { font-family: PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif; color: #000; line-height: 1.35 } .typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6 { margin-top: 1.2em; margin-bottom: .6em; line-height: 1.35 } .typo-h1,.typo h1 { font-size: 2em } .typo-h2,.typo h2 { font-size: 1.8em } .typo-h3,.typo h3 { font-size: 1.6em } .typo-h4,.typo h4 { font-size: 1.4em } .typo-h5,.typo-h6,.typo h5,.typo h6 { font-size: 1.2em } .typo-ul,.typo ul { margin-left: 1.3em; list-style: disc } .typo-ol,.typo ol { list-style: decimal; margin-left: 1.9em } .typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul { margin-bottom: .8em; margin-left: 2em } .typo-ol ul,.typo-ul ul,.typo li ul { list-style: circle } .typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th { border: 1px solid #ddd; padding: .5em 1em; color: #666 } .typo-table th,.typo table th { background: #fbfbfb } .typo-table thead th,.typo table thead th { background: hsla(0,0%,95%,.7) } .typo table caption { border-bottom: none } .typo-input,.typo-textarea { -webkit-appearance: none; border-radius: 0 } .typo-em,.typo em,caption,legend { color: #000; font-weight: inherit } .typo-em { position: relative } .typo-em:after { position: absolute; top: .65em; left: 0; width: 100%; overflow: hidden; white-space: nowrap; content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB" } .typo img { max-width: 100% } .common-content { font-weight: 400; color: #353535; line-height: 1.75rem; white-space: normal; word-break: normal; font-size: 1rem } .common-content img { display: block; max-width: 100%; background-color: #eee } .common-content audio,.common-content video { width: 100%; background-color: #eee } .common-content center,.common-content font { margin-top: 1rem; display: inline-block } .common-content center { width: 100% } .common-content pre { margin-top: 1rem; padding-left: 0; padding-right: 0; position: relative; overflow: hidden } .common-content pre code { font-size: .8rem; font-family: Consolas,Liberation Mono,Menlo,monospace,Courier; display: block; width: 100%; box-sizing: border-box; padding-left: 1rem; padding-right: 1rem; overflow-x: auto } .common-content hr { border: none; margin-top: 1.5rem; margin-bottom: 1.5rem; border-top: 1px solid #f5f5f5; height: 1px; background: none } .common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong { font-weight: 700 } .common-content h1,.common-content h2 { font-size: 1.125rem; margin-bottom: .45rem } .common-content h3,.common-content h4,.common-content h5 { font-size: 1rem; margin-bottom: .45rem } .common-content p { font-weight: 400; color: #353535; margin-top: .15rem } .common-content .orange { color: #ff5a05 } .common-content .reference { font-size: 1rem; color: #888 } .custom-rich-content h1 { margin-top: 0; font-weight: 400; font-size: 15.25px; border-bottom: 1px solid #eee; line-height: 2.8 } .custom-rich-content li,.custom-rich-content p { font-size: 14px; color: #888; line-height: 1.6 } table.hljs-ln { margin-bottom: 0; border-spacing: 0; border-collapse: collapse } table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr { box-sizing: border-box } table.hljs-ln td { padding: 0; border: 0 } table.hljs-ln td.hljs-ln-numbers { min-width: 15px; color: rgba(27,31,35,.3); text-align: right; white-space: nowrap; cursor: pointer; user-select: none } table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers { font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace; font-size: 12px; line-height: 20px; vertical-align: top } table.hljs-ln td.hljs-ln-code { position: relative; padding-right: 10px; padding-left: 10px; overflow: visible; color: #24292e; word-wrap: normal; white-space: pre } video::-webkit-media-controls { overflow: hidden!important } video::-webkit-media-controls-enclosure { width: calc(100% + 32px); margin-left: auto } .button-cancel { color: #888; border: 1px solid #888; border-radius: 3px; margin-right: 12px } .button-cancel,.button-primary { -ms-flex-positive: 1; flex-grow: 1; height: 35px; display: inline-block; font-size: 15px; text-align: center; line-height: 36px } .button-primary { color: #fff; background-color: #ff5a05; border-radius: 3px } @font-face { font-family: iconfont; src: url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot); src: url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg") } @font-face { font-family: player-font; src: url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot); src: url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg") } .iconfont { font-family: iconfont!important; font-size: 16px; font-style: normal; -webkit-font-smoothing: antialiased; -webkit-text-stroke-width: .2px; -moz-osx-font-smoothing: grayscale } html { background: #fff; min-height: 100%; -webkit-tap-highlight-color: rgba(0,0,0,0) } body { width: 100% } body.fixed { overflow: hidden; position: fixed; width: 100vw; height: 100vh } i { font-style: normal } a { word-wrap: break-word; -webkit-tap-highlight-color: rgba(0,0,0,0) } a:hover { text-decoration: none } .fade-enter-active,.fade-leave-active { transition: opacity .3s } .fade-enter,.fade-leave-to { opacity: 0 } .MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG { outline: 0 } .ios-app-switch .js-audit { display: none } ._loading_wrap_ { position: fixed; width: 100vw; height: 100vh; top: 50%; left: 50%; transform: translate(-50%,-50%); z-index: 999 } ._loading_div_class_,._loading_wrap_ { display: -ms-flexbox; display: flex; -ms-flex-pack: center; justify-content: center; -ms-flex-align: center; align-items: center } ._loading_div_class_ { word-wrap: break-word; padding: .5rem .75rem; text-align: center; z-index: 9999; font-size: .6rem; max-width: 60%; color: #fff; border-radius: .25rem; -ms-flex-direction: column; flex-direction: column } ._loading_div_class_ .message { color: #353535; font-size: 16px; line-height: 3 } .spinner { animation: circle-rotator 1.4s linear infinite } .spinner * { line-height: 0; box-sizing: border-box } @keyframes circle-rotator { 0% { transform: rotate(0deg) } to { transform: rotate(270deg) } } .path { stroke-dasharray: 187; stroke-dashoffset: 0; transform-origin: center; animation: circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite } @keyframes circle-colors { 0% { stroke: #ff5a05 } to { stroke: #ff5a05 } } @keyframes circle-dash { 0% { stroke-dashoffset: 187 } 50% { stroke-dashoffset: 46.75; transform: rotate(135deg) } to { stroke-dashoffset: 187; transform: rotate(450deg) } } .confirm-box-wrapper,.confirm-box-wrapper .mask { position: absolute; top: 0; left: 0; right: 0; bottom: 0 } .confirm-box-wrapper .mask { background: rgba(0,0,0,.6) } .confirm-box-wrapper .confirm-box { position: fixed; top: 50%; left: 50%; width: 267px; background: #fff; transform: translate(-50%,-50%); border-radius: 7px } .confirm-box-wrapper .confirm-box .head { margin: 0 18px; font-size: 18px; text-align: center; line-height: 65px; border-bottom: 1px solid #d9d9d9 } .confirm-box-wrapper .confirm-box .body { padding: 18px; padding-bottom: 0; color: #353535; font-size: 12.5px; max-height: 150px; overflow: auto } .confirm-box-wrapper .confirm-box .foot { display: -ms-flexbox; display: flex; -ms-flex-direction: row; flex-direction: row; padding: 18px } .confirm-box-wrapper .confirm-box .foot .button-cancel { border: 1px solid #d9d9d9 } .hljs { display: block; overflow-x: auto; padding: .5em; color: #333; background: #f8f8f8 } .hljs-comment,.hljs-quote { color: #998; font-style: italic } .hljs-keyword,.hljs-selector-tag,.hljs-subst { color: #333; font-weight: 700 } .hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable { color: teal } .hljs-doctag,.hljs-string { color: #d14 } .hljs-section,.hljs-selector-id,.hljs-title { color: #900; font-weight: 700 } .hljs-subst { font-weight: 400 } .hljs-class .hljs-title,.hljs-type { color: #458; font-weight: 700 } .hljs-attribute,.hljs-name,.hljs-tag { color: navy; font-weight: 400 } .hljs-link,.hljs-regexp { color: #009926 } .hljs-bullet,.hljs-symbol { color: #990073 } .hljs-built_in,.hljs-builtin-name { color: #0086b3 } .hljs-meta { color: #999; font-weight: 700 } .hljs-deletion { background: #fdd } .hljs-addition { background: #dfd } .hljs-emphasis { font-style: italic } .hljs-strong { font-weight: 700 } .button-cancel[data-v-87ffcada] { color: #888; border: 1px solid #888; border-radius: 3px; margin-right: 12px } .button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada] { -webkit-box-flex: 1; -ms-flex-positive: 1; flex-grow: 1; height: 35px; display: inline-block; font-size: 15px; text-align: center; line-height: 36px } .button-primary[data-v-87ffcada] { color: #fff; background-color: #ff5a05; border-radius: 3px } .pd[data-v-87ffcada] { padding-left: 1.375rem; padding-right: 1.375rem } .article[data-v-87ffcada] { max-width: 70rem; margin: 0 auto } .article .article-unavailable[data-v-87ffcada] { color: #fa8919; font-size: 15px; font-weight: 600; line-height: 24px; border-radius: 5px; padding: 12px; background-color: #f6f7fb; margin-top: 20px } .article .article-unavailable .iconfont[data-v-87ffcada] { font-size: 12px } .article .main[data-v-87ffcada] { padding: 1.25rem 0; margin-bottom: 52px } .article-title[data-v-87ffcada] { color: #353535; font-weight: bold; line-height: 1.65rem; font-size: 1.34375rem } .article-info[data-v-87ffcada] { color: #888; font-size: .9375rem; margin-top: 1.0625rem } .article-content[data-v-87ffcada] { margin-top: 1.0625rem } .article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button { display: none } .copyright[data-v-87ffcada] { color: #b2b2b2; padding-bottom: 20px; margin-top: 20px; font-size: 13px } .audio-player[data-v-87ffcada] { width: 100%; margin: 20px 0 } .to-comment[data-v-87ffcada] { overflow: hidden; padding-top: 10px; margin-bottom: -30px } .to-comment a.button-primary[data-v-87ffcada] { float: right; height: 20px; font-size: 12px; line-height: 20px; padding: 4px 8px; cursor: pointer } .article-comments[data-v-87ffcada] { margin-top: 2rem } .article-comments h2[data-v-87ffcada] { text-align: center; color: #888; position: relative; z-index: 1; margin-bottom: 1rem } .article-comments h2[data-v-87ffcada]:before { border-top: 1px dotted #888; content: ""; position: absolute; top: 56%; left: 0; width: 100%; z-index: -1 } .article-comments h2 span[data-v-87ffcada] { font-size: 15.25px; font-weight: 400; padding: 0 1rem; background: #fff; display: inline-block } .article-sub-bottom[data-v-87ffcada] { z-index: 10; cursor: pointer } .switch-btns[data-v-87ffcada] { height: 76px; cursor: pointer; padding-top: 24px; padding-bottom: 24px; border-bottom: 10px solid #f6f7fb; position: relative } .switch-btns[data-v-87ffcada]:before { content: " "; height: 1px; background: #e8e8e8; position: absolute; top: 0; left: 0; -webkit-box-sizing: border-box; box-sizing: border-box; left: 1.375rem; right: 1.375rem } .switch-btns .btn[data-v-87ffcada] { height: 38px; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .switch-btns .btn .tag[data-v-87ffcada] { -webkit-box-flex: 0; -ms-flex: 0 0 62px; flex: 0 0 62px; text-align: center; color: #888; font-size: 14px; border-radius: 10px; height: 22px; line-height: 22px; background: #f6f7fb; font-weight: 400 } .switch-btns .btn .txt[data-v-87ffcada] { margin-left: 10px; -webkit-box-flex: 1; -ms-flex: 1 1 auto; flex: 1 1 auto; color: #888; font-size: 15px; height: 22px; line-height: 22px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-weight: 400 } @media (max-width: 769px) { .article .breadcrumb[data-v-87ffcada] { padding-top:10px; padding-bottom: 10px } } .comment-item { list-style-position: inside; width: 100%; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; margin-bottom: 1rem } .comment-item a { border-bottom: none } .comment-item .avatar { width: 2.625rem; height: 2.625rem; -ms-flex-negative: 0; flex-shrink: 0; border-radius: 50% } .comment-item .info { margin-left: .5rem; -webkit-box-flex: 1; -ms-flex-positive: 1; flex-grow: 1 } .comment-item .info .hd { width: 100%; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-pack: justify; -ms-flex-pack: justify; justify-content: space-between; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .comment-item .info .hd .username { color: #888; font-size: 15.25px; font-weight: 400; line-height: 1.2 } .comment-item .info .hd .control { display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .comment-item .info .hd .control .btn-share { color: #888; font-size: .75rem; margin-right: 1rem } .comment-item .info .hd .control .btn-praise { display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center; font-size: 15.25px; text-decoration: none } .comment-item .info .hd .control .btn-praise i { color: #888; display: inline-block; font-size: .75rem; margin-right: .3rem; margin-top: -.01rem } .comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span { color: #ff5a05 } .comment-item .info .bd { color: #353535; font-size: 15.25px; font-weight: 400; white-space: normal; word-break: break-all; line-height: 1.6 } .comment-item .info .time { color: #888; font-size: 9px; line-height: 1 } .comment-item .info .reply .reply-hd { font-size: 15.25px } .comment-item .info .reply .reply-hd span { margin-left: -12px; color: #888; font-weight: 400 } .comment-item .info .reply .reply-hd i { color: #ff5a05; font-size: 15.25px } .comment-item .info .reply .reply-content { background: #f6f7fb; padding: 18px; border-radius: 10px; color: #353535; font-size: 15.25px; font-weight: 400; white-space: normal; word-break: break-all } .comment-item .info .reply .reply-time { color: #888; font-size: 9px } </style> </head> <body> <div id="app"> <div data-v-87ffcada="" class="article" id="watermark"> <div data-v-87ffcada="" class="main main-app"> <h1 data-v-87ffcada="" class="article-title pd"> 08 | ELF和静态链接：为什么程序无法同时在Linux和Windows下运行？ </h1> <hr> <div data-v-87ffcada="" class="article-content typo common-content pd"> <img data-v-87ffcada="" src="https://static001.geekbang.org/resource/image/49/04/49c871304ceb626799ade3e43a2b7004.jpg"> <div data-v-87ffcada="" id="article-content" class=""> <div class="text"> <p>过去的三节，你和我一起通过一些简单的代码，看到了我们写的程序，是怎么变成一条条计算机指令的；if…else这样的条件跳转是怎么样执行的；for/while这样的循环是怎么执行的；函数间的相互调用是怎么发生的。</p><p>我记得以前，我自己在了解完这些知识之后，产生了一个非常大的疑问。那就是，既然我们的程序最终都被变成了一条条机器码去执行，那为什么同一个程序，在同一台计算机上，在Linux下可以运行，而在Windows下却不行呢？反过来，Windows上的程序在Linux上也是一样不能执行的。可是我们的CPU并没有换掉，它应该可以识别同样的指令呀？</p><p>如果你和我有同样的疑问，那这一节，我们就一起来解开。</p><h2>编译、链接和装载：拆解程序执行</h2><p><a href="https://time.geekbang.org/column/article/93359">第5节</a>我们说过，写好的C语言代码，可以通过编译器编译成汇编代码，然后汇编代码再通过汇编器变成CPU可以理解的机器码，于是CPU就可以执行这些机器码了。你现在对这个过程应该不陌生了，但是这个描述把过程大大简化了。下面，我们一起具体来看，C语言程序是如何变成一个可执行程序的。</p><p>不知道你注意到没有，过去几节，我们通过gcc生成的文件和objdump获取到的汇编指令都有些小小的问题。我们先把前面的add函数示例，拆分成两个文件add_lib.c和link_example.c。</p><!-- [[[read_end]]] --><pre><code>// add_lib.c
int add(int a, int b)
{
    return a+b;
}
</code></pre><pre><code>// link_example.c

#include &lt;stdio.h&gt;
int main()
{
    int a = 10;
    int b = 5;
    int c = add(a, b);
    printf(&quot;c = %d\n&quot;, c);
}
</code></pre><p>我们通过gcc来编译这两个文件，然后通过objdump命令看看它们的汇编代码。</p><pre><code>$ gcc -g -c add_lib.c link_example.c
$ objdump -d -M intel -S add_lib.o
$ objdump -d -M intel -S link_example.o
</code></pre><pre><code>add_lib.o:     file format elf64-x86-64
Disassembly of section .text:
0000000000000000 &lt;add&gt;:
   0:   55                      push   rbp
   1:   48 89 e5                mov    rbp,rsp
   4:   89 7d fc                mov    DWORD PTR [rbp-0x4],edi
   7:   89 75 f8                mov    DWORD PTR [rbp-0x8],esi
   a:   8b 55 fc                mov    edx,DWORD PTR [rbp-0x4]
   d:   8b 45 f8                mov    eax,DWORD PTR [rbp-0x8]
  10:   01 d0                   add    eax,edx
  12:   5d                      pop    rbp
  13:   c3                      ret    
</code></pre><pre><code>link_example.o:     file format elf64-x86-64
Disassembly of section .text:
0000000000000000 &lt;main&gt;:
   0:   55                      push   rbp
   1:   48 89 e5                mov    rbp,rsp
   4:   48 83 ec 10             sub    rsp,0x10
   8:   c7 45 fc 0a 00 00 00    mov    DWORD PTR [rbp-0x4],0xa
   f:   c7 45 f8 05 00 00 00    mov    DWORD PTR [rbp-0x8],0x5
  16:   8b 55 f8                mov    edx,DWORD PTR [rbp-0x8]
  19:   8b 45 fc                mov    eax,DWORD PTR [rbp-0x4]
  1c:   89 d6                   mov    esi,edx
  1e:   89 c7                   mov    edi,eax
  20:   b8 00 00 00 00          mov    eax,0x0
  25:   e8 00 00 00 00          call   2a &lt;main+0x2a&gt;
  2a:   89 45 f4                mov    DWORD PTR [rbp-0xc],eax
  2d:   8b 45 f4                mov    eax,DWORD PTR [rbp-0xc]
  30:   89 c6                   mov    esi,eax
  32:   48 8d 3d 00 00 00 00    lea    rdi,[rip+0x0]        # 39 &lt;main+0x39&gt;
  39:   b8 00 00 00 00          mov    eax,0x0
  3e:   e8 00 00 00 00          call   43 &lt;main+0x43&gt;
  43:   b8 00 00 00 00          mov    eax,0x0
  48:   c9                      leave  
  49:   c3                      ret    
</code></pre><p>既然代码已经被我们“编译”成了指令，我们不妨尝试运行一下 ./link_example.o。</p><p>不幸的是，文件没有执行权限，我们遇到一个Permission denied错误。即使通过chmod命令赋予link_example.o文件可执行的权限，运行./link_example.o仍然只会得到一条cannot execute binary file: Exec format error的错误。</p><p>我们再仔细看一下objdump出来的两个文件的代码，会发现两个程序的地址都是从0开始的。如果地址是一样的，程序如果需要通过call指令调用函数的话，它怎么知道应该跳转到哪一个文件里呢？</p><p>这么说吧，无论是这里的运行报错，还是objdump出来的汇编代码里面的重复地址，都是因为 add_lib.o 以及 link_example.o并不是一个<strong>可执行文件</strong>（Executable Program），而是<strong>目标文件</strong>（Object File）。只有通过链接器（Linker）把多个目标文件以及调用的各种函数库链接起来，我们才能得到一个可执行文件。</p><p>我们通过gcc的-o参数，可以生成对应的可执行文件，对应执行之后，就可以得到这个简单的加法调用函数的结果。</p><pre><code>$ gcc -o link-example add_lib.o link_example.o
$ ./link_example
c = 15
</code></pre><p>实际上，“<strong>C语言代码-汇编代码-机器码</strong>”  这个过程，在我们的计算机上进行的时候是由两部分组成的。</p><p>第一个部分由编译（Compile）、汇编（Assemble）以及链接（Link）三个阶段组成。在这三个阶段完成之后，我们就生成了一个可执行文件。</p><p>第二部分，我们通过装载器（Loader）把可执行文件装载（Load）到内存中。CPU从内存中读取指令和数据，来开始真正执行程序。</p><p><img src="https://static001.geekbang.org/resource/image/99/a7/997341ed0fa9018561c7120c19cfa2a7.jpg" alt=""></p><h2>ELF格式和链接：理解链接过程</h2><p>程序最终是通过装载器变成指令和数据的，所以其实我们生成的可执行代码也并不仅仅是一条条的指令。我们还是通过objdump指令，把可执行文件的内容拿出来看看。</p><pre><code>link_example:     file format elf64-x86-64
Disassembly of section .init:
...
Disassembly of section .plt:
...
Disassembly of section .plt.got:
...
Disassembly of section .text:
...

 6b0:   55                      push   rbp
 6b1:   48 89 e5                mov    rbp,rsp
 6b4:   89 7d fc                mov    DWORD PTR [rbp-0x4],edi
 6b7:   89 75 f8                mov    DWORD PTR [rbp-0x8],esi
 6ba:   8b 55 fc                mov    edx,DWORD PTR [rbp-0x4]
 6bd:   8b 45 f8                mov    eax,DWORD PTR [rbp-0x8]
 6c0:   01 d0                   add    eax,edx
 6c2:   5d                      pop    rbp
 6c3:   c3                      ret    
00000000000006c4 &lt;main&gt;:
 6c4:   55                      push   rbp
 6c5:   48 89 e5                mov    rbp,rsp
 6c8:   48 83 ec 10             sub    rsp,0x10
 6cc:   c7 45 fc 0a 00 00 00    mov    DWORD PTR [rbp-0x4],0xa
 6d3:   c7 45 f8 05 00 00 00    mov    DWORD PTR [rbp-0x8],0x5
 6da:   8b 55 f8                mov    edx,DWORD PTR [rbp-0x8]
 6dd:   8b 45 fc                mov    eax,DWORD PTR [rbp-0x4]
 6e0:   89 d6                   mov    esi,edx
 6e2:   89 c7                   mov    edi,eax
 6e4:   b8 00 00 00 00          mov    eax,0x0
 6e9:   e8 c2 ff ff ff          call   6b0 &lt;add&gt;
 6ee:   89 45 f4                mov    DWORD PTR [rbp-0xc],eax
 6f1:   8b 45 f4                mov    eax,DWORD PTR [rbp-0xc]
 6f4:   89 c6                   mov    esi,eax
 6f6:   48 8d 3d 97 00 00 00    lea    rdi,[rip+0x97]        # 794 &lt;_IO_stdin_used+0x4&gt;
 6fd:   b8 00 00 00 00          mov    eax,0x0
 702:   e8 59 fe ff ff          call   560 &lt;printf@plt&gt;
 707:   b8 00 00 00 00          mov    eax,0x0
 70c:   c9                      leave  
 70d:   c3                      ret    
 70e:   66 90                   xchg   ax,ax
...
Disassembly of section .fini:
...
</code></pre><p>你会发现，可执行代码dump出来内容，和之前的目标代码长得差不多，但是长了很多。因为在Linux下，可执行文件和目标文件所使用的都是一种叫<strong>ELF</strong>（Execuatable and Linkable File Format）的文件格式，中文名字叫<strong>可执行与可链接文件格式</strong>，这里面不仅存放了编译成的汇编指令，还保留了很多别的数据。</p><p>比如我们过去所有objdump出来的代码里，你都可以看到对应的函数名称，像add、main等等，乃至你自己定义的全局可以访问的变量名称，都存放在这个ELF格式文件里。这些名字和它们对应的地址，在ELF文件里面，存储在一个叫作<strong>符号表</strong>（Symbols Table）的位置里。符号表相当于一个地址簿，把名字和地址关联了起来。</p><p>我们先只关注和我们的add以及main函数相关的部分。你会发现，这里面，main函数里调用add的跳转地址，不再是下一条指令的地址了，而是add函数的入口地址了，这就是EFL格式和链接器的功劳。</p><p><img src="https://static001.geekbang.org/resource/image/27/b3/276a740d0eabf5f4be905fe7326d9fb3.jpg" alt=""></p><p>ELF文件格式把各种信息，分成一个一个的Section保存起来。ELF有一个基本的文件头（File Header），用来表示这个文件的基本属性，比如是否是可执行文件，对应的CPU、操作系统等等。除了这些基本属性之外，大部分程序还有这么一些Section：</p><ol>
<li>
<p>首先是.text Section，也叫作<strong>代码段</strong>或者指令段（Code Section），用来保存程序的代码和指令；</p>
</li>
<li>
<p>接着是.data Section，也叫作<strong>数据段</strong>（Data Section），用来保存程序里面设置好的初始化数据信息；</p>
</li>
<li>
<p>然后就是.rel.text Secion，叫作<strong>重定位表</strong>（Relocation Table）。重定位表里，保留的是当前的文件里面，哪些跳转地址其实是我们不知道的。比如上面的 link_example.o 里面，我们在main函数里面调用了 add 和 printf 这两个函数，但是在链接发生之前，我们并不知道该跳转到哪里，这些信息就会存储在重定位表里；</p>
</li>
<li>
<p>最后是.symtab Section，叫作<strong>符号表</strong>（Symbol Table）。符号表保留了我们所说的当前文件里面定义的函数名称和对应地址的地址簿。</p>
</li>
</ol><p>链接器会扫描所有输入的目标文件，然后把所有符号表里的信息收集起来，构成一个全局的符号表。然后再根据重定位表，把所有不确定要跳转地址的代码，根据符号表里面存储的地址，进行一次修正。最后，把所有的目标文件的对应段进行一次合并，变成了最终的可执行代码。这也是为什么，可执行文件里面的函数调用的地址都是正确的。</p><p><img src="https://static001.geekbang.org/resource/image/f6/12/f62da9b29aa53218f8907851df27f912.jpeg" alt=""></p><p>在链接器把程序变成可执行文件之后，要装载器去执行程序就容易多了。装载器不再需要考虑地址跳转的问题，只需要解析 ELF 文件，把对应的指令和数据，加载到内存里面供CPU执行就可以了。</p><h2>总结延伸</h2><p>讲到这里，相信你已经猜到，为什么同样一个程序，在Linux下可以执行而在Windows下不能执行了。其中一个非常重要的原因就是，两个操作系统下可执行文件的格式不一样。</p><p>我们今天讲的是Linux下的ELF文件格式，而Windows的可执行文件格式是一种叫作<strong>PE</strong>（Portable Executable Format）的文件格式。Linux下的装载器只能解析ELF格式而不能解析PE格式。</p><p>如果我们有一个可以能够解析PE格式的装载器，我们就有可能在Linux下运行Windows程序了。这样的程序真的存在吗？没错，Linux下著名的开源项目Wine，就是通过兼容PE格式的装载器，使得我们能直接在Linux下运行Windows程序的。而现在微软的Windows里面也提供了WSL，也就是Windows Subsystem for Linux，可以解析和加载ELF格式的文件。</p><p>我们去写可以用的程序，也不仅仅是把所有代码放在一个文件里来编译执行，而是可以拆分成不同的函数库，最后通过一个静态链接的机制，使得不同的文件之间既有分工，又能通过静态链接来“合作”，变成一个可执行的程序。</p><p>对于ELF格式的文件，为了能够实现这样一个静态链接的机制，里面不只是简单罗列了程序所需要执行的指令，还会包括链接所需要的重定位表和符号表。</p><h2>推荐阅读</h2><p>想要更深入了解程序的链接过程和ELF格式，我推荐你阅读《程序员的自我修养——链接、装载和库》的1～4章。这是一本难得的讲解程序的链接、装载和运行的好书。</p><h2>课后思考</h2><p>你可以通过readelf读取出今天演示程序的符号表，看看符号表里都有哪些信息；然后通过objdump读取出今天演示程序的重定位表，看看里面又有哪些信息。</p><p>欢迎留言和我分享你的思考和疑惑，你也可以把今天的内容分享给你的朋友，和他一起学习和进步。</p><p><img src="https://static001.geekbang.org/resource/image/28/29/281ca28b90c8aa0aecbb5adc08394f29.jpg" alt=""></p> </div> </div> <div data-v-87ffcada="" class="article-comments"><h2 data-v-87ffcada=""><span data-v-87ffcada="">精选留言</span></h2> <ul data-v-87ffcada="">  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/a6/43/cb6ab349.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Spring</span> </div> <div class="bd">补充一下:<br>ELF其实是一种文件格式的标准，ELF文件有三类:可重定向文件、可执行文件、共享目标文件。代码经过预处理、编译、汇编后形成可重定向文件，可重定向文件经过链接后生成可执行文件。<br>另外我想请教一下，机器码是在哪一步形成的？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">简单地说，可以认为是在汇编之后变成了机器码放在了elf的代码段里。</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">一步</span> </div> <div class="bd">老师，我曾经在linux上使用过wine，有好多window软件不能很好兼容的运行，这是为什么呢？是不是除了执行文件格式之外，还有其他的因素影响软件的运行呢？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">一步同学你好，当然，因为很多程序还依赖各种操作系统本身提供的动态链接库，系统调用等等。需要wine提供对应的实现，兼容格式只是万里长征第一步。</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">一步</span> </div> <div class="bd">老师问一下Mac系统的可执行文件格式是什么，也是ELF吗？还是mac自己有自己一套？<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/55/f2/ba68d931.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">有米</span> </div> <div class="bd">Java的跨平台运行是如何做到的呢？跟本节内容有关系吗？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">Java是通过实现不同平台上的虚拟机，然后即时翻译javac生成的中间代码来做到跨平台的。跨平台的工作被虚拟机开发人员来解决了</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="" class="avatar"> <div class="info"> <div class="hd"><span class="username">有铭</span> </div> <div class="bd">所以理论上，只要不涉及到windows和linux的系统api调用，理论上只要搞定了可执行文件格式这个问题，那么C程序就是二进制可移植的？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">除了系统调用，还要考虑是否有动态链接库的依赖等等</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/d8/ee/6e7c2264.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Only now</span> </div> <div class="bd">mark <br>本章内容确实在链接装载与库里有更详尽的说明。<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍程序员的自我修养是一本好书。这个专栏的主题是组成原理，希望能带大家入个门。更深入地要去再花时间看书哦</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/f6/00/2a248fd8.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">杨怀</span> </div> <div class="bd">老师好，就是没有操作系统，直接在硬件上运行的可执行程序，其格式应该不是pe或elf，应该是纯的机器指令吧，pe或elf格式的可执行程序是跟操作系统绑定的，经过翻译后成为纯机器指令，才能被执行，不知道这样理解对不。<br></div> <span class="time">2019-05-18</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/e7/2e/1522a7d6.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">活的潇洒</span> </div> <div class="bd">这一周紧赶慢赶，总算是赶上了更新的进度。day08天学习笔记<br>https:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;10877269.html<br></div> <span class="time">2019-05-17</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epxBnhGmLOXwIN0fod3dEHzena2dAATaJqCHEJVDicR09wEKDp4kgxMT0tibMVVzjOmSYB2cr4ha9iaA/0" class="avatar"> <div class="info"> <div class="hd"><span class="username">Ant</span> </div> <div class="bd">老师好，有个疑问请教您<br><br>重定位表里，保留的是当前的文件里面，哪些跳转地址其实是我们不知道的。比如我们在 main 函数里面调用了 add 和 printf 这两个函数，但是在链接发生之前，我们并不知道该跳转到哪里，这些信息就会存储在重定位表里；<br>符号表保留了我们所说的当前文件里面定义的函数名称和对应地址的地址簿。<br>链接器会扫描所有输入的目标文件，构成一个全局的符号表。然后再根据重定位表，把所有不确定要跳转地址的代码，根据符号表里面存储的地址，进行一次修正。<br><br>那么链接器为啥要修正重定位表呢？  没有重定位表，直接用符号表行不行？<br><br><br></div> <span class="time">2019-05-14</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/16/ee/9e/204ce89c.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">徐</span> </div> <div class="bd">请问老师objdump出来的地址 和执行程序时实际的内存地址是怎么对应起来的<br></div> <span class="time">2019-05-14</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/f6/00/2a248fd8.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">杨怀</span> </div> <div class="bd">老师好，我有个问题，就是我可以用编程语言写一个不依赖操作系统的可执行程序，这个可执行程序不是pe格式，也不是elf的，那为什能执行呢，是不是因为这个可执行程序全是纯的cpu指令，没有其他要解析的东西？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">如果不是pe格式也不是elf格式，就不能执行啊。能执行是因为实际执行的不是你的程序。比如你写了一段python代码，实际执行的是python解释器，而不是你的py代码</p> <p class="reply-time">2019-05-17</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/f2/2b/7d9751bb.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">许山山</span> </div> <div class="bd">➜  ch7 git:(coding) ✗ objdump -d -M intel -S function_example.o        <br><br>function_example.o:     file format elf64-x86-64<br><br><br>Disassembly of section .text:<br><br>0000000000000000 &lt;add&gt;:<br>#include &lt;stdio.h&gt;<br><br><br>int add(int a, int b)<br>{<br>   0:   55                      push   rbp<br>   1:   48 89 e5                mov    rbp,rsp<br>   4:   89 7d fc                mov    DWORD PTR [rbp-0x4],edi<br>   7:   89 75 f8                mov    DWORD PTR [rbp-0x8],esi<br>    return a + b;<br>   a:   8b 55 fc                mov    edx,DWORD PTR [rbp-0x4]<br>   d:   8b 45 f8                mov    eax,DWORD PTR [rbp-0x8]<br>  10:   01 d0                   add    eax,edx<br>}<br>  12:   5d                      pop    rbp<br>  13:   c3                      ret    <br><br>0000000000000014 &lt;main&gt;:<br><br>int main(int argc, const char *argv[])<br>{<br>  14:   55                      push   rbp<br>  15:   48 89 e5                mov    rbp,rsp<br>  18:   48 83 ec 20             sub    rsp,0x20<br>  1c:   89 7d ec                mov    DWORD PTR [rbp-0x14],edi<br>  1f:   48 89 75 e0             mov    QWORD PTR [rbp-0x20],rsi<br>    int a = 5;<br>  23:   c7 45 f4 05 00 00 00    mov    DWORD PTR [rbp-0xc],0x5<br>    int b = 10;<br>  2a:   c7 45 f8 0a 00 00 00    mov    DWORD PTR [rbp-0x8],0xa<br>    int u = add(a, b);<br>  31:   8b 55 f8                mov    edx,DWORD PTR [rbp-0x8]<br>  34:   8b 45 f4                mov    eax,DWORD PTR [rbp-0xc]<br>  37:   89 d6                   mov    esi,edx<br>  39:   89 c7                   mov    edi,eax<br>  3b:   e8 00 00 00 00          call   40 &lt;main+0x2c&gt;<br>  40:   89 45 fc                mov    DWORD PTR [rbp-0x4],eax<br>    return 0;<br>  43:   b8 00 00 00 00          mov    eax,0x0<br>}<br>  48:   c9                      leave  <br>  49:   c3                      ret    <br><br>老师我想问一下 main 函数里起始位置 18, 1c, 1f 处的代码是干什么的？起始位置 3b, 40 处的函数调用为什么是直接把 eax 放到 u 里，这时候的 eax 已经是 add 函数运行后的结果了吗？<br><br>刚刚赶上进度，所以把前面遇到的问题也问一下老师，希望老师答疑，谢谢老师了。<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/ec/2a/b11d5ad8.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">曾经瘦过</span> </div> <div class="bd">mark   后面去读一读 程序员的自我修养<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍这本书对于做系统开发的同学是必读书目之一。</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/03/11/f58c6278.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">闫循鸣</span> </div> <div class="bd">整个elf文件都加载到内存吗，还是只加载一部分？<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">闫循鸣同学你好，关于这一部分，可以看下一讲的程序加载</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="" class="avatar"> <div class="info"> <div class="hd"><span class="username">林三杠</span> </div> <div class="bd">回答一下java跨平台的问题。<br>java的跨平台是通过虚拟机jvm实现的，程序员写的代码都编译成class文件，class文件在windows和linux上都是一样的，运行class文件的jvm是不跨平台的。windows有win版本的jvm，linux有linux版本的jvm。<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">明翼</span> </div> <div class="bd">老师我有个疑问经过链接之后行程可执行文件，像函数地址是确定了的，但是程序还没跑起来，这个地址怎么和运行时候内存实际地址做映射那？谢谢<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/ff/3f/bbb8a88c.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">徐凯</span> </div> <div class="bd">程序无法装载可能是由于系统无法识别目标文件的格式，我记得好像还有ABI的影响吧，函数符号的解析方式 参数的入栈顺序 以及c++底层内存布局 特性底层的不同实现 老师能不能简单讲解一下 <br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/10/e2/86/90041355.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">一塌糊涂</span> </div> <div class="bd">看一章，木有看够<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Linuxer</span> </div> <div class="bd">请问代码段里面的符号和数据段里面的符号分配的地址范围一样吗？有什么规则?另外动态链接的重定位应该有不同的规则吧<br></div> <span class="time">2019-05-13</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="" class="avatar"> <div class="info"> <div class="hd"><span class="username">lzhao</span> </div> <div class="bd">上周五还在思考这个问题？这答案说来就来，及时雨宋江<br></div> <span class="time">2019-05-13</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍希望对大家有所帮助</p> <p class="reply-time">2019-05-13</p> </div> </div> </li>  </ul> </div> </div> </div> </div> </div> </body> </html>
